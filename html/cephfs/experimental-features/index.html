

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>实验性功能 &mdash; Ceph Documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/ceph.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="Ceph 块设备" href="../../rbd/" />
    <link rel="prev" title="Mantle" href="../mantle/" /> 
</head>

<body class="wy-body-for-nav">

   
  <header class="top-bar">
    

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../">Ceph 文件系统</a> &raquo;</li>
        
      <li>实验性功能</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/cephfs/experimental-features.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
  </header>
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #eee" >
          

          
            <a href="../../">
          

          
            
            <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../start/intro/">Ceph 简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/">安装 Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cephadm/">Cephadm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rados/">Ceph 存储集群</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">Ceph 文件系统</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../#cephfs">CephFS 入门</a></li>
<li class="toctree-l2"><a class="reference internal" href="../#id1">管理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../#id2">挂载 CephFS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../#id3">CephFS 内幕</a></li>
<li class="toctree-l2"><a class="reference internal" href="../#id4">故障排除和灾难恢复</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../#id6">更多细节</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#"> 实验性功能</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">内联数据</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mantle">Mantle: 可编程的元数据负载均衡器</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">快照</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ceph">单个 Ceph 集群内建多个文件系统</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lazyio">LazyIO</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">目录分片</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">多活元数据服务器</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../rbd/">Ceph 块设备</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../radosgw/">Ceph 对象网关</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mgr/">Ceph 管理器守护进程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mgr/dashboard/">Ceph 仪表盘</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/">API 文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture/">体系结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/developer_guide/">开发者指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/internals/">Ceph 内幕</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../governance/">项目管理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../foundation/">Ceph 基金会</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ceph-volume/">ceph-volume</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/general/">Ceph 版本（总目录）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/">Ceph 版本（索引）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/">Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary/">Ceph 术语</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../jaegertracing/">Tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../translation_cn/">中文版翻译资源</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../">Ceph</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
<div id="dev-warning" class="admonition note">
  <p class="first admonition-title">Notice</p>
  <p class="last">This document is for a development version of Ceph.</p>
</div>
  <div id="docubetter" align="right" style="padding: 5px; font-weight: bold;">
    <a href="https://pad.ceph.com/p/Report_Documentation_Bugs">Report a Documentation Bug</a>
  </div>

  
  <div class="section" id="id1">
<h1>实验性功能<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>CephFS includes a number of experimental features which are not fully
stabilized or qualified for users to turn on in real deployments. We generally
do our best to clearly demarcate these and fence them off so they cannot be
used by mistake.</p>
<p>Some of these features are closer to being done than others, though. We
describe each of them with an approximation of how risky they are and briefly
describe what is required to enable them. Note that doing so will
<em>irrevocably</em> flag maps in the monitor as having once enabled this flag to
improve debugging and support processes.</p>
<div class="section" id="id2">
<h2>内联数据<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>By default, all CephFS file data is stored in RADOS objects. The inline data
feature enables small files (generally &lt;2KB) to be stored in the inode
and served out of the MDS. This may improve small-file performance but increases
load on the MDS. It is not sufficiently tested to support at this time, although
failures within it are unlikely to make non-inlined data inaccessible</p>
<p>Inline data has always been off by default and requires setting
the <code class="docutils literal notranslate"><span class="pre">inline_data</span></code> flag.</p>
<p>Inline data has been declared deprecated for the Octopus release, and will
likely be removed altogether in the Q release.</p>
</div>
<div class="section" id="mantle">
<h2>Mantle: 可编程的元数据负载均衡器<a class="headerlink" href="#mantle" title="Permalink to this headline">¶</a></h2>
<p>Mantle is a programmable metadata balancer built into the MDS. The idea is to
protect the mechanisms for balancing load (migration, replication,
fragmentation) but stub out the balancing policies using Lua. For details, see
<a class="reference internal" href="../mantle/"><span class="doc">Mantle</span></a>.</p>
</div>
<div class="section" id="id3">
<h2>快照<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>Like multiple active MDSes, CephFS is designed from the ground up to support
snapshotting of arbitrary directories. There are no known bugs at the time of
writing, but there is insufficient testing to provide stability guarantees and
every expansion of testing has generally revealed new issues. If you do enable
snapshots and experience failure, manual intervention will be needed.</p>
<p>Snapshots are known not to work properly with multiple filesystems (below) in
some cases. Specifically, if you share a pool for multiple FSes and delete
a snapshot in one FS, expect to lose snapshotted file data in any other FS using
snapshots. See the <a class="reference internal" href="../../dev/cephfs-snapshots/"><span class="doc">CephFS 快照</span></a> page for more information.</p>
<p>出于某些含糊的实现原因，内核客户端仅支持最多 400 个快照（
<a class="reference external" href="http://tracker.ceph.com/issues/21420">http://tracker.ceph.com/issues/21420</a> ）。</p>
<p>在 Mimic 版之前，快照功能是用 allow_new_snaps 标记屏蔽的。</p>
</div>
<div class="section" id="ceph">
<h2>单个 Ceph 集群内建多个文件系统<a class="headerlink" href="#ceph" title="Permalink to this headline">¶</a></h2>
<p>Code was merged prior to the Jewel release which enables administrators
to create multiple independent CephFS filesystems within a single Ceph cluster.
These independent filesystems have their own set of active MDSes, cluster maps,
and data. But the feature required extensive changes to data structures which
are not yet fully qualified, and has security implications which are not all
apparent nor resolved.</p>
<p>There are no known bugs, but any failures which do result from having multiple
active filesystems in your cluster will require manual intervention and, so far,
will not have been experienced by anybody else – knowledgeable help will be
extremely limited. You also probably do not have the security or isolation
guarantees you want or think you have upon doing so.</p>
<p>Note that snapshots and multiple filesystems are <em>not</em> tested in combination
and may not work together; see above.</p>
<p>Multiple filesystems were available starting in the Jewel release candidates
but must be turned on via the <code class="docutils literal notranslate"><span class="pre">enable_multiple</span></code> flag until declared stable.</p>
</div>
<div class="section" id="lazyio">
<h2>LazyIO<a class="headerlink" href="#lazyio" title="Permalink to this headline">¶</a></h2>
<p>LazyIO 放松了 POSIX 语义的要求，允许读、写缓冲的存在，即使有多个客户端上的多个应用程序同时打开一个文件时也允许。应用程序自行负责缓存一致性的管理。</p>
<div class="section" id="id4">
<h3>曾经是实验性的功能<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
</div>
</div>
<div class="section" id="id5">
<h2>目录分片<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>在 <em>Luminous</em> (12.2.x) 版以前，目录分片功能是实验性的，现在会给新文件系统默认启用。旧版 Ceph 上的文件系统若要启用目录分片功能，可给此文件系统设置 <code class="docutils literal notranslate"><span class="pre">allow_dirfrags</span></code> 标记。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">fs</span> <span class="nb">set</span> <span class="o">&lt;</span><span class="n">filesystem</span> <span class="n">name</span><span class="o">&gt;</span> <span class="n">allow_dirfrags</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h2>多活元数据服务器<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>在 <em>Luminous</em> 12.2.x 版之前，在单个文件系统内运行多活元数据服务器是实验性的功能；现在，默认就允许在新文件系统上创建多活元数据服务器。</p>
<p>用较老版本的 Ceph 创建的文件系统仍然需要明确启用多活元数据服务器，如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">fs</span> <span class="nb">set</span> <span class="o">&lt;</span><span class="n">file</span> <span class="n">system</span> <span class="n">name</span><span class="o">&gt;</span> <span class="n">allow_multimds</span> <span class="mi">1</span>
</pre></div>
</div>
<p>注意，活跃 MDS 集群的默认尺寸（ <code class="docutils literal notranslate"><span class="pre">max_mds</span></code> ），其初始值仍然是
1 。</p>
</div>
</div>



           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../../rbd/" class="btn btn-neutral float-right" title="Ceph 块设备" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../mantle/" class="btn btn-neutral float-left" title="Mantle" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2016, Ceph authors and contributors. Licensed under Creative Commons Attribution Share Alike 3.0 (CC-BY-SA-3.0).

    </p>
  </div> 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>