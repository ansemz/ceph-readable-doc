
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Experimental Features &mdash; Ceph Documentation</title>
    
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     'dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Ceph Documentation" href="../../" />
    <link rel="up" title="Ceph Filesystem" href="../" />
    <link rel="next" title="Quotas" href="../quota/" />
    <link rel="prev" title="Differences from POSIX" href="../posix/" />
    <script type="text/javascript" src="http://ayni.ceph.com/public/js/ceph.js"></script>

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../quota/" title="Quotas"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../posix/" title="Differences from POSIX"
             accesskey="P">previous</a> |</li>
        <li><a href="../../">Ceph Documentation</a> &raquo;</li>
          <li><a href="../" accesskey="U">Ceph Filesystem</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="experimental-features">
<h1>Experimental Features<a class="headerlink" href="#experimental-features" title="Permalink to this headline">¶</a></h1>
<p>CephFS includes a number of experimental features which are not fully stabilized
or qualified for users to turn on in real deployments. We generally do our best
to clearly demarcate these and fence them off so they can&#8217;t be used by mistake.</p>
<p>Some of these features are closer to being done than others, though. We describe
each of them with an approximation of how risky they are and briefly describe
what is required to enable them. Note that doing so will <em>irrevocably</em> flag maps
in the monitor as having once enabled this flag to improve debugging and
support processes.</p>
<div class="section" id="inline-data">
<h2>Inline data<a class="headerlink" href="#inline-data" title="Permalink to this headline">¶</a></h2>
<p>By default, all CephFS file data is stored in RADOS objects. The inline data
feature enables small files (generally &lt;2KB) to be stored in the inode
and served out of the MDS. This may improve small-file performance but increases
load on the MDS. It is not sufficiently tested to support at this time, although
failures within it are unlikely to make non-inlined data inaccessible</p>
<p>Inline data has always been off by default and requires setting
the &#8220;inline_data&#8221; flag.</p>
</div>
<div class="section" id="multi-mds-filesystem-clusters">
<h2>Multi-MDS filesystem clusters<a class="headerlink" href="#multi-mds-filesystem-clusters" title="Permalink to this headline">¶</a></h2>
<p>CephFS has been designed from the ground up to support fragmenting the metadata
hierarchy across multiple active metadata servers, to allow horizontal scaling
to arbitrary throughput requirements. Unfortunately, doing so requires a lot
more working code than having a single MDS which is authoritative over the
entire filesystem namespace.</p>
<p>Multiple active MDSes are generally stable under trivial workloads, but often
break in the presence of any failure, and do not have enough testing to offer
any stability guarantees. If a filesystem with multiple active MDSes does
experience failure, it will require (generally extensive) manual intervention.
There are serious known bugs.</p>
<p>Multi-MDS filesystems have always required explicitly increasing the &#8220;max_mds&#8221;
value and have been further protected with the &#8220;allow_multimds&#8221; flag for Jewel.</p>
<div class="section" id="mantle-programmable-metadata-load-balancer">
<h3>Mantle: Programmable Metadata Load Balancer<a class="headerlink" href="#mantle-programmable-metadata-load-balancer" title="Permalink to this headline">¶</a></h3>
<p>Mantle is a programmable metadata balancer built into the MDS. The idea is to
protect the mechanisms for balancing load (migration, replication,
fragmentation) but stub out the balancing policies using Lua. For details, see
<a class="reference internal" href="../mantle/"><em>Mantle</em></a>.</p>
</div>
</div>
<div class="section" id="snapshots">
<h2>Snapshots<a class="headerlink" href="#snapshots" title="Permalink to this headline">¶</a></h2>
<p>Like multiple active MDSes, CephFS is designed from the ground up to support
snapshotting of arbitrary directories. There are no known bugs at the time of
writing, but there is insufficient testing to provide stability guarantees and
every expansion of testing has generally revealed new issues. If you do enable
snapshots and experience failure, manual intervention will be needed.</p>
<p>Snapshots are known not to work properly with multiple filesystems (below) in
some cases. Specifically, if you share a pool for multiple FSes and delete
a snapshot in one FS, expect to lose snapshotted file data in any other FS using
snapshots. See the <a class="reference internal" href="../../dev/cephfs-snapshots/"><em>CephFS Snapshots</em></a> page for more information.</p>
<p>Snapshots are known not to work with multi-MDS filesystems.</p>
<p>Snapshotting was blocked off with the &#8220;allow_new_snaps&#8221; flag prior to Firefly.</p>
</div>
<div class="section" id="multiple-filesystems-within-a-ceph-cluster">
<h2>Multiple filesystems within a Ceph cluster<a class="headerlink" href="#multiple-filesystems-within-a-ceph-cluster" title="Permalink to this headline">¶</a></h2>
<p>Code was merged prior to the Jewel release which enables administrators
to create multiple independent CephFS filesystems within a single Ceph cluster.
These independent filesystems have their own set of active MDSes, cluster maps,
and data. But the feature required extensive changes to data structures which
are not yet fully qualified, and has security implications which are not all
apparent nor resolved.</p>
<p>There are no known bugs, but any failures which do result from having multiple
active filesystems in your cluster will require manual intervention and, so far,
will not have been experienced by anybody else &#8211; knowledgeable help will be
extremely limited. You also probably do not have the security or isolation
guarantees you want or think you have upon doing so.</p>
<p>Note that snapshots and multiple filesystems are <em>not</em> tested in combination
and may not work together; see above.</p>
<p>Multiple filesystems were available starting in the Jewel release candidates
but were protected behind the &#8220;enable_multiple&#8221; flag before the final release.</p>
</div>
</div>
<div class="section" id="previously-experimental-features">
<h1>Previously experimental features<a class="headerlink" href="#previously-experimental-features" title="Permalink to this headline">¶</a></h1>
<div class="section" id="directory-fragmentation">
<h2>Directory Fragmentation<a class="headerlink" href="#directory-fragmentation" title="Permalink to this headline">¶</a></h2>
<p>Directory fragmentation was considered experimental prior to the <em>Luminous</em>
(12.2.x).  It is now enabled by default on new filesystems.  To enable directory
fragmentation on filesystems created with older versions of Ceph, set
the <tt class="docutils literal"><span class="pre">allow_dirfrags</span></tt> flag on the filesystem:</p>
<div class="highlight-python"><pre>ceph fs set &lt;filesystem name&gt; allow_dirfrags</pre>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../start/intro/">Intro to Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../start/">Installation (Quick)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/">Installation (Manual)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rados/">Ceph Storage Cluster</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">Ceph Filesystem</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../#using-cephfs">Using CephFS</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../rados/deployment/ceph-deploy-mds/">Add/Remove MDS(s)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standby/">Terminology</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standby/#referring-to-mds-daemons">Referring to MDS daemons</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standby/#managing-failover">Managing failover</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standby/#configuring-standby-daemons">Configuring standby daemons</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standby/#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mds-config-ref/">MDS Configuration Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../client-config-ref/">Client Configuration Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../journaler/">Journaler Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../man/8/ceph-mds/">Manpage ceph-mds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../createfs/">Create CephFS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kernel/">Mount CephFS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fuse/">Mount CephFS as FUSE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fstab/">Mount CephFS in fstab</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../man/8/ceph-fuse/">Manpage ceph-fuse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../man/8/mount.ceph/">Manpage mount.ceph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../best-practices/">Deployment best practices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../administration/">Administrative commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../posix/">POSIX compatibility</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="">Experimental Features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#inline-data">Inline data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multi-mds-filesystem-clusters">Multi-MDS filesystem clusters</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#mantle-programmable-metadata-load-balancer">Mantle: Programmable Metadata Load Balancer</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#snapshots">Snapshots</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multiple-filesystems-within-a-ceph-cluster">Multiple filesystems within a Ceph cluster</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#previously-experimental-features">Previously experimental features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#directory-fragmentation">Directory Fragmentation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../quota/">CephFS Quotas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hadoop/">Using Ceph with Hadoop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cephfs-journal-tool/">cephfs-journal-tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../file-layouts/">File layouts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../eviction/">Client eviction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../full/">Handling full filesystems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../health-messages/">Health messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/">Troubleshooting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../disaster-recovery/">Disaster recovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../client-auth/">Client authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrading/">Upgrading old filesystems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dirfrags/">Configuring directory fragmentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../multimds/">Configuring multiple active MDS daemons</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../#for-developers">For developers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../rbd/rbd/">Ceph Block Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../radosgw/">Ceph Object Gateway</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mgr/">Ceph Manager Daemon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture/">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release-notes/">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/">Ceph Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary/">Glossary</a></li>
</ul>


<!-- ugly kludge to make genindex look like it's part of the toc -->
<ul style="margin-top: -10px"><li class="toctree-l1"><a class="reference internal" href="../../genindex/">Index</a></li></ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../quota/" title="Quotas"
             >next</a> |</li>
        <li class="right" >
          <a href="../posix/" title="Differences from POSIX"
             >previous</a> |</li>
        <li><a href="../../">Ceph Documentation</a> &raquo;</li>
          <li><a href="../" >Ceph Filesystem</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2016, Red Hat, Inc, and contributors. Licensed under Creative Commons BY-SA.
    </div>
  </body>
</html>