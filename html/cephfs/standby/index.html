
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Terminology &mdash; Ceph Documentation</title>
    
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     'dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="top" title="Ceph Documentation" href="../../" />
    <link rel="up" title="Ceph Filesystem" href="../" />
    <link rel="next" title="MDS Config Reference" href="../mds-config-ref/" />
    <link rel="prev" title="Add/Remove Metadata Server" href="../../rados/deployment/ceph-deploy-mds/" />
    <script type="text/javascript" src="http://ayni.ceph.com/public/js/ceph.js"></script>

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../mds-config-ref/" title="MDS Config Reference"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../../rados/deployment/ceph-deploy-mds/" title="Add/Remove Metadata Server"
             accesskey="P">previous</a> |</li>
        <li><a href="../../">Ceph Documentation</a> &raquo;</li>
          <li><a href="../" accesskey="U">Ceph Filesystem</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="terminology">
<h1>Terminology<a class="headerlink" href="#terminology" title="Permalink to this headline">¶</a></h1>
<p>A Ceph cluster may have zero or more CephFS <em>filesystems</em>.  CephFS
filesystems have a human readable name (set in <tt class="docutils literal"><span class="pre">fs</span> <span class="pre">new</span></tt>)
and an integer ID.  The ID is called the filesystem cluster ID,
or <em>FSCID</em>.</p>
<p>Each CephFS filesystem has a number of <em>ranks</em>, one by default,
which start at zero.  A rank may be thought of as a metadata shard.
Controlling the number of ranks in a filesystem is described
in <a class="reference internal" href="../multimds/"><em>Configuring multiple active MDS daemons</em></a></p>
<p>Each CephFS ceph-mds process (a <em>daemon</em>) initially starts up
without a rank.  It may be assigned one by the monitor cluster.
A daemon may only hold one rank at a time.  Daemons only give up
a rank when the ceph-mds process stops.</p>
<p>If a rank is not associated with a daemon, the rank is
considered <em>failed</em>.  Once a rank is assigned to a daemon,
the rank is considered <em>up</em>.</p>
<p>A daemon has a <em>name</em> that is set statically by the administrator
when the daemon is first configured.  Typical configurations
use the hostname where the daemon runs as the daemon name.</p>
<p>Each time a daemon starts up, it is also assigned a <em>GID</em>, which
is unique to this particular process lifetime of the daemon.  The
GID is an integer.</p>
</div>
<div class="section" id="referring-to-mds-daemons">
<h1>Referring to MDS daemons<a class="headerlink" href="#referring-to-mds-daemons" title="Permalink to this headline">¶</a></h1>
<p>Most of the administrative commands that refer to an MDS daemon
accept a flexible argument format that may contain a rank, a GID
or a name.</p>
<p>Where a rank is used, this may optionally be qualified with
a leading filesystem name or ID.  If a daemon is a standby (i.e.
it is not currently assigned a rank), then it may only be
referred to by GID or name.</p>
<p>For example, if we had an MDS daemon which was called &#8216;myhost&#8217;,
had GID 5446, and was assigned rank 0 in the filesystem &#8216;myfs&#8217;
which had FSCID 3, then any of the following would be suitable
forms of the &#8216;fail&#8217; command:</p>
<div class="highlight-python"><pre>ceph mds fail 5446     # GID
ceph mds fail myhost   # Daemon name
ceph mds fail 0        # Unqualified rank
ceph mds fail 3:0      # FSCID and rank
ceph mds fail myfs:0   # Filesystem name and rank</pre>
</div>
</div>
<div class="section" id="managing-failover">
<h1>Managing failover<a class="headerlink" href="#managing-failover" title="Permalink to this headline">¶</a></h1>
<p>If an MDS daemon stops communicating with the monitor, the monitor will
wait <tt class="docutils literal"><span class="pre">mds_beacon_grace</span></tt> seconds (default 15 seconds) before marking
the daemon as <em>laggy</em>.</p>
<p>Each file system may specify a number of standby daemons to be considered
healthy. This number includes daemons in standby-replay waiting for a rank to
fail (remember that a standby-replay daemon will not be assigned to take over a
failure for another rank or a failure in a another CephFS file system). The
pool of standby daemons not in replay count towards any file system count.
Each file system may set the number of standby daemons wanted using:</p>
<div class="highlight-python"><pre>ceph fs set &lt;fs name&gt; standby_count_wanted &lt;count&gt;</pre>
</div>
<p>Setting <tt class="docutils literal"><span class="pre">count</span></tt> to 0 will disable the health check.</p>
</div>
<div class="section" id="configuring-standby-daemons">
<h1>Configuring standby daemons<a class="headerlink" href="#configuring-standby-daemons" title="Permalink to this headline">¶</a></h1>
<p>There are four configuration settings that control how a daemon
will behave while in standby:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="n">mds_standby_for_name</span>
<span class="n">mds_standby_for_rank</span>
<span class="n">mds_standby_for_fscid</span>
<span class="n">mds_standby_replay</span>
</pre></div>
</div>
<p>These may be set in the ceph.conf on the host where the MDS daemon
runs (as opposed to on the monitor).  The daemon loads these settings
when it starts, and sends them to the monitor.</p>
<p>By default, if none of these settings are used, all MDS daemons
which do not hold a rank will be used as standbys for any rank.</p>
<p>The settings which associate a standby daemon with a particular
name or rank do not guarantee that the daemon will <em>only</em> be used
for that rank.  They mean that when several standbys are available,
the associated standby daemon will be used.  If a rank is failed,
and a standby is available, it will be used even if it is associated
with a different rank or named daemon.</p>
<div class="section" id="mds-standby-replay">
<h2>mds_standby_replay<a class="headerlink" href="#mds-standby-replay" title="Permalink to this headline">¶</a></h2>
<p>If this is set to true, then the standby daemon will continuously read
the metadata journal of an up rank.  This will give it
a warm metadata cache, and speed up the process of failing over
if the daemon serving the rank fails.</p>
<p>An up rank may only have one standby replay daemon assigned to it,
if two daemons are both set to be standby replay then one of them
will arbitrarily win, and the other will become a normal non-replay
standby.</p>
<p>Once a daemon has entered the standby replay state, it will only be
used as a standby for the rank that it is following.  If another rank
fails, this standby replay daemon will not be used as a replacement,
even if no other standbys are available.</p>
<p><em>Historical note:</em> In Ceph prior to v10.2.1, this setting (when <tt class="docutils literal"><span class="pre">false</span></tt>) is
always true when <tt class="docutils literal"><span class="pre">mds_standby_for_*</span></tt> is also set.</p>
</div>
<div class="section" id="mds-standby-for-name">
<h2>mds_standby_for_name<a class="headerlink" href="#mds-standby-for-name" title="Permalink to this headline">¶</a></h2>
<p>Set this to make the standby daemon only take over a failed rank
if the last daemon to hold it matches this name.</p>
</div>
<div class="section" id="mds-standby-for-rank">
<h2>mds_standby_for_rank<a class="headerlink" href="#mds-standby-for-rank" title="Permalink to this headline">¶</a></h2>
<p>Set this to make the standby daemon only take over the specified
rank.  If another rank fails, this daemon will not be used to
replace it.</p>
<p>Use in conjunction with <tt class="docutils literal"><span class="pre">mds_standby_for_fscid</span></tt> to be specific
about which filesystem&#8217;s rank you are targeting, if you have
multiple filesystems.</p>
</div>
<div class="section" id="mds-standby-for-fscid">
<h2>mds_standby_for_fscid<a class="headerlink" href="#mds-standby-for-fscid" title="Permalink to this headline">¶</a></h2>
<p>If <tt class="docutils literal"><span class="pre">mds_standby_for_rank</span></tt> is set, this is simply a qualifier to
say which filesystem&#8217;s rank is referred to.</p>
<p>If <tt class="docutils literal"><span class="pre">mds_standby_for_rank</span></tt> is not set, then setting FSCID will
cause this daemon to target any rank in the specified FSCID.  Use
this if you have a daemon that you want to use for any rank, but
only within a particular filesystem.</p>
</div>
<div class="section" id="mon-force-standby-active">
<h2>mon_force_standby_active<a class="headerlink" href="#mon-force-standby-active" title="Permalink to this headline">¶</a></h2>
<p>This setting is used on monitor hosts.  It defaults to true.</p>
<p>If it is false, then daemons configured with standby_replay=true
will <strong>only</strong> become active if the rank/name that they have
been configured to follow fails.  On the other hand, if this
setting is true, then a daemon configured with standby_replay=true
may be assigned some other rank.</p>
</div>
</div>
<div class="section" id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<p>These are example ceph.conf snippets.  In practice you can either
copy a ceph.conf with all daemons&#8217; configuration to all your servers,
or you can have a different file on each server that contains just
that server&#8217;s daemons&#8217; configuration.</p>
<div class="section" id="simple-pair">
<h2>Simple pair<a class="headerlink" href="#simple-pair" title="Permalink to this headline">¶</a></h2>
<p>Two MDS daemons &#8216;a&#8217; and &#8216;b&#8217; acting as a pair, where whichever one is not
currently assigned a rank will be the standby replay follower
of the other.</p>
<div class="highlight-python"><pre>[mds.a]
mds standby replay = true
mds standby for rank = 0

[mds.b]
mds standby replay = true
mds standby for rank = 0</pre>
</div>
</div>
<div class="section" id="floating-standby">
<h2>Floating standby<a class="headerlink" href="#floating-standby" title="Permalink to this headline">¶</a></h2>
<p>Three MDS daemons &#8216;a&#8217;, &#8216;b&#8217; and &#8216;c&#8217;, in a filesystem that has
<tt class="docutils literal"><span class="pre">max_mds</span></tt> set to 2.</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># No explicit configuration required: whichever daemon is</span>
<span class="c1"># not assigned a rank will go into &#39;standby&#39; and take over</span>
<span class="c1"># for whichever other daemon fails.</span>
</pre></div>
</div>
</div>
<div class="section" id="two-mds-clusters">
<h2>Two MDS clusters<a class="headerlink" href="#two-mds-clusters" title="Permalink to this headline">¶</a></h2>
<p>With two filesystems, I have four MDS daemons, and I want two
to act as a pair for one filesystem and two to act as a pair
for the other filesystem.</p>
<div class="highlight-python"><pre>[mds.a]
mds standby for fscid = 1

[mds.b]
mds standby for fscid = 1

[mds.c]
mds standby for fscid = 2

[mds.d]
mds standby for fscid = 2</pre>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../start/intro/">Intro to Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../start/">Installation (Quick)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/">Installation (Manual)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rados/">Ceph Storage Cluster</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">Ceph Filesystem</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../#using-cephfs">Using CephFS</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../rados/deployment/ceph-deploy-mds/">Add/Remove MDS(s)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="">Terminology</a></li>
<li class="toctree-l3"><a class="reference internal" href="#referring-to-mds-daemons">Referring to MDS daemons</a></li>
<li class="toctree-l3"><a class="reference internal" href="#managing-failover">Managing failover</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuring-standby-daemons">Configuring standby daemons</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#mds-standby-replay">mds_standby_replay</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mds-standby-for-name">mds_standby_for_name</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mds-standby-for-rank">mds_standby_for_rank</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mds-standby-for-fscid">mds_standby_for_fscid</a></li>
<li class="toctree-l4"><a class="reference internal" href="#mon-force-standby-active">mon_force_standby_active</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#simple-pair">Simple pair</a></li>
<li class="toctree-l4"><a class="reference internal" href="#floating-standby">Floating standby</a></li>
<li class="toctree-l4"><a class="reference internal" href="#two-mds-clusters">Two MDS clusters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../mds-config-ref/">MDS Configuration Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../client-config-ref/">Client Configuration Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../journaler/">Journaler Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../man/8/ceph-mds/">Manpage ceph-mds</a></li>
<li class="toctree-l3"><a class="reference internal" href="../createfs/">Create CephFS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../kernel/">Mount CephFS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fuse/">Mount CephFS as FUSE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../fstab/">Mount CephFS in fstab</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../man/8/ceph-fuse/">Manpage ceph-fuse</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../man/8/mount.ceph/">Manpage mount.ceph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../best-practices/">Deployment best practices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../administration/">Administrative commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="../posix/">POSIX compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="../experimental-features/">Experimental Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../experimental-features/#previously-experimental-features">Previously experimental features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../quota/">CephFS Quotas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../hadoop/">Using Ceph with Hadoop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cephfs-journal-tool/">cephfs-journal-tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../file-layouts/">File layouts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../eviction/">Client eviction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../full/">Handling full filesystems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../health-messages/">Health messages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting/">Troubleshooting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../disaster-recovery/">Disaster recovery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../client-auth/">Client authentication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../upgrading/">Upgrading old filesystems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../dirfrags/">Configuring directory fragmentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../multimds/">Configuring multiple active MDS daemons</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../#for-developers">For developers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../rbd/rbd/">Ceph Block Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../radosgw/">Ceph Object Gateway</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mgr/">Ceph Manager Daemon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture/">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release-notes/">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/">Ceph Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary/">Glossary</a></li>
</ul>


<!-- ugly kludge to make genindex look like it's part of the toc -->
<ul style="margin-top: -10px"><li class="toctree-l1"><a class="reference internal" href="../../genindex/">Index</a></li></ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../mds-config-ref/" title="MDS Config Reference"
             >next</a> |</li>
        <li class="right" >
          <a href="../../rados/deployment/ceph-deploy-mds/" title="Add/Remove Metadata Server"
             >previous</a> |</li>
        <li><a href="../../">Ceph Documentation</a> &raquo;</li>
          <li><a href="../" >Ceph Filesystem</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2016, Red Hat, Inc, and contributors. Licensed under Creative Commons BY-SA.
    </div>
  </body>
</html>