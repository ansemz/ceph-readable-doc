
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>ceph – Ceph 管理工具 &#8212; Ceph Documentation</title>
    <link rel="stylesheet" href="../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <script src="../../../_static/js/ceph.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" />
    <link rel="next" title="ceph-deploy – Ceph 部署工具" href="../ceph-deploy/" />
    <link rel="prev" title="ceph-volume-systemd – systemd ceph-volume 辅助工具" href="../ceph-volume-systemd/" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../ceph-deploy/" title="ceph-deploy – Ceph 部署工具"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../ceph-volume-systemd/" title="ceph-volume-systemd – systemd ceph-volume 辅助工具"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../rados/" >Ceph 存储集群</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../../rados/man/" accesskey="U">对象存储手册页</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            

<div id="dev-warning" class="admonition note" style="display:none;">
  <p class="first admonition-title">Notice</p>
  <p class="last">This document is for a development version of Ceph.</p>
</div>

<div id="eol-warning" class="admonition warning" style="display:none;">
  <p class="first admonition-title">Warning</p>
  <p class="last">This document is for an unsupported version of Ceph.</p>
</div>
  <div id="docubetter" align="right" style="display:none; padding: 15px; font-weight: bold;">
    <a id="edit-on-github" href="https://github.com/ceph/ceph/edit/master/doc/man/8/ceph.rst" rel="nofollow">Edit on GitHub</a> | <a href="https://pad.ceph.com/p/Report_Documentation_Bugs">Report a Documentation Bug</a>
  </div>

  
  <div class="section" id="ceph-ceph">
<h1>ceph – Ceph 管理工具<a class="headerlink" href="#ceph-ceph" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2>提纲<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>auth</strong> [ <em>add</em> | <em>caps</em> | <em>del</em> | <em>export</em> | <em>get</em> | <em>get-key</em> | <em>get-or-create</em> | <em>get-or-create-key</em> | <em>import</em> | <em>list</em> | <em>print-key</em> | <em>print_key</em> ] …</div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>compact</strong></div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>config</strong> [ <em>dump</em> | <em>ls</em> | <em>help</em> | <em>get</em> | <em>show</em> | <em>show-with-defaults</em> | <em>set</em> | <em>rm</em> | <em>log</em> | <em>reset</em> | <em>assimilate-conf</em> | <em>generate-minimal-conf</em> ] …</div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>config-key</strong> [ <em>rm</em> | <em>exists</em> | <em>get</em> | <em>ls</em> | <em>dump</em> | <em>set</em> ] …</div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>daemon</strong> <em>&lt;name&gt;</em> | <em>&lt;path&gt;</em> <em>&lt;command&gt;</em> …</div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>daemonperf</strong> <em>&lt;name&gt;</em> | <em>&lt;path&gt;</em> [ <em>interval</em> [ <em>count</em> ] ]</div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>df</strong> <em>{detail}</em></div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>fs</strong> [ <em>ls</em> | <em>new</em> | <em>reset</em> | <em>rm</em> ] …</div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>fsid</strong></div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>health</strong> <em>{detail}</em></div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>injectargs</strong> <em>&lt;injectedargs&gt;</em> [ <em>&lt;injectedargs&gt;</em>… ]</div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>log</strong> <em>&lt;logtext&gt;</em> [ <em>&lt;logtext&gt;</em>… ]</div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>mds</strong> [ <em>compat</em> | <em>fail</em> | <em>rm</em> | <em>rmfailed</em> | <em>set_state</em> | <em>stat</em> | <em>repaired</em> ] …</div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>mon</strong> [ <em>add</em> | <em>dump</em> | <em>getmap</em> | <em>remove</em> | <em>stat</em> ] …</div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>osd</strong> [ <em>blacklist</em> | <em>blocked-by</em> | <em>create</em> | <em>new</em> | <em>deep-scrub</em> | <em>df</em> | <em>down</em> | <em>dump</em> | <em>erasure-code-profile</em> | <em>find</em> | <em>getcrushmap</em> | <em>getmap</em> | <em>getmaxosd</em> | <em>in</em> | <em>ls</em> | <em>lspools</em> | <em>map</em> | <em>metadata</em> | <em>ok-to-stop</em> | <em>out</em> | <em>pause</em> | <em>perf</em> | <em>pg-temp</em> | <em>force-create-pg</em> | <em>primary-affinity</em> | <em>primary-temp</em> | <em>repair</em> | <em>reweight</em> | <em>reweight-by-pg</em> | <em>rm</em> | <em>destroy</em> | <em>purge</em> | <em>safe-to-destroy</em> | <em>scrub</em> | <em>set</em> | <em>setcrushmap</em> | <em>setmaxosd</em>  | <em>stat</em> | <em>tree</em> | <em>unpause</em> | <em>unset</em> ] …</div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>osd</strong> <strong>crush</strong> [ <em>add</em> | <em>add-bucket</em> | <em>create-or-move</em> | <em>dump</em> | <em>get-tunable</em> | <em>link</em> | <em>move</em> | <em>remove</em> | <em>rename-bucket</em> | <em>reweight</em> | <em>reweight-all</em> | <em>reweight-subtree</em> | <em>rm</em> | <em>rule</em> | <em>set</em> | <em>set-tunable</em> | <em>show-tunables</em> | <em>tunables</em> | <em>unlink</em> ] …</div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>osd</strong> <strong>pool</strong> [ <em>create</em> | <em>delete</em> | <em>get</em> | <em>get-quota</em> | <em>ls</em> | <em>mksnap</em> | <em>rename</em> | <em>rmsnap</em> | <em>set</em> | <em>set-quota</em> | <em>stats</em> ] …</div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>osd</strong> <strong>pool</strong> <strong>application</strong> [ <em>disable</em> | <em>enable</em> | <em>get</em> | <em>rm</em> | <em>set</em> ] …</div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>osd</strong> <strong>tier</strong> [ <em>add</em> | <em>add-cache</em> | <em>cache-mode</em> | <em>remove</em> | <em>remove-overlay</em> | <em>set-overlay</em> ] …</div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>pg</strong> [ <em>debug</em> | <em>deep-scrub</em> | <em>dump</em> | <em>dump_json</em> | <em>dump_pools_json</em> | <em>dump_stuck</em> | <em>getmap</em> | <em>ls</em> | <em>ls-by-osd</em> | <em>ls-by-pool</em> | <em>ls-by-primary</em> | <em>map</em> | <em>repair</em> | <em>scrub</em> | <em>stat</em> ] …</div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>quorum_status</strong></div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>report</strong> { <em>&lt;tags&gt;</em> [ <em>&lt;tags&gt;…</em> ] }</div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>status</strong></div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>sync</strong> <strong>force</strong> {–yes-i-really-mean-it} {–i-know-what-i-am-doing}</div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>tell</strong> <em>&lt;name (type.id)&gt; &lt;command&gt; [options…]</em></div>
</div>
<div class="line-block">
<div class="line"><strong>ceph</strong> <strong>version</strong></div>
</div>
</div>
<div class="section" id="id2">
<h2>描述<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p><strong class="program">ceph</strong> 是个控制工具，可用于手动部署和维护 Ceph 集群。它提供的多种工具可用于部署监视器、 OSD 、归置组、 MDS 和维护、管理整个集群。</p>
</div>
<div class="section" id="id3">
<h2>命令<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<div class="section" id="auth">
<h3>auth<a class="headerlink" href="#auth" title="Permalink to this headline">¶</a></h3>
<p>管理认证密钥。用于给某个具体实体（如监视器或 OSD ）增加、删除、导出或更新认证密钥。还需额外加子命令。</p>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">add</span></code> 用于为特定实体增加认证信息，这些信息可从文件读入，若未在命令行指定密钥（和、或此密钥的能力）将生成随机密钥。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">auth</span> <span class="n">add</span> <span class="o">&lt;</span><span class="n">entity</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">caps</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">caps</span><span class="o">&gt;...</span><span class="p">]}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">caps</span></code> 把 <strong>name</strong> 的能力更新为命令行中指定的。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">auth</span> <span class="n">caps</span> <span class="o">&lt;</span><span class="n">entity</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">caps</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">caps</span><span class="o">&gt;...</span><span class="p">]</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">del</span></code> 删除 <code class="docutils literal notranslate"><span class="pre">name</span></code> 的所有能力。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">auth</span> <span class="k">del</span> <span class="o">&lt;</span><span class="n">entity</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">export</span></code> 把指定实体写入密钥环，若未指定则写入主密钥环。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">auth</span> <span class="n">export</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">entity</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">get</span></code> 把请求到的密钥写入密钥环文件。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">auth</span> <span class="n">get</span> <span class="o">&lt;</span><span class="n">entity</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">get-key</span></code> 显示所请求的密钥。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">auth</span> <span class="n">get</span><span class="o">-</span><span class="n">key</span> <span class="o">&lt;</span><span class="n">entity</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">get-or-create</span></code> 用于为特定实体增加认证信息，这些信息可从文件读入，若未在命令行指定密钥（和、或此密钥的能力）将生成随机密钥。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">auth</span> <span class="n">get</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="n">create</span> <span class="o">&lt;</span><span class="n">entity</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">caps</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">caps</span><span class="o">&gt;...</span><span class="p">]}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">get-or-create-key</span></code> 根据命令行指定的系统、能力对，为
<code class="docutils literal notranslate"><span class="pre">name</span></code> 获取或创建密钥。若密钥已存在，任何指定的能力必须与当前已有能力一致。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">auth</span> <span class="n">get</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="n">create</span><span class="o">-</span><span class="n">key</span> <span class="o">&lt;</span><span class="n">entity</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">caps</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">caps</span><span class="o">&gt;...</span><span class="p">]}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">import</span></code> 从输入文件读入密钥环。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">auth</span> <span class="kn">import</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">ls</span></code> 罗列认证状态。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">auth</span> <span class="n">ls</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">print-key</span></code> 显示请求的密钥。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">auth</span> <span class="nb">print</span><span class="o">-</span><span class="n">key</span> <span class="o">&lt;</span><span class="n">entity</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">print_key</span></code> 显示请求的密钥。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">auth</span> <span class="n">print_key</span> <span class="o">&lt;</span><span class="n">entity</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="compact">
<h3>compact<a class="headerlink" href="#compact" title="Permalink to this headline">¶</a></h3>
<p>让监视器压缩其 leveldb 存储。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">compact</span>
</pre></div>
</div>
</div>
<div class="section" id="config-key">
<h3>config-key<a class="headerlink" href="#config-key" title="Permalink to this headline">¶</a></h3>
<p>管理配置密钥。需额外指定子命令。</p>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">del</span></code> 用于删除配置密钥。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">config</span><span class="o">-</span><span class="n">key</span> <span class="k">del</span> <span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">exists</span></code> 用于检查配置密钥是否存在。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">config</span><span class="o">-</span><span class="n">key</span> <span class="n">exists</span> <span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">get</span></code> 用于获取配置密钥。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">config</span><span class="o">-</span><span class="n">key</span> <span class="n">get</span> <span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">list</span></code> 罗列配置密钥。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">config</span><span class="o">-</span><span class="n">key</span> <span class="n">ls</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">dump</span></code> 倒出配置中的所有键及其值。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">config</span><span class="o">-</span><span class="n">key</span> <span class="n">dump</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">set</span></code> 上传配置密钥及其内容。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">config</span><span class="o">-</span><span class="n">key</span> <span class="nb">set</span> <span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">val</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="df">
<h3>df<a class="headerlink" href="#df" title="Permalink to this headline">¶</a></h3>
<p>显示集群空闲空间状态。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">df</span> <span class="p">{</span><span class="n">detail</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="features">
<span id="ceph-features"></span><h3>features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h3>
<p>查看所有已连接守护进程、以及连入集群的各客户端的版本号及其功能，还有各功能、版本号集合对应的（守护进程、客户端）数量。
Ceph 的各个版本都有不同的功能集，以功能位掩码表示。新集群功能要求客户端也支持这些功能，否则不允许它们连接这些新功能。因为新功能或能力是系统升级后才启用的，（新集群）会阻止老客户端连接。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">features</span>
</pre></div>
</div>
</div>
<div class="section" id="fs">
<h3>fs<a class="headerlink" href="#fs" title="Permalink to this headline">¶</a></h3>
<p>用于管理 cephfs 文件系统，需额外加子命令。</p>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">ls</span></code> 用于罗列文件系统。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">fs</span> <span class="n">ls</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">new</span></code> 用指定的存储池 &lt;metadata&gt; 和 &lt;data&gt; 创建新文件系统。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">fs</span> <span class="n">new</span> <span class="o">&lt;</span><span class="n">fs_name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">metadata</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">data</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">reset</span></code> 仅适用于灾难恢复：重置成单 MDS 运行图。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">fs</span> <span class="n">reset</span> <span class="o">&lt;</span><span class="n">fs_name</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">--</span><span class="n">yes</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="n">really</span><span class="o">-</span><span class="n">mean</span><span class="o">-</span><span class="n">it</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">rm</span></code> 用于禁用指定文件系统。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">fs</span> <span class="n">rm</span> <span class="o">&lt;</span><span class="n">fs_name</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">--</span><span class="n">yes</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="n">really</span><span class="o">-</span><span class="n">mean</span><span class="o">-</span><span class="n">it</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="fsid">
<h3>fsid<a class="headerlink" href="#fsid" title="Permalink to this headline">¶</a></h3>
<p>显示集群的 FSID/UUID 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">fsid</span>
</pre></div>
</div>
</div>
<div class="section" id="health">
<h3>health<a class="headerlink" href="#health" title="Permalink to this headline">¶</a></h3>
<p>显示集群健康状况。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">health</span> <span class="p">{</span><span class="n">detail</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="heap">
<h3>heap<a class="headerlink" href="#heap" title="Permalink to this headline">¶</a></h3>
<p>显示堆栈使用信息（编译时启用了 tcmalloc 支持才可用）</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">heap</span> <span class="n">dump</span><span class="o">|</span><span class="n">start_profiler</span><span class="o">|</span><span class="n">stop_profiler</span><span class="o">|</span><span class="n">release</span><span class="o">|</span><span class="n">stats</span>
</pre></div>
</div>
</div>
<div class="section" id="injectargs">
<h3>injectargs<a class="headerlink" href="#injectargs" title="Permalink to this headline">¶</a></h3>
<p>向监视器注入配置参数。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">injectargs</span> <span class="o">&lt;</span><span class="n">injected_args</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">injected_args</span><span class="o">&gt;...</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="log">
<h3>log<a class="headerlink" href="#log" title="Permalink to this headline">¶</a></h3>
<p>把指定文本记录到监视器日志中。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">log</span> <span class="o">&lt;</span><span class="n">logtext</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">logtext</span><span class="o">&gt;...</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="mds">
<h3>mds<a class="headerlink" href="#mds" title="Permalink to this headline">¶</a></h3>
<p>用于元数据服务器的配置和管理，需额外指定子命令。</p>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">compat</span></code> 管理兼容功能，需额外指定子命令。</p>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">rm_compat</span></code> 可删除兼容功能。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mds</span> <span class="n">compat</span> <span class="n">rm_compat</span> <span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">rm_incompat</span></code> 可删除不兼容的功能。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mds</span> <span class="n">compat</span> <span class="n">rm_incompat</span> <span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">show</span></code> 可查看 mds 的兼容性选项。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mds</span> <span class="n">compat</span> <span class="n">show</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">fail</span></code> 强制把 mds 状态设置为失效。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mds</span> <span class="n">fail</span> <span class="o">&lt;</span><span class="n">role</span><span class="o">|</span><span class="n">gid</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">rm</span></code> 用于删除不活跃的 mds 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mds</span> <span class="n">rm</span> <span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="p">(</span><span class="nb">type</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">rmfailed</span></code> 用于删除失效的 mds 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mds</span> <span class="n">rmfailed</span> <span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">set_state</span></code> 把 mds 状态从 &lt;gid&gt; 改为 &lt;numeric-state&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mds</span> <span class="n">set_state</span> <span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="mi">20</span><span class="p">]</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">stat</span></code> 显示 MDS 状态。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mds</span> <span class="n">stat</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">repaired</span></code> 把损坏的 MDS rank 标记为不再是损坏的。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mds</span> <span class="n">repaired</span> <span class="o">&lt;</span><span class="n">role</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="mon">
<h3>mon<a class="headerlink" href="#mon" title="Permalink to this headline">¶</a></h3>
<p>用于监视器的配置和管理，需额外指定子命令。</p>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">add</span></code> 新增名为 &lt;name&gt; 的监视器，地址为 &lt;addr&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mon</span> <span class="n">add</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">IPaddr</span><span class="p">[:</span><span class="n">port</span><span class="p">]</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">dump</span></code> 转储格式化的 monmap ， epoch 号可选。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mon</span> <span class="n">dump</span> <span class="p">{</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">getmap</span></code> 用于获取 monmap 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mon</span> <span class="n">getmap</span> <span class="p">{</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">remove</span></code> 用于删除名为 &lt;name&gt; 的监视器。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mon</span> <span class="n">remove</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">stat</span></code> 汇总监视器状态。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mon</span> <span class="n">stat</span>
</pre></div>
</div>
</div>
<div class="section" id="mon-status">
<h3>mon_status<a class="headerlink" href="#mon-status" title="Permalink to this headline">¶</a></h3>
<p>报告监视器状态。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mon_status</span>
</pre></div>
</div>
</div>
<div class="section" id="mgr">
<h3>mgr<a class="headerlink" href="#mgr" title="Permalink to this headline">¶</a></h3>
<p>Ceph 管理器守护进程的配置和管理。</p>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">dump</span></code> 转储最新的 MgrMap ，其中有活跃的和备用的管理器守护进程。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mgr</span> <span class="n">dump</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">fail</span></code> 可把一个管理器守护进程标记为已失效，并把它从管理器运行图中删掉。如果它是活跃管理器，将会有一个备机顶替它。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mgr</span> <span class="n">fail</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">ls</span></code> 可罗列当前已启用的管理器模块（插件）。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mgr</span> <span class="n">module</span> <span class="n">ls</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">enable</span></code> 可启用一个管理器模块。可用模块在
MgrMap 内，可以用 <code class="docutils literal notranslate"><span class="pre">mgr</span> <span class="pre">dump</span></code> 查看。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mgr</span> <span class="n">module</span> <span class="n">enable</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">disable</span></code> 可禁用当前活跃的管理器模块。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mgr</span> <span class="n">module</span> <span class="n">disable</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">metadata</span></code> 可显示所有管理器守护进程的元数据；如果指定了名字，就只显示它的。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mgr</span> <span class="n">metadata</span> <span class="p">[</span><span class="n">name</span><span class="p">]</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">versions</span></code> 可显示所有在运行守护进程的版本个数。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mgr</span> <span class="n">versions</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">count-metadata</span></code> 可显示任意守护进程的元数据字段个数。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mgr</span> <span class="n">count</span><span class="o">-</span><span class="n">metadata</span> <span class="o">&lt;</span><span class="n">field</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="osd">
<span id="ceph-admin-osd"></span><h3>osd<a class="headerlink" href="#osd" title="Permalink to this headline">¶</a></h3>
<p>用于配置和管理 OSD ，需额外指定子命令。</p>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">blacklist</span></code> 用于管理客户端黑名单，需额外加子命令。</p>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">add</span></code> 用于把 &lt;addr&gt; 加入黑名单（可指定时间，从现在起 &lt;expire&gt; 秒）。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">blacklist</span> <span class="n">add</span> <span class="o">&lt;</span><span class="n">EntityAddr</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">&lt;</span><span class="nb">float</span><span class="p">[</span><span class="mf">0.0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">ls</span></code> 列出进黑名单的客户端。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">blacklist</span> <span class="n">ls</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">rm</span></code> 从黑名单里删除 &lt;addr&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">blacklist</span> <span class="n">rm</span> <span class="o">&lt;</span><span class="n">EntityAddr</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">blocked-by</span></code> 用于罗列哪些 OSD 在阻塞互联。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">blocked</span><span class="o">-</span><span class="n">by</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">create</span></code> 用于新建 OSD ， UUID 和 ID 是可选的。</p>
<p>从 Luminous 版起，此命令已<strong>废弃</strong>，未来会删除。</p>
<p>请改用 <code class="docutils literal notranslate"><span class="pre">new</span></code> 子命令。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">create</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">uuid</span><span class="o">&gt;</span><span class="p">}</span> <span class="p">{</span><span class="o">&lt;</span><span class="nb">id</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">new</span></code> 可用来创建新 OSD 或者重新创建之前销毁的已经分配过 <em>id</em> 的 OSD ；这个新 OSD 会用指定的 <em>uuid</em> ，此命令还需指定一个 JSON 文件，其内有认证实体 <em>client.osd.&lt;id&gt;</em> 的
base64 编码 cephx 密钥；还有些可选项，如访问 dm-crypt 密码箱的
base64 编码 cephx 密钥、和一个 dm-crypt 密钥。指定 dm-crypt
密钥时，还必须同时指定密码箱的 cephx 密钥。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">new</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">uuid</span><span class="o">&gt;</span><span class="p">}</span> <span class="p">{</span><span class="o">&lt;</span><span class="nb">id</span><span class="o">&gt;</span><span class="p">}</span> <span class="o">-</span><span class="n">i</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">params</span><span class="o">.</span><span class="n">json</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>JSON 文件内的参数是可选的，但是如果设置了，就必须遵守下面的几种格式之一：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;cephx_secret&quot;</span><span class="p">:</span> <span class="s2">&quot;AQBWtwhZdBO5ExAAIDyjK2Bh16ZXylmzgYYEjg==&quot;</span><span class="p">,</span>
    <span class="s2">&quot;crush_device_class&quot;</span><span class="p">:</span> <span class="s2">&quot;myclass&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>或者：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;cephx_secret&quot;</span><span class="p">:</span> <span class="s2">&quot;AQBWtwhZdBO5ExAAIDyjK2Bh16ZXylmzgYYEjg==&quot;</span><span class="p">,</span>
    <span class="s2">&quot;cephx_lockbox_secret&quot;</span><span class="p">:</span> <span class="s2">&quot;AQDNCglZuaeVCRAAYr76PzR1Anh7A0jswkODIQ==&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dmcrypt_key&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;dm-crypt key&gt;&quot;</span><span class="p">,</span>
    <span class="s2">&quot;crush_device_class&quot;</span><span class="p">:</span> <span class="s2">&quot;myclass&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>或者：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;crush_device_class&quot;</span><span class="p">:</span> <span class="s2">&quot;myclass&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">crush_device_class</span></code> 属性是可选的；指定后，它将是新 OSD 的初始 CRUSH 设备类。</p>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">crush</span></code> 用于 CRUSH 管理，需额外指定子命令。</p>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">add</span></code> 可用于新增或更新 &lt;name&gt; 的 crushmap 位置及权重，权重改为 &lt;weight&gt; 、位置为 &lt;args&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">add</span> <span class="o">&lt;</span><span class="n">osdname</span> <span class="p">(</span><span class="nb">id</span><span class="o">|</span><span class="n">osd</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">float</span><span class="p">[</span><span class="mf">0.0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">args</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">args</span><span class="o">&gt;...</span><span class="p">]</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">add-bucket</span></code> 可新增没有父级（可能是 root ）、类型为 &lt;type&gt; 、名为 &lt;name&gt; 的 crush 桶。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">add</span><span class="o">-</span><span class="n">bucket</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">create-or-move</span></code> 用于创建名为 &lt;name&gt; 、权重为 &lt;weight&gt; 的条目并放置到 &lt;args&gt; ，若已存在则移动到指定位置 &lt;args&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">create</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="n">move</span> <span class="o">&lt;</span><span class="n">osdname</span> <span class="p">(</span><span class="nb">id</span><span class="o">|</span><span class="n">osd</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">float</span><span class="p">[</span><span class="mf">0.0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">args</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">args</span><span class="o">&gt;...</span><span class="p">]</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">dump</span></code> 用于转储 crush 图。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">dump</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">get-tunable</span></code> 用于获取 CRUSH 可调值 straw_calc_version 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">get</span><span class="o">-</span><span class="n">tunable</span> <span class="n">straw_calc_version</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">link</span></code> 用于把已存在条目 &lt;name&gt; 链接到 &lt;args&gt; 位置下。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">link</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">args</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">args</span><span class="o">&gt;...</span><span class="p">]</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">move</span></code> 可把已有条目 &lt;name&gt; 移动到 &lt;args&gt; 位置。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">move</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">args</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">args</span><span class="o">&gt;...</span><span class="p">]</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">remove</span></code> 把 crush 图中（任意位置，或 &lt;ancestor&gt; 之下的）的 &lt;name&gt; 删掉。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">remove</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">ancestor</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">rename-bucket</span></code> 可把桶 &lt;srcname&gt; 重命名为 &lt;dstname&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">rename</span><span class="o">-</span><span class="n">bucket</span> <span class="o">&lt;</span><span class="n">srcname</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">dstname</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">reweight</span></code> 把 crush 图中 &lt;name&gt; 的权重改为 &lt;weight&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">reweight</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">float</span><span class="p">[</span><span class="mf">0.0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">reweight-all</span></code> 重新计算树的权重，以确保权重之和没算错。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">reweight</span><span class="o">-</span><span class="nb">all</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">reweight-subtree</span></code> 用于把 CRUSH 图内 &lt;name&gt; 之下的所有叶子条目的权重改为 &lt;weight&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">reweight</span><span class="o">-</span><span class="n">subtree</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">weight</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">rm</span></code> 把 crush 图中（任意位置，或 &lt;ancestor&gt; 之下的）的 &lt;name&gt; 删掉。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">rm</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">ancestor</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">rule</span></code> 用于创建 crush 规则，需额外加子命令。</p>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">create-erasure</span></code> 可为纠删码存储池（用 &lt;profile&gt; 创建的））创建名为 &lt;name&gt; 的 crush 规则，默认为 default 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">rule</span> <span class="n">create</span><span class="o">-</span><span class="n">erasure</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">profile</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">create-simple</span></code> 创建从 &lt;root&gt; 开始、名为 &lt;name&gt; 的 crush 规则，副本将跨 &lt;type&gt; 类型进行散布，选择模式为 &lt;firstn|indep&gt; （默认 firstn ，indep 更适合纠删码存储池）。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">rule</span> <span class="n">create</span><span class="o">-</span><span class="n">simple</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">root</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">type</span><span class="o">&gt;</span> <span class="p">{</span><span class="n">firstn</span><span class="o">|</span><span class="n">indep</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">dump</span></code> 转储名为 &lt;name&gt; 的 crush 规则，默认全部转储。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">rule</span> <span class="n">dump</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">ls</span></code> 罗列 crush 规则。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">rule</span> <span class="n">ls</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">rm</span></code> 删除 crush 规则 &lt;name&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">rule</span> <span class="n">rm</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">set</span></code> 单独使用，把输入文件设置为 crush 图。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="nb">set</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">set</span></code> 为 osdname 或 osd.id 更新 crush 图的位置和权重信息，把名为 &lt;name&gt; 的 OSD 权重设置为 &lt;weight&gt; 、位置设置为 &lt;args&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="nb">set</span> <span class="o">&lt;</span><span class="n">osdname</span> <span class="p">(</span><span class="nb">id</span><span class="o">|</span><span class="n">osd</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">float</span><span class="p">[</span><span class="mf">0.0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">args</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">args</span><span class="o">&gt;...</span><span class="p">]</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">set-tunable</span></code> 把可调值 &lt;tunable&gt; 设置为 &lt;value&gt; 。唯一能设置的可调值是 straw_calc_version 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="nb">set</span><span class="o">-</span><span class="n">tunable</span> <span class="n">straw_calc_version</span> <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">show-tunables</span></code> 显示当前的 crush 可调值。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">show</span><span class="o">-</span><span class="n">tunables</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">tree</span></code> 用树状视图显示各 crush 桶、及各条目。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">tree</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">tunables</span></code> 设置 &lt;profile&gt; 中的 crush 可调值。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">tunables</span> <span class="n">legacy</span><span class="o">|</span><span class="n">argonaut</span><span class="o">|</span><span class="n">bobtail</span><span class="o">|</span><span class="n">firefly</span><span class="o">|</span><span class="n">hammer</span><span class="o">|</span><span class="n">optimal</span><span class="o">|</span><span class="n">default</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">unlink</span></code> 从 crush 图中解链接出 &lt;name&gt; （任意位置，或 &lt;ancestor&gt; 之下的）。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">crush</span> <span class="n">unlink</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">ancestor</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">df</span></code> 用于显示 OSD 利用率。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">df</span> <span class="p">{</span><span class="n">plain</span><span class="o">|</span><span class="n">tree</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">deep-scrub</span></code> 可启动指定 OSD 的深度洗刷。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">deep</span><span class="o">-</span><span class="n">scrub</span> <span class="o">&lt;</span><span class="n">who</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">down</span></code> 把 osd(s) &lt;id&gt; [&lt;id&gt;…] 状态设置为 down 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">down</span> <span class="o">&lt;</span><span class="n">ids</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">ids</span><span class="o">&gt;...</span><span class="p">]</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">dump</span></code> 打印 OSD 图汇总。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">dump</span> <span class="p">{</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">erasure-code-profile</span></code> 用于管理纠删码配置，需额外加子命令。</p>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">get</span></code> 读取纠删码配置 &lt;name&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">erasure</span><span class="o">-</span><span class="n">code</span><span class="o">-</span><span class="n">profile</span> <span class="n">get</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">ls</span></code> 罗列所有纠删码配置。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">erasure</span><span class="o">-</span><span class="n">code</span><span class="o">-</span><span class="n">profile</span> <span class="n">ls</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">rm</span></code> 删除纠删码配置 &lt;name&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">erasure</span><span class="o">-</span><span class="n">code</span><span class="o">-</span><span class="n">profile</span> <span class="n">rm</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">set</span></code> 用给定的参数 [&lt;key[=value]&gt; …] 创建纠删码配置 &lt;name&gt; 。末尾加 –force 可覆盖已有配置（慎用）。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">erasure</span><span class="o">-</span><span class="n">code</span><span class="o">-</span><span class="n">profile</span> <span class="nb">set</span> <span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">profile</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">profile</span><span class="o">&gt;...</span><span class="p">]}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">find</span></code> 从 CRUSH 图中找到 osd &lt;id&gt; 并显示其位置。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">find</span> <span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">getcrushmap</span></code> 获取 CRUSH 图。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">getcrushmap</span> <span class="p">{</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">getmap</span></code> 获取 OSD 图。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">getmap</span> <span class="p">{</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">getmaxosd</span></code> 显示最大 OSD 惟一标识符。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">getmaxosd</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">in</span></code> 把给出的 OSD &lt;id&gt; [&lt;id&gt;…] 标识为 in 状态。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">ids</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">ids</span><span class="o">&gt;...</span><span class="p">]</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">lost</span></code> 把 OSD 标识为永久丢失。如果没有多个副本，此命令会导致数据丢失，慎用。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">lost</span> <span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">--</span><span class="n">yes</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="n">really</span><span class="o">-</span><span class="n">mean</span><span class="o">-</span><span class="n">it</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">ls</span></code> 显示所有 OSD 的惟一标识符。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">ls</span> <span class="p">{</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">lspools</span></code> 罗列存储池。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">lspools</span> <span class="p">{</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">map</span></code> 在 &lt;pool&gt; 存储池中找 &lt;object&gt; 对象所在的归置组号码。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="nb">map</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">objectname</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">metadata</span></code> 为 osd &lt;id&gt; 取出元数据。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">metadata</span> <span class="p">{</span><span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="p">]}</span> <span class="p">(</span><span class="n">default</span> <span class="nb">all</span><span class="p">)</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">out</span></code> 把指定 OSD &lt;id&gt; [&lt;id&gt;…] 的状态设置为 out 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">out</span> <span class="o">&lt;</span><span class="n">ids</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">ids</span><span class="o">&gt;...</span><span class="p">]</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">ok-to-stop</span></code> 用于检查一些 OSD 是否能停止，而不会马上让其数据不可用。也就是说，尽管在降级模式（但还活跃着）下由于某些 PG 的失效导致数据冗余性降低了，所有数据仍然可读和可写。如果可以停止这些 OSD ，它就会返回一个成功代码；如果不行或者现在对于如何描述还没头绪，就返回一个错误代码和提示性消息。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">ok</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">stop</span> <span class="o">&lt;</span><span class="nb">id</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">ids</span><span class="o">&gt;...</span><span class="p">]</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">pause</span></code> 暂停 osd 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">pause</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">perf</span></code> 打印 OSD 的性能统计摘要。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">perf</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">pg-temp</span></code> 设置 pg_temp 映射 pgid:[&lt;id&gt; [&lt;id&gt;…]] ，适用于开发者。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">pg</span><span class="o">-</span><span class="n">temp</span> <span class="o">&lt;</span><span class="n">pgid</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">&lt;</span><span class="nb">id</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="nb">id</span><span class="o">&gt;...</span><span class="p">]}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">force-create-pg</span></code> 可强行创建 pg &lt;pgid&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">force</span><span class="o">-</span><span class="n">create</span><span class="o">-</span><span class="n">pg</span> <span class="o">&lt;</span><span class="n">pgid</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">pool</span></code> 用于管理数据存储池，需额外加子命令。</p>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">create</span></code> 创建存储池。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">pool</span> <span class="n">create</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span><span class="p">}</span> <span class="p">{</span><span class="n">replicated</span><span class="o">|</span><span class="n">erasure</span><span class="p">}</span>
<span class="p">{</span><span class="o">&lt;</span><span class="n">erasure_code_profile</span><span class="o">&gt;</span><span class="p">}</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">rule</span><span class="o">&gt;</span><span class="p">}</span> <span class="p">{</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">delete</span></code> 删除存储池。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">pool</span> <span class="n">delete</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span><span class="p">}</span> <span class="p">{</span><span class="o">--</span><span class="n">yes</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="n">really</span><span class="o">-</span><span class="n">really</span><span class="o">-</span><span class="n">mean</span><span class="o">-</span><span class="n">it</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">get</span></code> 获取存储池参数 &lt;var&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">pool</span> <span class="n">get</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span> <span class="n">size</span><span class="o">|</span><span class="n">min_size</span><span class="o">|</span><span class="n">pg_num</span><span class="o">|</span><span class="n">pgp_num</span><span class="o">|</span><span class="n">crush_rule</span><span class="o">|</span><span class="n">write_fadvise_dontneed</span>
</pre></div>
</div>
<p>以下命令只适用于分层存储池：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">pool</span> <span class="n">get</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span> <span class="n">hit_set_type</span><span class="o">|</span><span class="n">hit_set_period</span><span class="o">|</span><span class="n">hit_set_count</span><span class="o">|</span><span class="n">hit_set_fpp</span><span class="o">|</span>
<span class="n">target_max_objects</span><span class="o">|</span><span class="n">target_max_bytes</span><span class="o">|</span><span class="n">cache_target_dirty_ratio</span><span class="o">|</span><span class="n">cache_target_dirty_high_ratio</span><span class="o">|</span>
<span class="n">cache_target_full_ratio</span><span class="o">|</span><span class="n">cache_min_flush_age</span><span class="o">|</span><span class="n">cache_min_evict_age</span><span class="o">|</span>
<span class="n">min_read_recency_for_promote</span><span class="o">|</span><span class="n">hit_set_grade_decay_rate</span><span class="o">|</span><span class="n">hit_set_search_last_n</span>
</pre></div>
</div>
<p>以下命令只适用于纠删码存储池：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">pool</span> <span class="n">get</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span> <span class="n">erasure_code_profile</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">get-quota</span></code> 获取存储池的对象或字节数限额。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">pool</span> <span class="n">get</span><span class="o">-</span><span class="n">quota</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">ls</span></code> 用于罗列存储池。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">pool</span> <span class="n">ls</span> <span class="p">{</span><span class="n">detail</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">mksnap</span></code> 拍下存储池 &lt;pool&gt; 的快照 &lt;snap&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">pool</span> <span class="n">mksnap</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">snap</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">rename</span></code> 把存储池 &lt;srcpool&gt; 重命名为 &lt;destpool&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">pool</span> <span class="n">rename</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">rmsnap</span></code> 删除存储池 &lt;pool&gt; 的快照 &lt;snap&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">pool</span> <span class="n">rmsnap</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">snap</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">set</span></code> 把存储池参数 &lt;var&gt; 的值设置为 &lt;val&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">pool</span> <span class="nb">set</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span> <span class="n">size</span><span class="o">|</span><span class="n">min_size</span><span class="o">|</span><span class="n">pg_num</span><span class="o">|</span>
<span class="n">pgp_num</span><span class="o">|</span><span class="n">crush_rule</span><span class="o">|</span><span class="n">hashpspool</span><span class="o">|</span><span class="n">nodelete</span><span class="o">|</span><span class="n">nopgchange</span><span class="o">|</span><span class="n">nosizechange</span><span class="o">|</span>
<span class="n">hit_set_type</span><span class="o">|</span><span class="n">hit_set_period</span><span class="o">|</span><span class="n">hit_set_count</span><span class="o">|</span><span class="n">hit_set_fpp</span><span class="o">|</span><span class="n">debug_fake_ec_pool</span><span class="o">|</span>
<span class="n">target_max_bytes</span><span class="o">|</span><span class="n">target_max_objects</span><span class="o">|</span><span class="n">cache_target_dirty_ratio</span><span class="o">|</span>
<span class="n">cache_target_dirty_high_ratio</span><span class="o">|</span>
<span class="n">cache_target_full_ratio</span><span class="o">|</span><span class="n">cache_min_flush_age</span><span class="o">|</span><span class="n">cache_min_evict_age</span><span class="o">|</span>
<span class="n">min_read_recency_for_promote</span><span class="o">|</span><span class="n">write_fadvise_dontneed</span><span class="o">|</span><span class="n">hit_set_grade_decay_rate</span><span class="o">|</span>
<span class="n">hit_set_search_last_n</span>
<span class="o">&lt;</span><span class="n">val</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">--</span><span class="n">yes</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="n">really</span><span class="o">-</span><span class="n">mean</span><span class="o">-</span><span class="n">it</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">set-quota</span></code> 设置存储池的对象或字节数限额。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">pool</span> <span class="nb">set</span><span class="o">-</span><span class="n">quota</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span> <span class="n">max_objects</span><span class="o">|</span><span class="n">max_bytes</span> <span class="o">&lt;</span><span class="n">val</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">stats</span></code> 获取所有或指定存储池的统计信息。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">pool</span> <span class="n">stats</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">name</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">application</span></code> is used for adding an annotation to the given
pool. By default, the possible applications are object, block, and file
storage (corresponding app-names are “rgw”, “rbd”, and “cephfs”). However,
there might be other applications as well. Based on the application, there
may or may not be some processing conducted.</p>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">disable</span></code> disables the given application on the given pool.</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">pool</span> <span class="n">application</span> <span class="n">disable</span> <span class="o">&lt;</span><span class="n">pool</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">app</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">--</span><span class="n">yes</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="n">really</span><span class="o">-</span><span class="n">mean</span><span class="o">-</span><span class="n">it</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">enable</span></code> adds an annotation to the given pool for the mentioned
application.</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">pool</span> <span class="n">application</span> <span class="n">enable</span> <span class="o">&lt;</span><span class="n">pool</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">app</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">--</span><span class="n">yes</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="n">really</span><span class="o">-</span><span class="n">mean</span><span class="o">-</span><span class="n">it</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">get</span></code> displays the value for the given key that is associated
with the given application of the given pool. Not passing the optional
arguments would display all key-value pairs for all applications for all
pools.</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">pool</span> <span class="n">application</span> <span class="n">get</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">pool</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span><span class="p">}</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">app</span><span class="o">&gt;</span><span class="p">}</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">rm</span></code> removes the key-value pair for the given key in the given
application of the given pool.</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">pool</span> <span class="n">application</span> <span class="n">rm</span> <span class="o">&lt;</span><span class="n">pool</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">app</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">set</span></code> assosciates or updates, if it already exists, a key-value
pair with the given application for the given pool.</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">pool</span> <span class="n">application</span> <span class="nb">set</span> <span class="o">&lt;</span><span class="n">pool</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">app</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">key</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">primary-affinity</span></code> 设置主 OSD 亲和性，有效值范围 0.0 &lt;= &lt;weight&gt; &lt;= 1.0</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">primary</span><span class="o">-</span><span class="n">affinity</span> <span class="o">&lt;</span><span class="n">osdname</span> <span class="p">(</span><span class="nb">id</span><span class="o">|</span><span class="n">osd</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">float</span><span class="p">[</span><span class="mf">0.0</span><span class="o">-</span><span class="mf">1.0</span><span class="p">]</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">primary-temp</span></code> 设置 primary_temp 映射 pgid:&lt;id&gt;|-1 ，适用于开发者。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">primary</span><span class="o">-</span><span class="n">temp</span> <span class="o">&lt;</span><span class="n">pgid</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">id</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">repair</span></code> 让指定 OSD 开始修复。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">repair</span> <span class="o">&lt;</span><span class="n">who</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">reweight</span></code> 把 OSD 权重改为 0.0 &lt; &lt;weight&gt; &lt; 1.0 之间的值。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">osd</span> <span class="n">reweight</span> <span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">float</span><span class="p">[</span><span class="mf">0.0</span><span class="o">-</span><span class="mf">1.0</span><span class="p">]</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">reweight-by-pg</span></code> 按归置组分布情况调整 OSD 的权重（考虑的过载百分比，默认 120 ）。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">reweight</span><span class="o">-</span><span class="n">by</span><span class="o">-</span><span class="n">pg</span> <span class="p">{</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">100</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span><span class="p">}</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">poolname</span><span class="o">...</span><span class="p">]}</span>
<span class="p">{</span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">increasing</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">reweight-by-utilization</span></code> 按利用率调整 OSD 的权重，还需考虑负载比率，默认 120 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">reweight</span><span class="o">-</span><span class="n">by</span><span class="o">-</span><span class="n">utilization</span> <span class="p">{</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">100</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span><span class="p">}</span>
<span class="p">{</span><span class="o">--</span><span class="n">no</span><span class="o">-</span><span class="n">increasing</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">rm</span></code> 删除 OSD 运行图中的 OSD ，其编号为 &lt;id&gt; [&lt;id&gt;…] 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">rm</span> <span class="o">&lt;</span><span class="n">ids</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">ids</span><span class="o">&gt;...</span><span class="p">]</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">destroy</span></code> 把 OSD <em>id</em> 标记为 <em>destroyed （已销毁）</em>，并删除与之对应的的 cephx 密钥、以及 dm-crypt 配置、和守护进程私有的配置条目。</p>
<p>此命令不会从 crush 中删除这个 OSD ，也不会从 OSD 运行图中删除它；而是，一旦此命令正确无误地执行完，这个 OSD 的状态就是被标记为 <em>destroyed</em> 。</p>
<p>要把一个 OSD 标记为已销毁，它必须先被标记为
<strong>lost （丢失）</strong>。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">destroy</span> <span class="o">&lt;</span><span class="nb">id</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">--</span><span class="n">yes</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="n">really</span><span class="o">-</span><span class="n">mean</span><span class="o">-</span><span class="n">it</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">purge</span></code> 执行的是 <code class="docutils literal notranslate"><span class="pre">osd</span> <span class="pre">destroy</span></code> 、 <code class="docutils literal notranslate"><span class="pre">osd</span> <span class="pre">rm</span></code> 和
<code class="docutils literal notranslate"><span class="pre">osd</span> <span class="pre">crush</span> <span class="pre">remove</span></code> 命令的合体。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">purge</span> <span class="o">&lt;</span><span class="nb">id</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">--</span><span class="n">yes</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="n">really</span><span class="o">-</span><span class="n">mean</span><span class="o">-</span><span class="n">it</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">safe-to-destroy</span></code> 会检查在不降低整体数据冗余度或持久性的前提下，删除或销毁一个 OSD 是否安全。如果绝对安全，它会返回成功码；如果不是、或者现在还不能断定，它会返回错误码和提示消息。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">safe</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">destroy</span> <span class="o">&lt;</span><span class="nb">id</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">ids</span><span class="o">&gt;...</span><span class="p">]</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">scrub</span></code> 让指定 OSD 开始洗刷。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">scrub</span> <span class="o">&lt;</span><span class="n">who</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">set</span></code> 设置关键字 &lt;key&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="nb">set</span> <span class="n">full</span><span class="o">|</span><span class="n">pause</span><span class="o">|</span><span class="n">noup</span><span class="o">|</span><span class="n">nodown</span><span class="o">|</span><span class="n">noout</span><span class="o">|</span><span class="n">noin</span><span class="o">|</span><span class="n">nobackfill</span><span class="o">|</span>
<span class="n">norebalance</span><span class="o">|</span><span class="n">norecover</span><span class="o">|</span><span class="n">noscrub</span><span class="o">|</span><span class="n">nodeep</span><span class="o">-</span><span class="n">scrub</span><span class="o">|</span><span class="n">notieragent</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">setcrushmap</span></code> 把输入文件设置为 CRUSH 图。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">setcrushmap</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">setmaxosd</span></code> 设置最大 OSD 数值。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">setmaxosd</span> <span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">set-require-min-compat-client</span></code> 强制集群向后兼容，使之与指定的客户端版本相兼容。用这个子命令无需做破坏当前配置的更改（如 crush 可调值、或使用新功能）。请注意，如果存在与指定版本 &lt;version&gt; 的功能不兼容的已连接守护进程或客户端，这个子命令会失败。要查看已连入集群的所有客户端的功能和版本，请看 <a class="reference internal" href="#ceph-features">ceph features</a> 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="nb">set</span><span class="o">-</span><span class="n">require</span><span class="o">-</span><span class="nb">min</span><span class="o">-</span><span class="n">compat</span><span class="o">-</span><span class="n">client</span> <span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">stat</span></code> 打印 OSD 图摘要。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">stat</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">tier</span></code> 用于管理（存储池）分级，需额外加子命令。</p>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">add</span></code> 把 &lt;tierpool&gt; （第二个）加到基础存储池 &lt;pool&gt;
（第一个）之前。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">tier</span> <span class="n">add</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">--</span><span class="n">force</span><span class="o">-</span><span class="n">nonempty</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">add-cache</span></code> 把尺寸为 &lt;size&gt; 的缓存存储池 &lt;tierpool&gt;
（第二个）加到现有存储池 &lt;pool&gt; （第一个）之前。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">tier</span> <span class="n">add</span><span class="o">-</span><span class="n">cache</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">cache-mode</span></code> 设置缓存存储池 &lt;pool&gt; 的缓存模式。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">tier</span> <span class="n">cache</span><span class="o">-</span><span class="n">mode</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span> <span class="n">none</span><span class="o">|</span><span class="n">writeback</span><span class="o">|</span><span class="n">forward</span><span class="o">|</span><span class="n">readonly</span><span class="o">|</span>
<span class="n">readforward</span><span class="o">|</span><span class="n">readproxy</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">remove</span></code> 删掉基础存储池 &lt;pool&gt; （第一个）的马甲存储池
&lt;tierpool&gt; （第二个）。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">tier</span> <span class="n">remove</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">remove-overlay</span></code> 删除基础存储池 &lt;pool&gt; 的马甲存储池。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">tier</span> <span class="n">remove</span><span class="o">-</span><span class="n">overlay</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">set-overlay</span></code> 把 &lt;overlaypool&gt; 设置为基础存储池 &lt;pool&gt;
的马甲存储池。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">tier</span> <span class="nb">set</span><span class="o">-</span><span class="n">overlay</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">poolname</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">tree</span></code> 打印 OSD 树。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">tree</span> <span class="p">{</span><span class="o">&lt;</span><span class="nb">int</span><span class="p">[</span><span class="mi">0</span><span class="o">-</span><span class="p">]</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">unpause</span></code> 取消 osd 暂停。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">unpause</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">unset</span></code> 取消设置的关键字 &lt;key&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">osd</span> <span class="n">unset</span> <span class="n">full</span><span class="o">|</span><span class="n">pause</span><span class="o">|</span><span class="n">noup</span><span class="o">|</span><span class="n">nodown</span><span class="o">|</span><span class="n">noout</span><span class="o">|</span><span class="n">noin</span><span class="o">|</span><span class="n">nobackfill</span><span class="o">|</span>
<span class="n">norebalance</span><span class="o">|</span><span class="n">norecover</span><span class="o">|</span><span class="n">noscrub</span><span class="o">|</span><span class="n">nodeep</span><span class="o">-</span><span class="n">scrub</span><span class="o">|</span><span class="n">notieragent</span>
</pre></div>
</div>
</div>
<div class="section" id="pg">
<h3>pg<a class="headerlink" href="#pg" title="Permalink to this headline">¶</a></h3>
<p>用于管理 OSD 内的归置组，需额外加子命令。</p>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">debug</span></code> 可显示归置组的调试信息。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">pg</span> <span class="n">debug</span> <span class="n">unfound_objects_exist</span><span class="o">|</span><span class="n">degraded_pgs_exist</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">deep-scrub</span></code> 开始深度洗刷归置组 &lt;pgid&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">pg</span> <span class="n">deep</span><span class="o">-</span><span class="n">scrub</span> <span class="o">&lt;</span><span class="n">pgid</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">dump</span></code> 可显示归置组图的人类可读版本（显示为纯文本时只有 ‘all’ 合法）。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">pg</span> <span class="n">dump</span> <span class="p">{</span><span class="nb">all</span><span class="o">|</span><span class="n">summary</span><span class="o">|</span><span class="nb">sum</span><span class="o">|</span><span class="n">delta</span><span class="o">|</span><span class="n">pools</span><span class="o">|</span><span class="n">osds</span><span class="o">|</span><span class="n">pgs</span><span class="o">|</span><span class="n">pgs_brief</span><span class="p">}</span> <span class="p">[{</span><span class="nb">all</span><span class="o">|</span><span class="n">summary</span><span class="o">|</span><span class="nb">sum</span><span class="o">|</span><span class="n">delta</span><span class="o">|</span><span class="n">pools</span><span class="o">|</span><span class="n">osds</span><span class="o">|</span><span class="n">pgs</span><span class="o">|</span><span class="n">pgs_brief</span><span class="o">...</span><span class="p">]}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">dump_json</span></code> 只以 json 格式显示归置组图的人类可读版本。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">pg</span> <span class="n">dump_json</span> <span class="p">{</span><span class="nb">all</span><span class="o">|</span><span class="n">summary</span><span class="o">|</span><span class="nb">sum</span><span class="o">|</span><span class="n">delta</span><span class="o">|</span><span class="n">pools</span><span class="o">|</span><span class="n">osds</span><span class="o">|</span><span class="n">pgs</span><span class="o">|</span><span class="n">pgs_brief</span><span class="p">}</span> <span class="p">[{</span><span class="nb">all</span><span class="o">|</span><span class="n">summary</span><span class="o">|</span><span class="nb">sum</span><span class="o">|</span><span class="n">delta</span><span class="o">|</span><span class="n">pools</span><span class="o">|</span><span class="n">osds</span><span class="o">|</span><span class="n">pgs</span><span class="o">|</span><span class="n">pgs_brief</span><span class="o">...</span><span class="p">]}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">dump_pools_json</span></code> 只以 json 格式显示归置组存储池信息［译者：存疑］。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">pg</span> <span class="n">dump_pools_json</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">dump_stuck</span></code> 显示卡顿归置组的信息。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">pg</span> <span class="n">dump_stuck</span> <span class="p">{</span><span class="n">inactive</span><span class="o">|</span><span class="n">unclean</span><span class="o">|</span><span class="n">stale</span><span class="o">|</span><span class="n">undersized</span><span class="o">|</span><span class="n">degraded</span> <span class="p">[</span><span class="n">inactive</span><span class="o">|</span><span class="n">unclean</span><span class="o">|</span><span class="n">stale</span><span class="o">|</span><span class="n">undersized</span><span class="o">|</span><span class="n">degraded</span><span class="o">...</span><span class="p">]}</span>
<span class="p">{</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">getmap</span></code> 获取二进制归置组图，保存到 -o/stdout 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">pg</span> <span class="n">getmap</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">ls</span></code> 可根据指定存储池、 OSD 、状态罗列对应的归置组。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">pg</span> <span class="n">ls</span> <span class="p">{</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">}</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">pg</span><span class="o">-</span><span class="n">state</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">pg</span><span class="o">-</span><span class="n">state</span><span class="o">&gt;...</span><span class="p">]}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">ls-by-osd</span></code> 用于罗列指定 OSD 上的归置组。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">pg</span> <span class="n">ls</span><span class="o">-</span><span class="n">by</span><span class="o">-</span><span class="n">osd</span> <span class="o">&lt;</span><span class="n">osdname</span> <span class="p">(</span><span class="nb">id</span><span class="o">|</span><span class="n">osd</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">}</span>
<span class="p">{</span><span class="o">&lt;</span><span class="n">pg</span><span class="o">-</span><span class="n">state</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">pg</span><span class="o">-</span><span class="n">state</span><span class="o">&gt;...</span><span class="p">]}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">ls-by-pool</span></code> 用于罗列存储池 [poolname] 内的归置组。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">pg</span> <span class="n">ls</span><span class="o">-</span><span class="n">by</span><span class="o">-</span><span class="n">pool</span> <span class="o">&lt;</span><span class="n">poolstr</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">}</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">pg</span><span class="o">-</span><span class="n">state</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">pg</span><span class="o">-</span><span class="n">state</span><span class="o">&gt;...</span><span class="p">]}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">ls-by-primary</span></code> 可罗列主 OSD 为 [osd] 的归置组。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">pg</span> <span class="n">ls</span><span class="o">-</span><span class="n">by</span><span class="o">-</span><span class="n">primary</span> <span class="o">&lt;</span><span class="n">osdname</span> <span class="p">(</span><span class="nb">id</span><span class="o">|</span><span class="n">osd</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">&gt;</span> <span class="p">{</span><span class="o">&lt;</span><span class="nb">int</span><span class="o">&gt;</span><span class="p">}</span>
<span class="p">{</span><span class="o">&lt;</span><span class="n">pg</span><span class="o">-</span><span class="n">state</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">pg</span><span class="o">-</span><span class="n">state</span><span class="o">&gt;...</span><span class="p">]}</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">map</span></code> 显示归置组到 OSD 的映射关系。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">pg</span> <span class="nb">map</span> <span class="o">&lt;</span><span class="n">pgid</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">repair</span></code> 开始修复归置组 &lt;pgid&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">pg</span> <span class="n">repair</span> <span class="o">&lt;</span><span class="n">pgid</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">scrub</span></code> 开始洗刷归置组 &lt;pgid&gt; 。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">pg</span> <span class="n">scrub</span> <span class="o">&lt;</span><span class="n">pgid</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>子命令 <code class="docutils literal notranslate"><span class="pre">stat</span></code> 显示归置组状态。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">pg</span> <span class="n">stat</span>
</pre></div>
</div>
</div>
<div class="section" id="quorum">
<h3>quorum<a class="headerlink" href="#quorum" title="Permalink to this headline">¶</a></h3>
<p>让监视器加入或退出法定人数。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">quorum</span> <span class="n">enter</span><span class="o">|</span><span class="n">exit</span>
</pre></div>
</div>
<p>注：此命令只对 <code class="docutils literal notranslate"><span class="pre">ceph</span></code> 命令能连接上的监视器管用。如果你想让某个具体的监视器加入或退出法定人数，可以用下面这个命令：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">tell</span> <span class="n">mon</span><span class="o">.&lt;</span><span class="nb">id</span><span class="o">&gt;</span> <span class="n">quorum</span> <span class="n">enter</span><span class="o">|</span><span class="n">exit</span>
</pre></div>
</div>
</div>
<div class="section" id="quorum-status">
<h3>quorum_status<a class="headerlink" href="#quorum-status" title="Permalink to this headline">¶</a></h3>
<p>报告监视器法定人数状态。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">quorum_status</span>
</pre></div>
</div>
</div>
<div class="section" id="report">
<h3>report<a class="headerlink" href="#report" title="Permalink to this headline">¶</a></h3>
<p>报告集群的全部状态，标签字符串可选。
Reports full status of cluster, optional title tag strings.</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">report</span> <span class="p">{</span><span class="o">&lt;</span><span class="n">tags</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">tags</span><span class="o">&gt;...</span><span class="p">]}</span>
</pre></div>
</div>
</div>
<div class="section" id="scrub">
<h3>scrub<a class="headerlink" href="#scrub" title="Permalink to this headline">¶</a></h3>
<p>洗刷监视器的存储。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">scrub</span>
</pre></div>
</div>
</div>
<div class="section" id="status">
<h3>status<a class="headerlink" href="#status" title="Permalink to this headline">¶</a></h3>
<p>显示集群状态。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">status</span>
</pre></div>
</div>
</div>
<div class="section" id="sync-force">
<h3>sync force<a class="headerlink" href="#sync-force" title="Permalink to this headline">¶</a></h3>
<p>强制监视器进行同步、并清除存储。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">sync</span> <span class="n">force</span> <span class="p">{</span><span class="o">--</span><span class="n">yes</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="n">really</span><span class="o">-</span><span class="n">mean</span><span class="o">-</span><span class="n">it</span><span class="p">}</span> <span class="p">{</span><span class="o">--</span><span class="n">i</span><span class="o">-</span><span class="n">know</span><span class="o">-</span><span class="n">what</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="n">am</span><span class="o">-</span><span class="n">doing</span><span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="tell">
<h3>tell<a class="headerlink" href="#tell" title="Permalink to this headline">¶</a></h3>
<p>发命令给指定守护进程。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">tell</span> <span class="o">&lt;</span><span class="n">name</span> <span class="p">(</span><span class="nb">type</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">args</span><span class="o">&gt;</span> <span class="p">[</span><span class="o">&lt;</span><span class="n">args</span><span class="o">&gt;...</span><span class="p">]</span>
</pre></div>
</div>
<p>罗列所有可用的命令。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">tell</span> <span class="o">&lt;</span><span class="n">name</span> <span class="p">(</span><span class="nb">type</span><span class="o">.</span><span class="n">id</span><span class="p">)</span><span class="o">&gt;</span> <span class="n">help</span>
</pre></div>
</div>
</div>
<div class="section" id="version">
<h3>version<a class="headerlink" href="#version" title="Permalink to this headline">¶</a></h3>
<p>显示监视器守护进程的版本。</p>
<p>用法：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">version</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id4">
<h2>选项<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<dl class="option">
<dt id="cmdoption-ceph-i">
<code class="sig-name descname">-i</code><code class="sig-prename descclassname"> infile</code><a class="headerlink" href="#cmdoption-ceph-i" title="Permalink to this definition">¶</a></dt>
<dd><p>指定一个输入文件，它将作为载荷与命令一起传递给监视器集群。仅用于某些特定的监视器命令。</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ceph-o">
<code class="sig-name descname">-o</code><code class="sig-prename descclassname"> outfile</code><a class="headerlink" href="#cmdoption-ceph-o" title="Permalink to this definition">¶</a></dt>
<dd><p>把响应中监视器集群返回的载荷写入 outfile 文件。只有某些特定的监视器命令（如 psd getmap ）会返回载荷。</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ceph-c">
<code class="sig-name descname">-c</code><code class="sig-prename descclassname"> ceph.conf</code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--conf</code><code class="sig-prename descclassname">=ceph.conf</code><a class="headerlink" href="#cmdoption-ceph-c" title="Permalink to this definition">¶</a></dt>
<dd><p>用 ceph.conf 配置文件而非默认的 <code class="docutils literal notranslate"><span class="pre">/etc/ceph/ceph.conf</span></code> 来确定启动时所用的监视器地址。</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ceph-id">
<code class="sig-name descname">--id</code><code class="sig-prename descclassname"> CLIENT_ID</code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--user</code><code class="sig-prename descclassname"> CLIENT_ID</code><a class="headerlink" href="#cmdoption-ceph-id" title="Permalink to this definition">¶</a></dt>
<dd><p>用于认证的客户端 ID 。</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ceph-name">
<code class="sig-name descname">--name</code><code class="sig-prename descclassname"> CLIENT_NAME</code><code class="sig-prename descclassname">, </code><code class="sig-name descname">-n</code><code class="sig-prename descclassname"> CLIENT_NAME</code><a class="headerlink" href="#cmdoption-ceph-name" title="Permalink to this definition">¶</a></dt>
<dd><p>用于认证的客户端名字。</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ceph-cluster">
<code class="sig-name descname">--cluster</code><code class="sig-prename descclassname"> CLUSTER</code><a class="headerlink" href="#cmdoption-ceph-cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Ceph 集群名字。</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ceph-admin-daemon">
<code class="sig-name descname">--admin-daemon</code><code class="sig-prename descclassname"> ADMIN_SOCKET</code><code class="sig-prename descclassname">, </code><code class="sig-name descname">daemon</code><code class="sig-prename descclassname"> DAEMON_NAME</code><a class="headerlink" href="#cmdoption-ceph-admin-daemon" title="Permalink to this definition">¶</a></dt>
<dd><p>提交管理套接字命令。</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ceph-admin-socket">
<code class="sig-name descname">--admin-socket</code><code class="sig-prename descclassname"> ADMIN_SOCKET_NOPE</code><a class="headerlink" href="#cmdoption-ceph-admin-socket" title="Permalink to this definition">¶</a></dt>
<dd><p>你也许想要的是 –admin-daemon 。</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ceph-s">
<code class="sig-name descname">-s</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--status</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-ceph-s" title="Permalink to this definition">¶</a></dt>
<dd><p>显示集群状态。</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ceph-w">
<code class="sig-name descname">-w</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--watch</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-ceph-w" title="Permalink to this definition">¶</a></dt>
<dd><p>盯着集群的实时状态变更。</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ceph-watch-debug">
<code class="sig-name descname">--watch-debug</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-ceph-watch-debug" title="Permalink to this definition">¶</a></dt>
<dd><p>盯着调试事件。</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ceph-watch-info">
<code class="sig-name descname">--watch-info</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-ceph-watch-info" title="Permalink to this definition">¶</a></dt>
<dd><p>盯着一般信息事件。</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ceph-watch-sec">
<code class="sig-name descname">--watch-sec</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-ceph-watch-sec" title="Permalink to this definition">¶</a></dt>
<dd><p>盯着安全事件。</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ceph-watch-warn">
<code class="sig-name descname">--watch-warn</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-ceph-watch-warn" title="Permalink to this definition">¶</a></dt>
<dd><p>盯着告警事件。</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ceph-watch-error">
<code class="sig-name descname">--watch-error</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-ceph-watch-error" title="Permalink to this definition">¶</a></dt>
<dd><p>盯着错误事件。</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ceph-version">
<code class="sig-name descname">--version</code><code class="sig-prename descclassname"></code><code class="sig-prename descclassname">, </code><code class="sig-name descname">-v</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-ceph-version" title="Permalink to this definition">¶</a></dt>
<dd><p>显示版本号。</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ceph-verbose">
<code class="sig-name descname">--verbose</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-ceph-verbose" title="Permalink to this definition">¶</a></dt>
<dd><p>使输出更详细。</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ceph-concise">
<code class="sig-name descname">--concise</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-ceph-concise" title="Permalink to this definition">¶</a></dt>
<dd><p>使输出简洁些。</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ceph-f">
<code class="sig-name descname">-f</code><code class="sig-prename descclassname"> {json,json-pretty,xml,xml-pretty,plain}</code><code class="sig-prename descclassname">, </code><code class="sig-name descname">--format</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-ceph-f" title="Permalink to this definition">¶</a></dt>
<dd><p>输出格式。</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ceph-connect-timeout">
<code class="sig-name descname">--connect-timeout</code><code class="sig-prename descclassname"> CLUSTER_TIMEOUT</code><a class="headerlink" href="#cmdoption-ceph-connect-timeout" title="Permalink to this definition">¶</a></dt>
<dd><p>设置连接集群的超时值。</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ceph-no-increasing">
<code class="sig-name descname">--no-increasing</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-ceph-no-increasing" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">--no-increasing</span></code> 默认是关闭的，所以 <code class="docutils literal notranslate"><span class="pre">reweight-by-utilization</span></code>
或 <code class="docutils literal notranslate"><span class="pre">test-reweight-by-utilization</span></code> 命令可以增加 osd 权重。如果运行这些命令时加上这个选项，即使 osd 利用率偏低它也不会增加 osd 权重。</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-ceph-block">
<code class="sig-name descname">--block</code><code class="sig-prename descclassname"></code><a class="headerlink" href="#cmdoption-ceph-block" title="Permalink to this definition">¶</a></dt>
<dd><p>完成前一直阻塞（仅适用于 scrub 和 deep-scrub ）</p>
</dd></dl>

</div>
<div class="section" id="id5">
<h2>使用范围<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p><strong class="program">ceph</strong> 是 Ceph 的一部分，这是个伸缩力强、开源、分布式的存储系统，更多信息参见 <a class="reference external" href="http://ceph.com/docs">http://ceph.com/docs</a> 。</p>
</div>
<div class="section" id="id6">
<h2>参考<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../ceph-mon/"><span class="doc">ceph-mon</span></a>(8),
<a class="reference internal" href="../ceph-osd/"><span class="doc">ceph-osd</span></a>(8),
<a class="reference internal" href="../ceph-mds/"><span class="doc">ceph-mds</span></a>(8)</p>
</div>
</div>



          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../">
              <img class="logo" src="../../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../../">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../start/intro/">Ceph 简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install/">安装 Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cephadm/">Cephadm</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../rados/">Ceph 存储集群</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../rados/configuration/">配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rados/deployment/">部署</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rados/operations/">运维</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../rados/man/">手册页</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../ceph-volume/">ceph-volume – Ceph OSD 部署和检查工具</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-volume-systemd/">ceph-volume-systemd – systemd ceph-volume 辅助工具</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">ceph – Ceph 管理工具</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">提纲</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">描述</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id3">命令</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#auth">auth</a></li>
<li class="toctree-l5"><a class="reference internal" href="#compact">compact</a></li>
<li class="toctree-l5"><a class="reference internal" href="#config-key">config-key</a></li>
<li class="toctree-l5"><a class="reference internal" href="#df">df</a></li>
<li class="toctree-l5"><a class="reference internal" href="#features">features</a></li>
<li class="toctree-l5"><a class="reference internal" href="#fs">fs</a></li>
<li class="toctree-l5"><a class="reference internal" href="#fsid">fsid</a></li>
<li class="toctree-l5"><a class="reference internal" href="#health">health</a></li>
<li class="toctree-l5"><a class="reference internal" href="#heap">heap</a></li>
<li class="toctree-l5"><a class="reference internal" href="#injectargs">injectargs</a></li>
<li class="toctree-l5"><a class="reference internal" href="#log">log</a></li>
<li class="toctree-l5"><a class="reference internal" href="#mds">mds</a></li>
<li class="toctree-l5"><a class="reference internal" href="#mon">mon</a></li>
<li class="toctree-l5"><a class="reference internal" href="#mon-status">mon_status</a></li>
<li class="toctree-l5"><a class="reference internal" href="#mgr">mgr</a></li>
<li class="toctree-l5"><a class="reference internal" href="#osd">osd</a></li>
<li class="toctree-l5"><a class="reference internal" href="#pg">pg</a></li>
<li class="toctree-l5"><a class="reference internal" href="#quorum">quorum</a></li>
<li class="toctree-l5"><a class="reference internal" href="#quorum-status">quorum_status</a></li>
<li class="toctree-l5"><a class="reference internal" href="#report">report</a></li>
<li class="toctree-l5"><a class="reference internal" href="#scrub">scrub</a></li>
<li class="toctree-l5"><a class="reference internal" href="#status">status</a></li>
<li class="toctree-l5"><a class="reference internal" href="#sync-force">sync force</a></li>
<li class="toctree-l5"><a class="reference internal" href="#tell">tell</a></li>
<li class="toctree-l5"><a class="reference internal" href="#version">version</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#id4">选项</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">使用范围</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">参考</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-deploy/">ceph-deploy – Ceph 部署工具</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-authtool/">ceph-authtool – ceph 密钥环操作工具</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-clsinfo/">ceph-clsinfo – 查看类对象信息</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-conf/">ceph-conf – ceph 配置文件工具</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-debugpack/">ceph-debugpack – ceph 调试信息打包工具</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-dencoder/">ceph-dencoder – ceph 编码器/解码器工具</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-mon/">ceph-mon – ceph 监视器守护进程</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-osd/">ceph-osd – ceph 对象存储守护进程</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-kvstore-tool/">ceph-kvstore-tool – ceph 的 kvstore 操作工具</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-run/">ceph-run – 发生核心转储后重启守护进程</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-syn/">ceph-syn – ceph 的人造负载生成器</a></li>
<li class="toctree-l3"><a class="reference internal" href="../crushtool/">crushtool – CRUSH 图操作工具</a></li>
<li class="toctree-l3"><a class="reference internal" href="../librados-config/">librados-config – 显示关于 librados 的信息</a></li>
<li class="toctree-l3"><a class="reference internal" href="../monmaptool/">monmaptool – ceph 监视器运行图操作工具</a></li>
<li class="toctree-l3"><a class="reference internal" href="../osdmaptool/">osdmaptool – ceph osd 运行图操作工具</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rados/">rados – rados 对象存储工具</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-post-file/">ceph-post-file – 把文件上传给 ceph 开发者</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../rados/troubleshooting/">故障排除</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../rados/api/">APIs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../cephfs/">Ceph 文件系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rbd/">Ceph 块设备</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../radosgw/">Ceph 对象网关</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mgr/">Ceph 管理器守护进程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mgr/dashboard/">Ceph 仪表盘</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/">API 文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../architecture/">体系结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/developer_guide/">开发者指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/internals/">Ceph 内幕</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../governance/">项目管理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../foundation/">Ceph 基金会</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ceph-volume/">ceph-volume</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../releases/general/">Ceph 版本（总目录）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../releases/">Ceph 版本（索引）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary/">Ceph 术语</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../translation_cn/">中文版翻译资源</a></li>
</ul>


<!-- ugly kludge to make genindex look like it's part of the toc -->
<ul style="margin-top: -10px"><li class="toctree-l1"><a class="reference internal" href="../../../genindex/">Index</a></li></ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search/" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../ceph-deploy/" title="ceph-deploy – Ceph 部署工具"
             >next</a> |</li>
        <li class="right" >
          <a href="../ceph-volume-systemd/" title="ceph-volume-systemd – systemd ceph-volume 辅助工具"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../../rados/" >Ceph 存储集群</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../../../rados/man/" >对象存储手册页</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Ceph authors and contributors. Licensed under Creative Commons Attribution Share Alike 3.0 (CC-BY-SA-3.0).
    </div>
  </body>
</html>