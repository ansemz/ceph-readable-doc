
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Librados (C) &mdash; Ceph Documentation</title>
    
    <link rel="stylesheet" href="../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     'dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Ceph Documentation" href="../../../" />
    <link rel="up" title="Ceph 存储集群 API" href="../" />
    <link rel="next" title="LibradosPP (C++)" href="../libradospp/" />
    <link rel="prev" title="librados 简介" href="../librados-intro/" />
    

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../libradospp/" title="LibradosPP (C++)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../librados-intro/" title="librados 简介"
             accesskey="P">previous</a> |</li>
        <li><a href="../../../">Ceph Documentation</a> &raquo;</li>
          <li><a href="../../" >Ceph 存储集群</a> &raquo;</li>
          <li><a href="../" accesskey="U">Ceph 存储集群 API</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="librados-c">
<h1>Librados (C)<a class="headerlink" href="#librados-c" title="Permalink to this headline">¶</a></h1>
<p><cite>librados</cite> 提供了 RADOS 服务的底层访问功能， RADOS 概览参见<a class="reference internal" href="../../../architecture/"><em>体系结构</em></a>。</p>
<div class="section" id="id1">
<h2>实例：连接并写入一个对象<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>要使用 <cite>Librados</cite> ，先实例化一个 <a class="reference internal" href="#rados_t" title="rados_t"><tt class="xref c c-type docutils literal"><span class="pre">rados_t</span></tt></a> 变量（集群句柄）、再用指向它的指针调用 c:func:<cite>rados_create()</cite> ：</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="n">err</span><span class="p">;</span>
<span class="n">rados_t</span> <span class="n">cluster</span><span class="p">;</span>

<span class="n">err</span> <span class="o">=</span> <span class="n">rados_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">cluster</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;%s: cannot create a cluster handle: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">strerror</span><span class="p">(</span><span class="o">-</span><span class="n">err</span><span class="p">));</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>然后配置 <a class="reference internal" href="#rados_t" title="rados_t"><tt class="xref c c-type docutils literal"><span class="pre">rados_t</span></tt></a> 以连接集群，可以挨个配置（ <a class="reference internal" href="#rados_conf_set" title="rados_conf_set"><tt class="xref c c-func docutils literal"><span class="pre">rados_conf_set()</span></tt></a> ）、或用配置文件（ <a class="reference internal" href="#rados_conf_read_file" title="rados_conf_read_file"><tt class="xref c c-func docutils literal"><span class="pre">rados_conf_read_file()</span></tt></a> ）、或命令行选项（ <a class="reference internal" href="#rados_conf_parse_argv" title="rados_conf_parse_argv"><tt class="xref c c-func docutils literal"><span class="pre">rados_conf_parse_argv()</span></tt></a> ）、或环境变量（ <a class="reference internal" href="#rados_conf_parse_env" title="rados_conf_parse_env"><tt class="xref c c-func docutils literal"><span class="pre">rados_conf_parse_env()</span></tt></a> ）：</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="n">err</span> <span class="o">=</span> <span class="n">rados_conf_read_file</span><span class="p">(</span><span class="n">cluster</span><span class="p">,</span> <span class="s">&quot;/path/to/myceph.conf&quot;</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;%s: cannot read config file: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">strerror</span><span class="p">(</span><span class="o">-</span><span class="n">err</span><span class="p">));</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>集群句柄配置好后，就可以用 <a class="reference internal" href="#rados_connect" title="rados_connect"><tt class="xref c c-func docutils literal"><span class="pre">rados_connect()</span></tt></a> 连接了：</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="n">err</span> <span class="o">=</span> <span class="n">rados_connect</span><span class="p">(</span><span class="n">cluster</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;%s: cannot connect to cluster: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">strerror</span><span class="p">(</span><span class="o">-</span><span class="n">err</span><span class="p">));</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>然后打开一个“ IO 上下文”，用 <a class="reference internal" href="#rados_ioctx_create" title="rados_ioctx_create"><tt class="xref c c-func docutils literal"><span class="pre">rados_ioctx_create()</span></tt></a> 打开<a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t"><tt class="xref c c-type docutils literal"><span class="pre">rados_ioctx_t</span></tt></a> ：</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="n">rados_ioctx_t</span> <span class="n">io</span><span class="p">;</span>
<span class="kt">char</span> <span class="o">*</span><span class="n">poolname</span> <span class="o">=</span> <span class="s">&quot;mypool&quot;</span><span class="p">;</span>

<span class="n">err</span> <span class="o">=</span> <span class="n">rados_ioctx_create</span><span class="p">(</span><span class="n">cluster</span><span class="p">,</span> <span class="n">poolname</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">io</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;%s: cannot open rados pool %s: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">poolname</span><span class="p">,</span> <span class="n">strerror</span><span class="p">(</span><span class="o">-</span><span class="n">err</span><span class="p">));</span>
        <span class="n">rados_shutdown</span><span class="p">(</span><span class="n">cluster</span><span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>注意，你访问的存储池必须存在。</p>
<p>这时你能用 RADOS 数据修改函数了，例如用 <a class="reference internal" href="#rados_write_full" title="rados_write_full"><tt class="xref c c-func docutils literal"><span class="pre">rados_write_full()</span></tt></a> 写入名为 <tt class="docutils literal"><span class="pre">greeting</span></tt> 的对象：</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="n">err</span> <span class="o">=</span> <span class="n">rados_write_full</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="s">&quot;greeting&quot;</span><span class="p">,</span> <span class="s">&quot;hello&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;%s: cannot write pool %s: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">poolname</span><span class="p">,</span> <span class="n">strerror</span><span class="p">(</span><span class="o">-</span><span class="n">err</span><span class="p">));</span>
        <span class="n">rados_ioctx_destroy</span><span class="p">(</span><span class="n">io</span><span class="p">);</span>
        <span class="n">rados_shutdown</span><span class="p">(</span><span class="n">cluster</span><span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>最后，用 <a class="reference internal" href="#rados_ioctx_destroy" title="rados_ioctx_destroy"><tt class="xref c c-func docutils literal"><span class="pre">rados_ioctx_destroy()</span></tt></a> 和 <a class="reference internal" href="#rados_shutdown" title="rados_shutdown"><tt class="xref c c-func docutils literal"><span class="pre">rados_shutdown()</span></tt></a> 分别关闭 IO 上下文、到 RADOS 的连接：</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="n">rados_ioctx_destroy</span><span class="p">(</span><span class="n">io</span><span class="p">);</span>
<span class="n">rados_shutdown</span><span class="p">(</span><span class="n">cluster</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="io">
<span id="asychronous-io"></span><h2>异步 IO<a class="headerlink" href="#io" title="Permalink to this headline">¶</a></h2>
<p>处理大量 IO 时，通常不必等一个完成再开始下一个。 <cite>Librados</cite> 提供了几种操作的异步版本：</p>
<ul class="simple">
<li><a class="reference internal" href="#rados_aio_write" title="rados_aio_write"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_write()</span></tt></a></li>
<li><a class="reference internal" href="#rados_aio_append" title="rados_aio_append"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_append()</span></tt></a></li>
<li><a class="reference internal" href="#rados_aio_write_full" title="rados_aio_write_full"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_write_full()</span></tt></a></li>
<li><a class="reference internal" href="#rados_aio_read" title="rados_aio_read"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_read()</span></tt></a></li>
</ul>
<p>对每种操作，都必须先创建一个 <a class="reference internal" href="#rados_completion_t" title="rados_completion_t"><tt class="xref c c-type docutils literal"><span class="pre">rados_completion_t</span></tt></a> 数据结构来表达做什么、何时安全或显式地调用 <a class="reference internal" href="#rados_aio_create_completion" title="rados_aio_create_completion"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_create_completion()</span></tt></a> 来结束，如果没什么特殊需求，可以仅传递 NULL ：</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="n">rados_completion_t</span> <span class="n">comp</span><span class="p">;</span>
<span class="n">err</span> <span class="o">=</span> <span class="n">rados_aio_create_completion</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">comp</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;%s: could not create aio completion: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">strerror</span><span class="p">(</span><span class="o">-</span><span class="n">err</span><span class="p">));</span>
        <span class="n">rados_ioctx_destroy</span><span class="p">(</span><span class="n">io</span><span class="p">);</span>
        <span class="n">rados_shutdown</span><span class="p">(</span><span class="n">cluster</span><span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>现在你可以调用任意一种异步 IO 操作了，然后等它出现在内存、所有复制所在的硬盘里：</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="n">err</span> <span class="o">=</span> <span class="n">rados_aio_write</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="n">comp</span><span class="p">,</span> <span class="s">&quot;bar&quot;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;%s: could not schedule aio write: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">strerror</span><span class="p">(</span><span class="o">-</span><span class="n">err</span><span class="p">));</span>
        <span class="n">rados_aio_release</span><span class="p">(</span><span class="n">comp</span><span class="p">);</span>
        <span class="n">rados_ioctx_destroy</span><span class="p">(</span><span class="n">io</span><span class="p">);</span>
        <span class="n">rados_shutdown</span><span class="p">(</span><span class="n">cluster</span><span class="p">);</span>
        <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
<span class="n">rados_aio_wait_for_complete</span><span class="p">(</span><span class="n">comp</span><span class="p">);</span> <span class="c1">// in memory</span>
<span class="n">rados_aio_wait_for_safe</span><span class="p">(</span><span class="n">comp</span><span class="p">);</span> <span class="c1">// on disk</span>
</pre></div>
</div>
<p>最后，用 <a class="reference internal" href="#rados_aio_release" title="rados_aio_release"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_release()</span></tt></a> 释放内存：</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="n">rados_aio_release</span><span class="p">(</span><span class="n">comp</span><span class="p">);</span>
</pre></div>
</div>
<p>你可以用各种回叫函数告知应用程序何时可以持续写入、或何时读缓冲是满的。例如，如果你追加几个对象时想衡量每个操作的延时，可以调度几个写操作、并把确认和提交时间保存到相应回叫函数，然后用 <a class="reference internal" href="#rados_aio_flush" title="rados_aio_flush"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_flush()</span></tt></a> 等它们完成，然后就可以分析延时了：</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
        <span class="k">struct</span> <span class="n">timeval</span> <span class="n">start</span><span class="p">;</span>
        <span class="k">struct</span> <span class="n">timeval</span> <span class="n">ack_end</span><span class="p">;</span>
        <span class="k">struct</span> <span class="n">timeval</span> <span class="n">commit_end</span><span class="p">;</span>
<span class="p">}</span> <span class="n">req_duration</span><span class="p">;</span>

<span class="kt">void</span> <span class="nf">ack_callback</span><span class="p">(</span><span class="n">rados_completion_t</span> <span class="n">comp</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">req_duration</span> <span class="o">*</span><span class="n">dur</span> <span class="o">=</span> <span class="p">(</span><span class="n">req_duration</span> <span class="o">*</span><span class="p">)</span> <span class="n">arg</span><span class="p">;</span>
        <span class="n">gettimeofday</span><span class="p">(</span><span class="o">&amp;</span><span class="n">dur</span><span class="o">-&gt;</span><span class="n">ack_end</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">commit_callback</span><span class="p">(</span><span class="n">rados_completion_t</span> <span class="n">comp</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">arg</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">req_duration</span> <span class="o">*</span><span class="n">dur</span> <span class="o">=</span> <span class="p">(</span><span class="n">req_duration</span> <span class="o">*</span><span class="p">)</span> <span class="n">arg</span><span class="p">;</span>
        <span class="n">gettimeofday</span><span class="p">(</span><span class="o">&amp;</span><span class="n">dur</span><span class="o">-&gt;</span><span class="n">commit_end</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span> <span class="nf">output_append_latency</span><span class="p">(</span><span class="n">rados_ioctx_t</span> <span class="n">io</span><span class="p">,</span> <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">len</span><span class="p">,</span> <span class="kt">size_t</span> <span class="n">num_writes</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">req_duration</span> <span class="n">times</span><span class="p">[</span><span class="n">num_writes</span><span class="p">];</span>
        <span class="n">rados_completion_t</span> <span class="n">comps</span><span class="p">[</span><span class="n">num_writes</span><span class="p">];</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_writes</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">gettimeofday</span><span class="p">(</span><span class="o">&amp;</span><span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">start</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
                <span class="kt">int</span> <span class="n">err</span> <span class="o">=</span> <span class="n">rados_aio_create_completion</span><span class="p">((</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">ack_callback</span><span class="p">,</span> <span class="n">commit_callback</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">comps</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;Error creating rados completion: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">strerror</span><span class="p">(</span><span class="o">-</span><span class="n">err</span><span class="p">));</span>
                        <span class="k">return</span> <span class="n">err</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="kt">char</span> <span class="n">obj_name</span><span class="p">[</span><span class="mi">100</span><span class="p">];</span>
                <span class="n">snprintf</span><span class="p">(</span><span class="n">obj_name</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">obj_name</span><span class="p">),</span> <span class="s">&quot;foo%ld&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span><span class="n">i</span><span class="p">);</span>
                <span class="n">err</span> <span class="o">=</span> <span class="n">rados_aio_append</span><span class="p">(</span><span class="n">io</span><span class="p">,</span> <span class="n">obj_name</span><span class="p">,</span> <span class="n">comps</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">data</span><span class="p">,</span> <span class="n">len</span><span class="p">);</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">err</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
                        <span class="n">fprintf</span><span class="p">(</span><span class="n">stderr</span><span class="p">,</span> <span class="s">&quot;Error from rados_aio_append: %s&quot;</span><span class="p">,</span> <span class="n">strerror</span><span class="p">(</span><span class="o">-</span><span class="n">err</span><span class="p">));</span>
                        <span class="k">return</span> <span class="n">err</span><span class="p">;</span>
                <span class="p">}</span>
        <span class="p">}</span>
        <span class="c1">// wait until all requests finish *and* the callbacks complete</span>
        <span class="n">rados_aio_flush</span><span class="p">(</span><span class="n">io</span><span class="p">);</span>
        <span class="c1">// the latencies can now be analyzed</span>
        <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Request # | Ack latency (s) | Commit latency (s)</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">num_writes</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// don&#39;t forget to free the completions</span>
                <span class="n">rados_aio_release</span><span class="p">(</span><span class="n">comps</span><span class="p">[</span><span class="n">i</span><span class="p">]);</span>
                <span class="k">struct</span> <span class="n">timeval</span> <span class="n">ack_lat</span><span class="p">,</span> <span class="n">commit_lat</span><span class="p">;</span>
                <span class="n">timersub</span><span class="p">(</span><span class="o">&amp;</span><span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">ack_end</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">start</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ack_lat</span><span class="p">);</span>
                <span class="n">timersub</span><span class="p">(</span><span class="o">&amp;</span><span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">commit_end</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">times</span><span class="p">[</span><span class="n">i</span><span class="p">].</span><span class="n">start</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">commit_lat</span><span class="p">);</span>
                <span class="n">printf</span><span class="p">(</span><span class="s">&quot;%9ld | %8ld.%06ld | %10ld.%06ld</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kt">unsigned</span> <span class="kt">long</span><span class="p">)</span> <span class="n">i</span><span class="p">,</span> <span class="n">ack_lat</span><span class="p">.</span><span class="n">tv_sec</span><span class="p">,</span> <span class="n">ack_lat</span><span class="p">.</span><span class="n">tv_usec</span><span class="p">,</span> <span class="n">commit_lat</span><span class="p">.</span><span class="n">tv_sec</span><span class="p">,</span> <span class="n">commit_lat</span><span class="p">.</span><span class="n">tv_usec</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>注意，所有 <a class="reference internal" href="#rados_completion_t" title="rados_completion_t"><tt class="xref c c-type docutils literal"><span class="pre">rados_completion_t</span></tt></a> 都必须用 <a class="reference internal" href="#rados_aio_release" title="rados_aio_release"><tt class="xref c c-func docutils literal"><span class="pre">rados_aio_release()</span></tt></a> 释放内存，以免造成内存泄漏。</p>
</div>
<div class="section" id="api-calls">
<h2>API calls<a class="headerlink" href="#api-calls" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Defines</p>
<dl class="define">
<dt id="LIBRADOS_ALL_NSPACES">
<span class="target" id="rados__types_8h_1a856cbae08b44becba45c76f5da40ffa2"></span><tt class="descname">LIBRADOS_ALL_NSPACES</tt><a class="headerlink" href="#LIBRADOS_ALL_NSPACES" title="Permalink to this definition">¶</a></dt>
<dd><p>Pass as nspace argument to rados_ioctx_set_namespace() before calling rados_nobjects_list_open() to return all objects in all namespaces. </p>
</dd></dl>

</div>
<dl class="struct">
<dt id="obj_watch_t">
<span class="target" id="structobj__watch__t"></span><em class="property">struct </em><tt class="descname">obj_watch_t</tt><a class="headerlink" href="#obj_watch_t" title="Permalink to this definition">¶</a></dt>
<dd><em>#include &lt;rados_types.h&gt;</em><p>One item from list_watchers </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt>
<span class="target" id="structobj__watch__t_1a5c521d5238d99ce7014905779cc3a2be"></span><tt class="descname">char obj_watch_t::addr[256]</tt></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="obj_watch_t::watcher_id">
<span class="target" id="structobj__watch__t_1a9b773ca6095b61ee6154107d59939a50"></span>int64_t <tt class="descname">watcher_id</tt><a class="headerlink" href="#obj_watch_t::watcher_id" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="obj_watch_t::cookie">
<span class="target" id="structobj__watch__t_1a6c49bc31779a8d2511838a5e0cb5ff31"></span>uint64_t <tt class="descname">cookie</tt><a class="headerlink" href="#obj_watch_t::cookie" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="obj_watch_t::timeout_seconds">
<span class="target" id="structobj__watch__t_1a5e987bcbc17814f83d559920f5aab1dd"></span>uint32_t <tt class="descname">timeout_seconds</tt><a class="headerlink" href="#obj_watch_t::timeout_seconds" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</dd></dl>

<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">xattr comparison operations</p>
<p>Operators for comparing xattrs on objects, and aborting the rados_read_op or rados_write_op transaction if the comparison fails. </p>
<dl class="enum">
<dt id="__anonymous1">
<span class="target" id="librados_8h_1adf764cbdea00d65edcd07bb9953ad2b7"></span><em class="property">enum </em><tt class="descname"><strong>[anonymous]</strong></tt><a class="headerlink" href="#__anonymous1" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Values:</em></p>
<dl class="enumvalue">
<dt id="LIBRADOS_CMPXATTR_OP_EQ">
<span class="target" id="librados_8h_1adf764cbdea00d65edcd07bb9953ad2b7a5704c5de1214a67ec3e9583548ee6445"></span><tt class="descname">LIBRADOS_CMPXATTR_OP_EQ</tt> = 1<a class="headerlink" href="#LIBRADOS_CMPXATTR_OP_EQ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_CMPXATTR_OP_NE">
<span class="target" id="librados_8h_1adf764cbdea00d65edcd07bb9953ad2b7ac83502a6846342c73e08b21ed3b14000"></span><tt class="descname">LIBRADOS_CMPXATTR_OP_NE</tt> = 2<a class="headerlink" href="#LIBRADOS_CMPXATTR_OP_NE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_CMPXATTR_OP_GT">
<span class="target" id="librados_8h_1adf764cbdea00d65edcd07bb9953ad2b7a7dc00fff37f306f8607ba276efccee5c"></span><tt class="descname">LIBRADOS_CMPXATTR_OP_GT</tt> = 3<a class="headerlink" href="#LIBRADOS_CMPXATTR_OP_GT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_CMPXATTR_OP_GTE">
<span class="target" id="librados_8h_1adf764cbdea00d65edcd07bb9953ad2b7a5a26abc77163a561d7bf619803c571c8"></span><tt class="descname">LIBRADOS_CMPXATTR_OP_GTE</tt> = 4<a class="headerlink" href="#LIBRADOS_CMPXATTR_OP_GTE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_CMPXATTR_OP_LT">
<span class="target" id="librados_8h_1adf764cbdea00d65edcd07bb9953ad2b7abfdc72e29e7cbad7e278d5bbaf2a33bf"></span><tt class="descname">LIBRADOS_CMPXATTR_OP_LT</tt> = 5<a class="headerlink" href="#LIBRADOS_CMPXATTR_OP_LT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_CMPXATTR_OP_LTE">
<span class="target" id="librados_8h_1adf764cbdea00d65edcd07bb9953ad2b7ac5321f346c6a7022b0b3b42b83db72ee"></span><tt class="descname">LIBRADOS_CMPXATTR_OP_LTE</tt> = 6<a class="headerlink" href="#LIBRADOS_CMPXATTR_OP_LTE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Operation Flags</p>
<p>Flags for rados_read_op_opeprate(), rados_write_op_operate(), rados_aio_read_op_operate(), and rados_aio_write_op_operate(). See librados.hpp for details. </p>
<dl class="enum">
<dt id="__anonymous2">
<span class="target" id="librados_8h_1a99fb83031ce9923c84392b4e92f956b5"></span><em class="property">enum </em><tt class="descname"><strong>[anonymous]</strong></tt><a class="headerlink" href="#__anonymous2" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Values:</em></p>
<dl class="enumvalue">
<dt id="LIBRADOS_OPERATION_NOFLAG">
<span class="target" id="librados_8h_1a99fb83031ce9923c84392b4e92f956b5ad7f7f30ddb552d642d73a687a8bef0d8"></span><tt class="descname">LIBRADOS_OPERATION_NOFLAG</tt> = 0<a class="headerlink" href="#LIBRADOS_OPERATION_NOFLAG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_OPERATION_BALANCE_READS">
<span class="target" id="librados_8h_1a99fb83031ce9923c84392b4e92f956b5a497824d4474d47b623efbc0e196c453c"></span><tt class="descname">LIBRADOS_OPERATION_BALANCE_READS</tt> = 1<a class="headerlink" href="#LIBRADOS_OPERATION_BALANCE_READS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_OPERATION_LOCALIZE_READS">
<span class="target" id="librados_8h_1a99fb83031ce9923c84392b4e92f956b5a542458b2695c3dd9a9e670dd85604ff9"></span><tt class="descname">LIBRADOS_OPERATION_LOCALIZE_READS</tt> = 2<a class="headerlink" href="#LIBRADOS_OPERATION_LOCALIZE_READS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_OPERATION_ORDER_READS_WRITES">
<span class="target" id="librados_8h_1a99fb83031ce9923c84392b4e92f956b5ab107ef49cec1bcf177e55128308ade3e"></span><tt class="descname">LIBRADOS_OPERATION_ORDER_READS_WRITES</tt> = 4<a class="headerlink" href="#LIBRADOS_OPERATION_ORDER_READS_WRITES" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_OPERATION_IGNORE_CACHE">
<span class="target" id="librados_8h_1a99fb83031ce9923c84392b4e92f956b5afb3e7bac2e9fb9b9c54a7ed24750539d"></span><tt class="descname">LIBRADOS_OPERATION_IGNORE_CACHE</tt> = 8<a class="headerlink" href="#LIBRADOS_OPERATION_IGNORE_CACHE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_OPERATION_SKIPRWLOCKS">
<span class="target" id="librados_8h_1a99fb83031ce9923c84392b4e92f956b5a7c30ed12a974a3082476aaac4528b7e5"></span><tt class="descname">LIBRADOS_OPERATION_SKIPRWLOCKS</tt> = 16<a class="headerlink" href="#LIBRADOS_OPERATION_SKIPRWLOCKS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_OPERATION_IGNORE_OVERLAY">
<span class="target" id="librados_8h_1a99fb83031ce9923c84392b4e92f956b5afab8b9d5a183456a775969623b452206"></span><tt class="descname">LIBRADOS_OPERATION_IGNORE_OVERLAY</tt> = 32<a class="headerlink" href="#LIBRADOS_OPERATION_IGNORE_OVERLAY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_OPERATION_FULL_TRY">
<span class="target" id="librados_8h_1a99fb83031ce9923c84392b4e92f956b5ab563d85c24ddc59decad4f6dc15bd1a0"></span><tt class="descname">LIBRADOS_OPERATION_FULL_TRY</tt> = 64<a class="headerlink" href="#LIBRADOS_OPERATION_FULL_TRY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_OPERATION_FULL_FORCE">
<span class="target" id="librados_8h_1a99fb83031ce9923c84392b4e92f956b5a59cf7ffa6d11abbb38ee4b7b1651ebb8"></span><tt class="descname">LIBRADOS_OPERATION_FULL_FORCE</tt> = 128<a class="headerlink" href="#LIBRADOS_OPERATION_FULL_FORCE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Alloc hint flags</p>
<p>Flags for rados_write_op_alloc_hint2() and rados_set_alloc_hint2() indicating future IO patterns. </p>
<dl class="enum">
<dt id="__anonymous3">
<span class="target" id="librados_8h_1abc6126af1d45847bc59afa0aa3216b04"></span><em class="property">enum </em><tt class="descname"><strong>[anonymous]</strong></tt><a class="headerlink" href="#__anonymous3" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Values:</em></p>
<dl class="enumvalue">
<dt id="LIBRADOS_ALLOC_HINT_FLAG_SEQUENTIAL_WRITE">
<span class="target" id="librados_8h_1abc6126af1d45847bc59afa0aa3216b04a84edfc171cb9930894729821ddb46edd"></span><tt class="descname">LIBRADOS_ALLOC_HINT_FLAG_SEQUENTIAL_WRITE</tt> = 1<a class="headerlink" href="#LIBRADOS_ALLOC_HINT_FLAG_SEQUENTIAL_WRITE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_ALLOC_HINT_FLAG_RANDOM_WRITE">
<span class="target" id="librados_8h_1abc6126af1d45847bc59afa0aa3216b04ae76cd323ff2e928df6119d42d59d28fe"></span><tt class="descname">LIBRADOS_ALLOC_HINT_FLAG_RANDOM_WRITE</tt> = 2<a class="headerlink" href="#LIBRADOS_ALLOC_HINT_FLAG_RANDOM_WRITE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_ALLOC_HINT_FLAG_SEQUENTIAL_READ">
<span class="target" id="librados_8h_1abc6126af1d45847bc59afa0aa3216b04a286c94e77baf5220271a4a259b0db4b3"></span><tt class="descname">LIBRADOS_ALLOC_HINT_FLAG_SEQUENTIAL_READ</tt> = 4<a class="headerlink" href="#LIBRADOS_ALLOC_HINT_FLAG_SEQUENTIAL_READ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_ALLOC_HINT_FLAG_RANDOM_READ">
<span class="target" id="librados_8h_1abc6126af1d45847bc59afa0aa3216b04a44efcee9a5a7b6b05e26470173acf195"></span><tt class="descname">LIBRADOS_ALLOC_HINT_FLAG_RANDOM_READ</tt> = 8<a class="headerlink" href="#LIBRADOS_ALLOC_HINT_FLAG_RANDOM_READ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_ALLOC_HINT_FLAG_APPEND_ONLY">
<span class="target" id="librados_8h_1abc6126af1d45847bc59afa0aa3216b04ab31540f6184e0f8f24531eb6f06c94a5"></span><tt class="descname">LIBRADOS_ALLOC_HINT_FLAG_APPEND_ONLY</tt> = 16<a class="headerlink" href="#LIBRADOS_ALLOC_HINT_FLAG_APPEND_ONLY" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_ALLOC_HINT_FLAG_IMMUTABLE">
<span class="target" id="librados_8h_1abc6126af1d45847bc59afa0aa3216b04a06295da1eca7a3dedf093a82709e17f9"></span><tt class="descname">LIBRADOS_ALLOC_HINT_FLAG_IMMUTABLE</tt> = 32<a class="headerlink" href="#LIBRADOS_ALLOC_HINT_FLAG_IMMUTABLE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_ALLOC_HINT_FLAG_SHORTLIVED">
<span class="target" id="librados_8h_1abc6126af1d45847bc59afa0aa3216b04a93d85b03a9209347ebbfc94bc4888465"></span><tt class="descname">LIBRADOS_ALLOC_HINT_FLAG_SHORTLIVED</tt> = 64<a class="headerlink" href="#LIBRADOS_ALLOC_HINT_FLAG_SHORTLIVED" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_ALLOC_HINT_FLAG_LONGLIVED">
<span class="target" id="librados_8h_1abc6126af1d45847bc59afa0aa3216b04a40322b698c38af5fe15ebf5094597ff4"></span><tt class="descname">LIBRADOS_ALLOC_HINT_FLAG_LONGLIVED</tt> = 128<a class="headerlink" href="#LIBRADOS_ALLOC_HINT_FLAG_LONGLIVED" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_ALLOC_HINT_FLAG_COMPRESSIBLE">
<span class="target" id="librados_8h_1abc6126af1d45847bc59afa0aa3216b04a6329e9f57cfb196672c366955ff26452"></span><tt class="descname">LIBRADOS_ALLOC_HINT_FLAG_COMPRESSIBLE</tt> = 256<a class="headerlink" href="#LIBRADOS_ALLOC_HINT_FLAG_COMPRESSIBLE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_ALLOC_HINT_FLAG_INCOMPRESSIBLE">
<span class="target" id="librados_8h_1abc6126af1d45847bc59afa0aa3216b04ab5aad30114c83da7c50114a58af33cd4"></span><tt class="descname">LIBRADOS_ALLOC_HINT_FLAG_INCOMPRESSIBLE</tt> = 512<a class="headerlink" href="#LIBRADOS_ALLOC_HINT_FLAG_INCOMPRESSIBLE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Asynchronous I/O</p>
<p>Read and write to objects without blocking. </p>
<dl class="typedef">
<dt id="rados_callback_t">
<span class="target" id="librados_8h_1a89fd019a165bb2872bbf9078d806a9e5"></span><em class="property">typedef </em><tt class="descname">rados_callback_t</tt><a class="headerlink" href="#rados_callback_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Callbacks for asynchrous operations take two parameters:<ul class="simple">
<li>cb the completion that has finished</li>
<li>arg application defined data made available to the callback function </li>
</ul>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_create_completion">
<span class="target" id="librados_8h_1a5955d25d7b509c9b271bd153a2208a10"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_create_completion</tt><big>(</big>void *<em>&nbsp;cb_arg</em>, <a class="reference internal" href="#rados_callback_t" title="rados_callback_t">rados_callback_t</a><em>&nbsp;cb_complete</em>, <a class="reference internal" href="#rados_callback_t" title="rados_callback_t">rados_callback_t</a><em>&nbsp;cb_safe</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a> *<em>&nbsp;pc</em><big>)</big><a class="headerlink" href="#rados_aio_create_completion" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs a completion to use with asynchronous operations</p>
<p>The complete and safe callbacks correspond to operations being acked and committed, respectively. The callbacks are called in order of receipt, so the safe callback may be triggered before the complete callback, and vice versa. This is affected by journalling on the OSDs.</p>
<p>TODO: more complete documentation of this elsewhere (in the RADOS docs?)</p>
<p><dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>Read operations only get a complete callback. </dd>
<dt><strong>Note</strong></dt>
<dd>BUG: this should check for ENOMEM instead of throwing an exception</dd>
<dt><strong>Return</strong></dt>
<dd>0 </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cb_arg</span></tt>: application-defined data passed to the callback functions </li>
<li><tt class="docutils literal"><span class="pre">cb_complete</span></tt>: the function to be called when the operation is in memory on all relpicas </li>
<li><tt class="docutils literal"><span class="pre">cb_safe</span></tt>: the function to be called when the operation is on stable storage on all replicas </li>
<li><tt class="docutils literal"><span class="pre">pc</span></tt>: where to store the completion </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_wait_for_complete">
<span class="target" id="librados_8h_1a7718e4aaf9fe1f806bb981da8f4bd395"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_wait_for_complete</tt><big>(</big><a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;c</em><big>)</big><a class="headerlink" href="#rados_aio_wait_for_complete" title="Permalink to this definition">¶</a></dt>
<dd><p>Block until an operation completes</p>
<p>This means it is in memory on all replicas.</p>
<p><dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>BUG: this should be void</dd>
<dt><strong>Return</strong></dt>
<dd>0 </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">c</span></tt>: operation to wait for </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_wait_for_safe">
<span class="target" id="librados_8h_1acc3ccc5ff6beaa2cc04d5903a1662b58"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_wait_for_safe</tt><big>(</big><a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;c</em><big>)</big><a class="headerlink" href="#rados_aio_wait_for_safe" title="Permalink to this definition">¶</a></dt>
<dd><p>Block until an operation is safe</p>
<p>This means it is on stable storage on all replicas.</p>
<p><dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>BUG: this should be void</dd>
<dt><strong>Return</strong></dt>
<dd>0 </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">c</span></tt>: operation to wait for </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_is_complete">
<span class="target" id="librados_8h_1a32754a8fa76d9eb04af81c0c2670cb55"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_is_complete</tt><big>(</big><a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;c</em><big>)</big><a class="headerlink" href="#rados_aio_is_complete" title="Permalink to this definition">¶</a></dt>
<dd><p>Has an asynchronous operation completed?</p>
<p><dl class="docutils">
<dt><strong>Warning</strong></dt>
<dd>This does not imply that the complete callback has finished</dd>
<dt><strong>Return</strong></dt>
<dd>whether c is complete </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">c</span></tt>: async operation to inspect </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_is_safe">
<span class="target" id="librados_8h_1a94bd058b887430fb0a48f137c024063e"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_is_safe</tt><big>(</big><a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;c</em><big>)</big><a class="headerlink" href="#rados_aio_is_safe" title="Permalink to this definition">¶</a></dt>
<dd><p>Is an asynchronous operation safe?</p>
<p><dl class="docutils">
<dt><strong>Warning</strong></dt>
<dd>This does not imply that the safe callback has finished</dd>
<dt><strong>Return</strong></dt>
<dd>whether c is safe </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">c</span></tt>: async operation to inspect </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_wait_for_complete_and_cb">
<span class="target" id="librados_8h_1a3532b567e6effae0af00d15dd9dd84f2"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_wait_for_complete_and_cb</tt><big>(</big><a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;c</em><big>)</big><a class="headerlink" href="#rados_aio_wait_for_complete_and_cb" title="Permalink to this definition">¶</a></dt>
<dd><p>Block until an operation completes and callback completes</p>
<p>This means it is in memory on all replicas and can be read.</p>
<p><dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>BUG: this should be void</dd>
<dt><strong>Return</strong></dt>
<dd>0 </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">c</span></tt>: operation to wait for </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_wait_for_safe_and_cb">
<span class="target" id="librados_8h_1ab7aede3e2a27cb520d1f6411bd5797a1"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_wait_for_safe_and_cb</tt><big>(</big><a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;c</em><big>)</big><a class="headerlink" href="#rados_aio_wait_for_safe_and_cb" title="Permalink to this definition">¶</a></dt>
<dd><p>Block until an operation is safe and callback has completed</p>
<p>This means it is on stable storage on all replicas.</p>
<p><dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>BUG: this should be void</dd>
<dt><strong>Return</strong></dt>
<dd>0 </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">c</span></tt>: operation to wait for </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_is_complete_and_cb">
<span class="target" id="librados_8h_1a66135ad6d7f62d7dde361f4b0383ff33"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_is_complete_and_cb</tt><big>(</big><a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;c</em><big>)</big><a class="headerlink" href="#rados_aio_is_complete_and_cb" title="Permalink to this definition">¶</a></dt>
<dd><p>Has an asynchronous operation and callback completed</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>whether c is complete </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">c</span></tt>: async operation to inspect </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_is_safe_and_cb">
<span class="target" id="librados_8h_1ab1965ac4cda83410e829df7137e7dcdb"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_is_safe_and_cb</tt><big>(</big><a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;c</em><big>)</big><a class="headerlink" href="#rados_aio_is_safe_and_cb" title="Permalink to this definition">¶</a></dt>
<dd><p>Is an asynchronous operation safe and has the callback completed</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>whether c is safe </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">c</span></tt>: async operation to inspect </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_get_return_value">
<span class="target" id="librados_8h_1ad904db01b1c46e7373e5c7ba83dfc573"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_get_return_value</tt><big>(</big><a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;c</em><big>)</big><a class="headerlink" href="#rados_aio_get_return_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the return value of an asychronous operation</p>
<p>The return value is set when the operation is complete or safe, whichever comes first.</p>
<p><dl class="docutils">
<dt><strong>Pre</strong></dt>
<dd>The operation is safe or complete</dd>
<dt><strong>Note</strong></dt>
<dd>BUG: complete callback may never be called when the safe message is received before the complete message</dd>
<dt><strong>Return</strong></dt>
<dd>return value of the operation </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">c</span></tt>: async operation to inspect </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_get_version">
<span class="target" id="librados_8h_1a937410eeeb787fd3c543349426c66568"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> uint64_t <tt class="descname">rados_aio_get_version</tt><big>(</big><a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;c</em><big>)</big><a class="headerlink" href="#rados_aio_get_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the internal object version of the target of an asychronous operation</p>
<p>The return value is set when the operation is complete or safe, whichever comes first.</p>
<p><dl class="docutils">
<dt><strong>Pre</strong></dt>
<dd>The operation is safe or complete</dd>
<dt><strong>Note</strong></dt>
<dd>BUG: complete callback may never be called when the safe message is received before the complete message</dd>
<dt><strong>Return</strong></dt>
<dd>version number of the asychronous operation&#8217;s target </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">c</span></tt>: async operation to inspect </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_release">
<span class="target" id="librados_8h_1adc6dfb15659856f9ca3dae564db4596d"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_aio_release</tt><big>(</big><a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;c</em><big>)</big><a class="headerlink" href="#rados_aio_release" title="Permalink to this definition">¶</a></dt>
<dd><p>Release a completion</p>
<p>Call this when you no longer need the completion. It may not be freed immediately if the operation is not acked and committed.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">c</span></tt>: completion to release </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_write">
<span class="target" id="librados_8h_1a6f4f4c4bc2d9a37f462b57541cedc5c8"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_write</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, const char *<em>&nbsp;buf</em>, size_t<em>&nbsp;len</em>, uint64_t<em>&nbsp;off</em><big>)</big><a class="headerlink" href="#rados_aio_write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write data to an object asynchronously</p>
<p>Queues the write and returns. The return value of the completion will be 0 on success, negative error code on failure.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, -EROFS if the io context specifies a snap_seq other than LIBRADOS_SNAP_HEAD </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context in which the write will occur </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: name of the object </li>
<li><tt class="docutils literal"><span class="pre">completion</span></tt>: what to do when the write is safe and complete </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: data to write </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: length of the data, in bytes </li>
<li><tt class="docutils literal"><span class="pre">off</span></tt>: byte offset in the object to begin writing at </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_append">
<span class="target" id="librados_8h_1a0a24821e17c314590c45f42f87b034d1"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_append</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, const char *<em>&nbsp;buf</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_aio_append" title="Permalink to this definition">¶</a></dt>
<dd><p>Asychronously append data to an object</p>
<p>Queues the append and returns.</p>
<p>The return value of the completion will be 0 on success, negative error code on failure.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, -EROFS if the io context specifies a snap_seq other than LIBRADOS_SNAP_HEAD </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context to operate in </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: the name of the object </li>
<li><tt class="docutils literal"><span class="pre">completion</span></tt>: what to do when the append is safe and complete </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: the data to append </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: length of buf (in bytes) </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_write_full">
<span class="target" id="librados_8h_1acf7daf8ecc0ba809b8bf6738b21af7ef"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_write_full</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, const char *<em>&nbsp;buf</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_aio_write_full" title="Permalink to this definition">¶</a></dt>
<dd><p>Asychronously write an entire object</p>
<p>The object is filled with the provided data. If the object exists, it is atomically truncated and then written. Queues the write_full and returns.</p>
<p>The return value of the completion will be 0 on success, negative error code on failure.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, -EROFS if the io context specifies a snap_seq other than LIBRADOS_SNAP_HEAD </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the io context in which the write will occur </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: name of the object </li>
<li><tt class="docutils literal"><span class="pre">completion</span></tt>: what to do when the write_full is safe and complete </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: data to write </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: length of the data, in bytes </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_writesame">
<span class="target" id="librados_8h_1aa93b44ecdb77d893c7be8dd20284ccde"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_writesame</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, const char *<em>&nbsp;buf</em>, size_t<em>&nbsp;data_len</em>, size_t<em>&nbsp;write_len</em>, uint64_t<em>&nbsp;off</em><big>)</big><a class="headerlink" href="#rados_aio_writesame" title="Permalink to this definition">¶</a></dt>
<dd><p>Asychronously write the same buffer multiple times</p>
<p>Queues the writesame and returns.</p>
<p>The return value of the completion will be 0 on success, negative error code on failure.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, -EROFS if the io context specifies a snap_seq other than LIBRADOS_SNAP_HEAD </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the io context in which the write will occur </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: name of the object </li>
<li><tt class="docutils literal"><span class="pre">completion</span></tt>: what to do when the writesame is safe and complete </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: data to write </li>
<li><tt class="docutils literal"><span class="pre">data_len</span></tt>: length of the data, in bytes </li>
<li><tt class="docutils literal"><span class="pre">write_len</span></tt>: the total number of bytes to write </li>
<li><tt class="docutils literal"><span class="pre">off</span></tt>: byte offset in the object to begin writing at </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_remove">
<span class="target" id="librados_8h_1a4b181e57f6ed40346af3b4445fcd0e58"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_remove</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em><big>)</big><a class="headerlink" href="#rados_aio_remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Asychronously remove an object</p>
<p>Queues the remove and returns.</p>
<p>The return value of the completion will be 0 on success, negative error code on failure.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, -EROFS if the io context specifies a snap_seq other than LIBRADOS_SNAP_HEAD </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context to operate in </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: the name of the object </li>
<li><tt class="docutils literal"><span class="pre">completion</span></tt>: what to do when the remove is safe and complete </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_read">
<span class="target" id="librados_8h_1a1a8fd7f428bd26a8cc0a8c39dca950ad"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_read</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, char *<em>&nbsp;buf</em>, size_t<em>&nbsp;len</em>, uint64_t<em>&nbsp;off</em><big>)</big><a class="headerlink" href="#rados_aio_read" title="Permalink to this definition">¶</a></dt>
<dd><p>Asychronously read data from an object</p>
<p>The io context determines the snapshot to read from, if any was set by rados_ioctx_snap_set_read().</p>
<p>The return value of the completion will be number of bytes read on success, negative error code on failure.</p>
<p><dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>only the &#8216;complete&#8217; callback of the completion will be called.</dd>
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context in which to perform the read </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: the name of the object to read from </li>
<li><tt class="docutils literal"><span class="pre">completion</span></tt>: what to do when the read is complete </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: where to store the results </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: the number of bytes to read </li>
<li><tt class="docutils literal"><span class="pre">off</span></tt>: the offset to start reading from in the object </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_flush">
<span class="target" id="librados_8h_1a644b4e62503d9eb0f3b2b618860c6eba"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_flush</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em><big>)</big><a class="headerlink" href="#rados_aio_flush" title="Permalink to this definition">¶</a></dt>
<dd><p>Block until all pending writes in an io context are safe</p>
<p>This is not equivalent to calling rados_aio_wait_for_safe() on all write completions, since this waits for the associated callbacks to complete as well.</p>
<p><dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>BUG: always returns 0, should be void or accept a timeout</dd>
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context to flush </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_flush_async">
<span class="target" id="librados_8h_1acb4e47ec4b917eaf11027389b2064b13"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_flush_async</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em><big>)</big><a class="headerlink" href="#rados_aio_flush_async" title="Permalink to this definition">¶</a></dt>
<dd><p>Schedule a callback for when all currently pending aio writes are safe. This is a non-blocking version of rados_aio_flush().</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context to flush </li>
<li><tt class="docutils literal"><span class="pre">completion</span></tt>: what to do when the writes are safe </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_stat">
<span class="target" id="librados_8h_1a99280f0e640f0849a6fb91ec742f0e80"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_stat</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, uint64_t *<em>&nbsp;psize</em>, time_t *<em>&nbsp;pmtime</em><big>)</big><a class="headerlink" href="#rados_aio_stat" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronously get object stats (size/mtime)</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: ioctx </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: object name </li>
<li><tt class="docutils literal"><span class="pre">psize</span></tt>: where to store object size </li>
<li><tt class="docutils literal"><span class="pre">pmtime</span></tt>: where to store modification time </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_cmpext">
<span class="target" id="librados_8h_1a4b85a574e0efe90d7ac4683a8ba27895"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_cmpext</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, const char *<em>&nbsp;cmp_buf</em>, size_t<em>&nbsp;cmp_len</em>, uint64_t<em>&nbsp;off</em><big>)</big><a class="headerlink" href="#rados_aio_cmpext" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronously compare an on-disk object range with a buffer</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure, (-MAX_ERRNO - mismatch_off) on mismatch </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context in which to perform the comparison </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: the name of the object to compare with </li>
<li><tt class="docutils literal"><span class="pre">completion</span></tt>: what to do when the comparison is complete </li>
<li><tt class="docutils literal"><span class="pre">cmp_buf</span></tt>: buffer containing bytes to be compared with object contents </li>
<li><tt class="docutils literal"><span class="pre">cmp_len</span></tt>: length to compare and size of  in bytes </li>
<li><tt class="docutils literal"><span class="pre">off</span></tt>: object byte offset at which to start the comparison </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_cancel">
<span class="target" id="librados_8h_1a59638b9177c9ccf52d19f1d992277503"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_cancel</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em><big>)</big><a class="headerlink" href="#rados_aio_cancel" title="Permalink to this definition">¶</a></dt>
<dd><p>Cancel async operation</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: ioctx </li>
<li><tt class="docutils literal"><span class="pre">completion</span></tt>: completion handle </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_exec">
<span class="target" id="librados_8h_1ad52b289c2d0573cf538eebaeed2a1a0e"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_exec</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, const char *<em>&nbsp;cls</em>, const char *<em>&nbsp;method</em>, const char *<em>&nbsp;in_buf</em>, size_t<em>&nbsp;in_len</em>, char *<em>&nbsp;buf</em>, size_t<em>&nbsp;out_len</em><big>)</big><a class="headerlink" href="#rados_aio_exec" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronously execute an OSD class method on an object</p>
<p>The OSD has a plugin mechanism for performing complicated operations on an object atomically. These plugins are called classes. This function allows librados users to call the custom methods. The input and output formats are defined by the class. Classes in ceph.git can be found in src/cls subdirectories</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context in which to call the method </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: the object to call the method on </li>
<li><tt class="docutils literal"><span class="pre">cls</span></tt>: the name of the class </li>
<li><tt class="docutils literal"><span class="pre">method</span></tt>: the name of the method </li>
<li><tt class="docutils literal"><span class="pre">in_buf</span></tt>: where to find input </li>
<li><tt class="docutils literal"><span class="pre">in_len</span></tt>: length of in_buf in bytes </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: where to store output </li>
<li><tt class="docutils literal"><span class="pre">out_len</span></tt>: length of buf in bytes </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Watch/Notify</p>
<p>Watch/notify is a protocol to help communicate among clients. It can be used to sychronize client state. All that&#8217;s needed is a well-known object name (for example, rbd uses the header object of an image).</p>
<p>Watchers register an interest in an object, and receive all notifies on that object. A notify attempts to communicate with all clients watching an object, and blocks on the notifier until each client responds or a timeout is reached.</p>
<p>See rados_watch() and rados_notify() for more details. </p>
<dl class="typedef">
<dt id="rados_watchcb_t">
<span class="target" id="librados_8h_1a3ed009a14f2fd15dc7a4fe337f3649d5"></span><em class="property">typedef </em><tt class="descname">rados_watchcb_t</tt><a class="headerlink" href="#rados_watchcb_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback activated when a notify is received on a watched object.</p>
<p><dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>BUG: opcode is an internal detail that shouldn&#8217;t be exposed </dd>
<dt><strong>Note</strong></dt>
<dd>BUG: ver is unused </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">opcode</span></tt>: undefined </li>
<li><tt class="docutils literal"><span class="pre">ver</span></tt>: version of the watched object </li>
<li><tt class="docutils literal"><span class="pre">arg</span></tt>: application-specific data</li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="typedef">
<dt id="rados_watchcb2_t">
<span class="target" id="librados_8h_1ae4042feb1602b9df19dac7ff496920d3"></span><em class="property">typedef </em><tt class="descname">rados_watchcb2_t</tt><a class="headerlink" href="#rados_watchcb2_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback activated when a notify is received on a watched object.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">arg</span></tt>: opaque user-defined value provided to rados_watch2() </li>
<li><tt class="docutils literal"><span class="pre">notify_id</span></tt>: an id for this notify event </li>
<li><tt class="docutils literal"><span class="pre">handle</span></tt>: the watcher handle we are notifying </li>
<li><tt class="docutils literal"><span class="pre">notifier_id</span></tt>: the unique client id for the notifier </li>
<li><tt class="docutils literal"><span class="pre">data</span></tt>: payload from the notifier </li>
<li><tt class="docutils literal"><span class="pre">datalen</span></tt>: length of payload buffer </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="typedef">
<dt id="rados_watcherrcb_t">
<span class="target" id="librados_8h_1a03fa31d268200b63ae696a9b7d7806f4"></span><em class="property">typedef </em><tt class="descname">rados_watcherrcb_t</tt><a class="headerlink" href="#rados_watcherrcb_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback activated when we encounter an error with the watch session. This can happen when the location of the objects moves within the cluster and we fail to register our watch with the new object location, or when our connection with the object OSD is otherwise interrupted and we may have missed notify events.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">pre</span></tt>: opaque user-defined value provided to rados_watch2() </li>
<li><tt class="docutils literal"><span class="pre">err</span></tt>: error code </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_watch">
<span class="target" id="librados_8h_1a6f26b36eb0042935caf4338a447e473b"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_watch</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, uint64_t<em>&nbsp;ver</em>, uint64_t *<em>&nbsp;cookie</em>, <a class="reference internal" href="#rados_watchcb_t" title="rados_watchcb_t">rados_watchcb_t</a><em>&nbsp;watchcb</em>, void *<em>&nbsp;arg</em><big>)</big><a class="headerlink" href="#rados_watch" title="Permalink to this definition">¶</a></dt>
<dd><p>Register an interest in an object</p>
<p>A watch operation registers the client as being interested in notifications on an object. OSDs keep track of watches on persistent storage, so they are preserved across cluster changes by the normal recovery process. If the client loses its connection to the primary OSD for a watched object, the watch will be removed after 30 seconds. Watches are automatically reestablished when a new connection is made, or a placement group switches OSDs.</p>
<p><dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>BUG: librados should provide a way for watchers to notice connection resets </dd>
<dt><strong>Note</strong></dt>
<dd>BUG: the ver parameter does not work, and -ERANGE will never be returned (See URL tracker.ceph.com/issues/2592)</dd>
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Return</strong></dt>
<dd>-ERANGE if the version of the object is greater than ver </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool the object is in </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: the object to watch </li>
<li><tt class="docutils literal"><span class="pre">ver</span></tt>: expected version of the object </li>
<li><tt class="docutils literal"><span class="pre">cookie</span></tt>: where to store the internal id assigned to this watch </li>
<li><tt class="docutils literal"><span class="pre">watchcb</span></tt>: what to do when a notify is received on this object </li>
<li><tt class="docutils literal"><span class="pre">arg</span></tt>: application defined data to pass when watchcb is called </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_watch2">
<span class="target" id="librados_8h_1a1e9999a4cab56748425c53b436c9f3ff"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_watch2</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, uint64_t *<em>&nbsp;cookie</em>, <a class="reference internal" href="#rados_watchcb2_t" title="rados_watchcb2_t">rados_watchcb2_t</a><em>&nbsp;watchcb</em>, <a class="reference internal" href="#rados_watcherrcb_t" title="rados_watcherrcb_t">rados_watcherrcb_t</a><em>&nbsp;watcherrcb</em>, void *<em>&nbsp;arg</em><big>)</big><a class="headerlink" href="#rados_watch2" title="Permalink to this definition">¶</a></dt>
<dd><p>Register an interest in an object</p>
<p>A watch operation registers the client as being interested in notifications on an object. OSDs keep track of watches on persistent storage, so they are preserved across cluster changes by the normal recovery process. If the client loses its connection to the primary OSD for a watched object, the watch will be removed after a timeout configured with osd_client_watch_timeout. Watches are automatically reestablished when a new connection is made, or a placement group switches OSDs.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool the object is in </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: the object to watch </li>
<li><tt class="docutils literal"><span class="pre">cookie</span></tt>: where to store the internal id assigned to this watch </li>
<li><tt class="docutils literal"><span class="pre">watchcb</span></tt>: what to do when a notify is received on this object </li>
<li><tt class="docutils literal"><span class="pre">watcherrcb</span></tt>: what to do when the watch session encounters an error </li>
<li><tt class="docutils literal"><span class="pre">arg</span></tt>: opaque value to pass to the callback </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_watch3">
<span class="target" id="librados_8h_1a6f0f062e55d392a5f3bd8c7d5e8028c4"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_watch3</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, uint64_t *<em>&nbsp;cookie</em>, <a class="reference internal" href="#rados_watchcb2_t" title="rados_watchcb2_t">rados_watchcb2_t</a><em>&nbsp;watchcb</em>, <a class="reference internal" href="#rados_watcherrcb_t" title="rados_watcherrcb_t">rados_watcherrcb_t</a><em>&nbsp;watcherrcb</em>, uint32_t<em>&nbsp;timeout</em>, void *<em>&nbsp;arg</em><big>)</big><a class="headerlink" href="#rados_watch3" title="Permalink to this definition">¶</a></dt>
<dd><p>Register an interest in an object</p>
<p>A watch operation registers the client as being interested in notifications on an object. OSDs keep track of watches on persistent storage, so they are preserved across cluster changes by the normal recovery process. Watches are automatically reestablished when a new connection is made, or a placement group switches OSDs.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool the object is in </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: the object to watch </li>
<li><tt class="docutils literal"><span class="pre">cookie</span></tt>: where to store the internal id assigned to this watch </li>
<li><tt class="docutils literal"><span class="pre">watchcb</span></tt>: what to do when a notify is received on this object </li>
<li><tt class="docutils literal"><span class="pre">watcherrcb</span></tt>: what to do when the watch session encounters an error </li>
<li><tt class="docutils literal"><span class="pre">timeout</span></tt>: how many seconds the connection will keep after disconnection </li>
<li><tt class="docutils literal"><span class="pre">arg</span></tt>: opaque value to pass to the callback </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_watch">
<span class="target" id="librados_8h_1ab1ba428538c4691804ebe7093f51d7cb"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_watch</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, uint64_t *<em>&nbsp;handle</em>, <a class="reference internal" href="#rados_watchcb2_t" title="rados_watchcb2_t">rados_watchcb2_t</a><em>&nbsp;watchcb</em>, <a class="reference internal" href="#rados_watcherrcb_t" title="rados_watcherrcb_t">rados_watcherrcb_t</a><em>&nbsp;watcherrcb</em>, void *<em>&nbsp;arg</em><big>)</big><a class="headerlink" href="#rados_aio_watch" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronous register an interest in an object</p>
<p>A watch operation registers the client as being interested in notifications on an object. OSDs keep track of watches on persistent storage, so they are preserved across cluster changes by the normal recovery process. If the client loses its connection to the primary OSD for a watched object, the watch will be removed after 30 seconds. Watches are automatically reestablished when a new connection is made, or a placement group switches OSDs.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool the object is in </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: the object to watch </li>
<li><tt class="docutils literal"><span class="pre">completion</span></tt>: what to do when operation has been attempted </li>
<li><tt class="docutils literal"><span class="pre">handle</span></tt>: where to store the internal id assigned to this watch </li>
<li><tt class="docutils literal"><span class="pre">watchcb</span></tt>: what to do when a notify is received on this object </li>
<li><tt class="docutils literal"><span class="pre">watcherrcb</span></tt>: what to do when the watch session encounters an error </li>
<li><tt class="docutils literal"><span class="pre">arg</span></tt>: opaque value to pass to the callback </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_watch2">
<span class="target" id="librados_8h_1a07bbf1c8c0fbdf8a1c3e5e5f6399649f"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_watch2</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, uint64_t *<em>&nbsp;handle</em>, <a class="reference internal" href="#rados_watchcb2_t" title="rados_watchcb2_t">rados_watchcb2_t</a><em>&nbsp;watchcb</em>, <a class="reference internal" href="#rados_watcherrcb_t" title="rados_watcherrcb_t">rados_watcherrcb_t</a><em>&nbsp;watcherrcb</em>, uint32_t<em>&nbsp;timeout</em>, void *<em>&nbsp;arg</em><big>)</big><a class="headerlink" href="#rados_aio_watch2" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronous register an interest in an object</p>
<p>A watch operation registers the client as being interested in notifications on an object. OSDs keep track of watches on persistent storage, so they are preserved across cluster changes by the normal recovery process. If the client loses its connection to the primary OSD for a watched object, the watch will be removed after the number of seconds that configured in timeout parameter. Watches are automatically reestablished when a new connection is made, or a placement group switches OSDs.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool the object is in </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: the object to watch </li>
<li><tt class="docutils literal"><span class="pre">completion</span></tt>: what to do when operation has been attempted </li>
<li><tt class="docutils literal"><span class="pre">handle</span></tt>: where to store the internal id assigned to this watch </li>
<li><tt class="docutils literal"><span class="pre">watchcb</span></tt>: what to do when a notify is received on this object </li>
<li><tt class="docutils literal"><span class="pre">watcherrcb</span></tt>: what to do when the watch session encounters an error </li>
<li><tt class="docutils literal"><span class="pre">timeout</span></tt>: how many seconds the connection will keep after disconnection </li>
<li><tt class="docutils literal"><span class="pre">arg</span></tt>: opaque value to pass to the callback </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_watch_check">
<span class="target" id="librados_8h_1a41031bd4a4fe0515507bc62b12c7c34f"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_watch_check</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, uint64_t<em>&nbsp;cookie</em><big>)</big><a class="headerlink" href="#rados_watch_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Check on the status of a watch</p>
<p>Return the number of milliseconds since the watch was last confirmed. Or, if there has been an error, return that.</p>
<p>If there is an error, the watch is no longer valid, and should be destroyed with rados_unwatch2(). The the user is still interested in the object, a new watch should be created with rados_watch2().</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>ms since last confirmed on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool the object is in </li>
<li><tt class="docutils literal"><span class="pre">cookie</span></tt>: the watch handle </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_unwatch">
<span class="target" id="librados_8h_1ad83de38adfb370d9e0aa11476a1d0fb2"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_unwatch</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, uint64_t<em>&nbsp;cookie</em><big>)</big><a class="headerlink" href="#rados_unwatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Unregister an interest in an object</p>
<p>Once this completes, no more notifies will be sent to us for this watch. This should be called to clean up unneeded watchers.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool the object is in </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: the name of the watched object (ignored) </li>
<li><tt class="docutils literal"><span class="pre">cookie</span></tt>: which watch to unregister </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_unwatch2">
<span class="target" id="librados_8h_1af7468fc1e70070f2e306a6729e10a3ce"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_unwatch2</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, uint64_t<em>&nbsp;cookie</em><big>)</big><a class="headerlink" href="#rados_unwatch2" title="Permalink to this definition">¶</a></dt>
<dd><p>Unregister an interest in an object</p>
<p>Once this completes, no more notifies will be sent to us for this watch. This should be called to clean up unneeded watchers.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool the object is in </li>
<li><tt class="docutils literal"><span class="pre">cookie</span></tt>: which watch to unregister </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_unwatch">
<span class="target" id="librados_8h_1a047a573922b6ab012401f52ce8b615f7"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_unwatch</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, uint64_t<em>&nbsp;cookie</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em><big>)</big><a class="headerlink" href="#rados_aio_unwatch" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronous unregister an interest in an object</p>
<p>Once this completes, no more notifies will be sent to us for this watch. This should be called to clean up unneeded watchers.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool the object is in </li>
<li><tt class="docutils literal"><span class="pre">completion</span></tt>: what to do when operation has been attempted </li>
<li><tt class="docutils literal"><span class="pre">cookie</span></tt>: which watch to unregister </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_notify">
<span class="target" id="librados_8h_1ae3370754262b3593eb320c021782fb6c"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_notify</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, uint64_t<em>&nbsp;ver</em>, const char *<em>&nbsp;buf</em>, int<em>&nbsp;buf_len</em><big>)</big><a class="headerlink" href="#rados_notify" title="Permalink to this definition">¶</a></dt>
<dd><p>Sychronously notify watchers of an object</p>
<p>This blocks until all watchers of the object have received and reacted to the notify, or a timeout is reached.</p>
<p><dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>BUG: the timeout is not changeable via the C API </dd>
<dt><strong>Note</strong></dt>
<dd>BUG: the bufferlist is inaccessible in a rados_watchcb_t</dd>
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool the object is in </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: the name of the object </li>
<li><tt class="docutils literal"><span class="pre">ver</span></tt>: obsolete - just pass zero </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: data to send to watchers </li>
<li><tt class="docutils literal"><span class="pre">buf_len</span></tt>: length of buf in bytes </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_notify2">
<span class="target" id="librados_8h_1ac14c542aeec3a5e5a2438f0e0fc511bd"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_notify2</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, const char *<em>&nbsp;buf</em>, int<em>&nbsp;buf_len</em>, uint64_t<em>&nbsp;timeout_ms</em>, char **<em>&nbsp;reply_buffer</em>, size_t *<em>&nbsp;reply_buffer_len</em><big>)</big><a class="headerlink" href="#rados_notify2" title="Permalink to this definition">¶</a></dt>
<dd><p>Sychronously notify watchers of an object</p>
<p>This blocks until all watchers of the object have received and reacted to the notify, or a timeout is reached.</p>
<p>The reply buffer is optional. If specified, the client will get back an encoded buffer that includes the ids of the clients that acknowledged the notify as well as their notify ack payloads (if any). Clients that timed out are not included. Even clients that do not include a notify ack payload are included in the list but have a 0-length payload associated with them. The format:</p>
<p>le32 num_acks { le64 gid global id for the client (for client.1234 that&#8217;s 1234) le64 cookie cookie for the client le32 buflen length of reply message buffer u8 * buflen payload } * num_acks le32 num_timeouts { le64 gid global id for the client le64 cookie cookie for the client } * num_timeouts</p>
<p>Note: There may be multiple instances of the same gid if there are multiple watchers registered via the same client.</p>
<p>Note: The buffer must be released with rados_buffer_free() when the user is done with it.</p>
<p>Note: Since the result buffer includes clients that time out, it will be set even when rados_notify() returns an error code (like -ETIMEDOUT).</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool the object is in </li>
<li><tt class="docutils literal"><span class="pre">completion</span></tt>: what to do when operation has been attempted </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: the name of the object </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: data to send to watchers </li>
<li><tt class="docutils literal"><span class="pre">buf_len</span></tt>: length of buf in bytes </li>
<li><tt class="docutils literal"><span class="pre">timeout_ms</span></tt>: notify timeout (in ms) </li>
<li><tt class="docutils literal"><span class="pre">reply_buffer</span></tt>: pointer to reply buffer pointer (free with rados_buffer_free) </li>
<li><tt class="docutils literal"><span class="pre">reply_buffer_len</span></tt>: pointer to size of reply buffer </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_notify">
<span class="target" id="librados_8h_1a0829ca833dc01940cf479be41126f9ba"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_notify</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, const char *<em>&nbsp;buf</em>, int<em>&nbsp;buf_len</em>, uint64_t<em>&nbsp;timeout_ms</em>, char **<em>&nbsp;reply_buffer</em>, size_t *<em>&nbsp;reply_buffer_len</em><big>)</big><a class="headerlink" href="#rados_aio_notify" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="rados_notify_ack">
<span class="target" id="librados_8h_1aa9190c17b299ea172324ecd2f82559f1"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_notify_ack</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, uint64_t<em>&nbsp;notify_id</em>, uint64_t<em>&nbsp;cookie</em>, const char *<em>&nbsp;buf</em>, int<em>&nbsp;buf_len</em><big>)</big><a class="headerlink" href="#rados_notify_ack" title="Permalink to this definition">¶</a></dt>
<dd><p>Acknolwedge receipt of a notify</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool the object is in </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: the name of the object </li>
<li><tt class="docutils literal"><span class="pre">notify_id</span></tt>: the notify_id we got on the watchcb2_t callback </li>
<li><tt class="docutils literal"><span class="pre">cookie</span></tt>: the watcher handle </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: payload to return to notifier (optional) </li>
<li><tt class="docutils literal"><span class="pre">buf_len</span></tt>: payload length </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_watch_flush">
<span class="target" id="librados_8h_1a318a5626111fcebbc9133720a253003c"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_watch_flush</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em><big>)</big><a class="headerlink" href="#rados_watch_flush" title="Permalink to this definition">¶</a></dt>
<dd><p>Flush watch/notify callbacks</p>
<p>This call will block until all pending watch/notify callbacks have been executed and the queue is empty. It should usually be called after shutting down any watches before shutting down the ioctx or librados to ensure that any callbacks do not misuse the ioctx (for example by calling rados_notify_ack after the ioctx has been destroyed).</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: the cluster handle </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_watch_flush">
<span class="target" id="librados_8h_1a0d34fe0e1e9d4b5cbbbebf3796bb7547"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_watch_flush</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em><big>)</big><a class="headerlink" href="#rados_aio_watch_flush" title="Permalink to this definition">¶</a></dt>
<dd><p>Flush watch/notify callbacks</p>
<p>This call will be nonblock, and the completion will be called until all pending watch/notify callbacks have been executed and the queue is empty. It should usually be called after shutting down any watches before shutting down the ioctx or librados to ensure that any callbacks do not misuse the ioctx (for example by calling rados_notify_ack after the ioctx has been destroyed).</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: the cluster handle </li>
<li><tt class="docutils literal"><span class="pre">completion</span></tt>: what to do when operation has been attempted </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Mon/OSD/PG Commands</p>
<p>These interfaces send commands relating to the monitor, OSD, or PGs. </p>
<dl class="typedef">
<dt id="rados_log_callback_t">
<span class="target" id="librados_8h_1ab4022414e832a8474f354826b71b9e59"></span><em class="property">typedef </em>void<tt class="descname">(* rados_log_callback_t)</tt><big>(</big>void<em>&nbsp;*arg</em>, const char<em>&nbsp;*line</em>, const char<em>&nbsp;*who</em>, uint64_t<em>&nbsp;sec</em>, uint64_t<em>&nbsp;nsec</em>, uint64_t<em>&nbsp;seq</em>, const char<em>&nbsp;*level</em>, const char<em>&nbsp;*msg</em><big>)</big><a class="headerlink" href="#rados_log_callback_t" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="rados_mon_command">
<span class="target" id="librados_8h_1aa99ad43fce68696b2ef3710436807c70"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_mon_command</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char **<em>&nbsp;cmd</em>, size_t<em>&nbsp;cmdlen</em>, const char *<em>&nbsp;inbuf</em>, size_t<em>&nbsp;inbuflen</em>, char **<em>&nbsp;outbuf</em>, size_t *<em>&nbsp;outbuflen</em>, char **<em>&nbsp;outs</em>, size_t *<em>&nbsp;outslen</em><big>)</big><a class="headerlink" href="#rados_mon_command" title="Permalink to this definition">¶</a></dt>
<dd><p>Send monitor command.</p>
<p>
The result buffers are allocated on the heap; the caller is expected to release that memory with rados_buffer_free(). The buffer and length pointers can all be NULL, in which case they are not filled in.<dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>Takes command string in carefully-formatted JSON; must match defined commands, types, etc.</dd>
</dl>
</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: cluster handle </li>
<li><tt class="docutils literal"><span class="pre">cmd</span></tt>: an array of char *&#8217;s representing the command </li>
<li><tt class="docutils literal"><span class="pre">cmdlen</span></tt>: count of valid entries in cmd </li>
<li><tt class="docutils literal"><span class="pre">inbuf</span></tt>: any bulk input data (crush map, etc.) </li>
<li><tt class="docutils literal"><span class="pre">outbuf</span></tt>: double pointer to output buffer </li>
<li><tt class="docutils literal"><span class="pre">outbuflen</span></tt>: pointer to output buffer length </li>
<li><tt class="docutils literal"><span class="pre">outs</span></tt>: double pointer to status string </li>
<li><tt class="docutils literal"><span class="pre">outslen</span></tt>: pointer to status string length </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_mgr_command">
<span class="target" id="librados_8h_1adb3dc8b50a7de27fdc3cfe8df406605a"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_mgr_command</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char **<em>&nbsp;cmd</em>, size_t<em>&nbsp;cmdlen</em>, const char *<em>&nbsp;inbuf</em>, size_t<em>&nbsp;inbuflen</em>, char **<em>&nbsp;outbuf</em>, size_t *<em>&nbsp;outbuflen</em>, char **<em>&nbsp;outs</em>, size_t *<em>&nbsp;outslen</em><big>)</big><a class="headerlink" href="#rados_mgr_command" title="Permalink to this definition">¶</a></dt>
<dd><p>Send ceph-mgr command.</p>
<p>
The result buffers are allocated on the heap; the caller is expected to release that memory with rados_buffer_free(). The buffer and length pointers can all be NULL, in which case they are not filled in.<dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>Takes command string in carefully-formatted JSON; must match defined commands, types, etc.</dd>
</dl>
</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: cluster handle </li>
<li><tt class="docutils literal"><span class="pre">cmd</span></tt>: an array of char *&#8217;s representing the command </li>
<li><tt class="docutils literal"><span class="pre">cmdlen</span></tt>: count of valid entries in cmd </li>
<li><tt class="docutils literal"><span class="pre">inbuf</span></tt>: any bulk input data (crush map, etc.) </li>
<li><tt class="docutils literal"><span class="pre">outbuf</span></tt>: double pointer to output buffer </li>
<li><tt class="docutils literal"><span class="pre">outbuflen</span></tt>: pointer to output buffer length </li>
<li><tt class="docutils literal"><span class="pre">outs</span></tt>: double pointer to status string </li>
<li><tt class="docutils literal"><span class="pre">outslen</span></tt>: pointer to status string length </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_mon_command_target">
<span class="target" id="librados_8h_1a6e3012a57bd3f377b2cc85be6aacb940"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_mon_command_target</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char *<em>&nbsp;name</em>, const char **<em>&nbsp;cmd</em>, size_t<em>&nbsp;cmdlen</em>, const char *<em>&nbsp;inbuf</em>, size_t<em>&nbsp;inbuflen</em>, char **<em>&nbsp;outbuf</em>, size_t *<em>&nbsp;outbuflen</em>, char **<em>&nbsp;outs</em>, size_t *<em>&nbsp;outslen</em><big>)</big><a class="headerlink" href="#rados_mon_command_target" title="Permalink to this definition">¶</a></dt>
<dd><p>Send monitor command to a specific monitor.</p>
<p>
The result buffers are allocated on the heap; the caller is expected to release that memory with rados_buffer_free(). The buffer and length pointers can all be NULL, in which case they are not filled in.<dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>Takes command string in carefully-formatted JSON; must match defined commands, types, etc.</dd>
</dl>
</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: cluster handle </li>
<li><tt class="docutils literal"><span class="pre">name</span></tt>: target monitor&#8217;s name </li>
<li><tt class="docutils literal"><span class="pre">cmd</span></tt>: an array of char *&#8217;s representing the command </li>
<li><tt class="docutils literal"><span class="pre">cmdlen</span></tt>: count of valid entries in cmd </li>
<li><tt class="docutils literal"><span class="pre">inbuf</span></tt>: any bulk input data (crush map, etc.) </li>
<li><tt class="docutils literal"><span class="pre">outbuf</span></tt>: double pointer to output buffer </li>
<li><tt class="docutils literal"><span class="pre">outbuflen</span></tt>: pointer to output buffer length </li>
<li><tt class="docutils literal"><span class="pre">outs</span></tt>: double pointer to status string </li>
<li><tt class="docutils literal"><span class="pre">outslen</span></tt>: pointer to status string length </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_buffer_free">
<span class="target" id="librados_8h_1ae9e2a3c60e90c9a6ffee2b375323277e"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_buffer_free</tt><big>(</big>char *<em>&nbsp;buf</em><big>)</big><a class="headerlink" href="#rados_buffer_free" title="Permalink to this definition">¶</a></dt>
<dd><p>free a rados-allocated buffer</p>
<p>Release memory allocated by librados calls like rados_mon_command().</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: buffer pointer </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_osd_command">
<span class="target" id="librados_8h_1ac4f964d0905d7fa0e4706472b1b32ece"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_osd_command</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, int<em>&nbsp;osdid</em>, const char **<em>&nbsp;cmd</em>, size_t<em>&nbsp;cmdlen</em>, const char *<em>&nbsp;inbuf</em>, size_t<em>&nbsp;inbuflen</em>, char **<em>&nbsp;outbuf</em>, size_t *<em>&nbsp;outbuflen</em>, char **<em>&nbsp;outs</em>, size_t *<em>&nbsp;outslen</em><big>)</big><a class="headerlink" href="#rados_osd_command" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="rados_pg_command">
<span class="target" id="librados_8h_1ae5f01307bed3525328794aefaa1ed0bf"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_pg_command</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char *<em>&nbsp;pgstr</em>, const char **<em>&nbsp;cmd</em>, size_t<em>&nbsp;cmdlen</em>, const char *<em>&nbsp;inbuf</em>, size_t<em>&nbsp;inbuflen</em>, char **<em>&nbsp;outbuf</em>, size_t *<em>&nbsp;outbuflen</em>, char **<em>&nbsp;outs</em>, size_t *<em>&nbsp;outslen</em><big>)</big><a class="headerlink" href="#rados_pg_command" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="rados_monitor_log">
<span class="target" id="librados_8h_1a1347de47c1844df177a3e96388e57843"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_monitor_log</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char *<em>&nbsp;level</em>, <a class="reference internal" href="#rados_log_callback_t" title="rados_log_callback_t">rados_log_callback_t</a><em>&nbsp;cb</em>, void *<em>&nbsp;arg</em><big>)</big><a class="headerlink" href="#rados_monitor_log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Setup and Teardown</p>
<p>These are the first and last functions to that should be called when using librados. </p>
<dl class="function">
<dt id="rados_create">
<span class="target" id="librados_8h_1aa9742cf78cb317220fd7d88bfa4c4fe1"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_create</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a> *<em>&nbsp;cluster</em>, const char *const<em>&nbsp;id</em><big>)</big><a class="headerlink" href="#rados_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a handle for communicating with a RADOS cluster.</p>
<p>Ceph environment variables are read when this is called, so if $CEPH_ARGS specifies everything you need to connect, no further configuration is necessary.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: where to store the handle </li>
<li><tt class="docutils literal"><span class="pre">id</span></tt>: the user to connect as (i.e. admin, not client.admin) </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_create2">
<span class="target" id="librados_8h_1a1bca04c057fb4c8c1dea33d78aa1f4c8"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_create2</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a> *<em>&nbsp;pcluster</em>, const char *const<em>&nbsp;clustername</em>, const char *const<em>&nbsp;name</em>, uint64_t<em>&nbsp;flags</em><big>)</big><a class="headerlink" href="#rados_create2" title="Permalink to this definition">¶</a></dt>
<dd><p>Extended version of rados_create.</p>
<p>Like rados_create, but 1) don&#8217;t assume &#8216;client.&#8217;+id; allow full specification of name 2) allow specification of cluster name 3) flags for future expansion </p>
</dd></dl>

<dl class="function">
<dt id="rados_create_with_context">
<span class="target" id="librados_8h_1af60d8e0acb6e3220642dc1a9c0254fd6"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_create_with_context</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a> *<em>&nbsp;cluster</em>, <a class="reference internal" href="#rados_config_t" title="rados_config_t">rados_config_t</a><em>&nbsp;cct</em><big>)</big><a class="headerlink" href="#rados_create_with_context" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize a cluster handle from an existing configuration.</p>
<p>Share configuration state with another rados_t instance.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: where to store the handle </li>
<li><tt class="docutils literal"><span class="pre">cct</span></tt>: the existing configuration to use </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ping_monitor">
<span class="target" id="librados_8h_1a61b0803b9e25117e18da841af05bedd2"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_ping_monitor</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char *<em>&nbsp;mon_id</em>, char **<em>&nbsp;outstr</em>, size_t *<em>&nbsp;outstrlen</em><big>)</big><a class="headerlink" href="#rados_ping_monitor" title="Permalink to this definition">¶</a></dt>
<dd><p>Ping the monitor with ID mon_id, storing the resulting reply in buf (if specified) with a maximum size of len.</p>
<p>The result buffer is allocated on the heap; the caller is expected to release that memory with rados_buffer_free(). The buffer and length pointers can be NULL, in which case they are not filled in.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: cluster handle </li>
<li><tt class="docutils literal"><span class="pre">mon_id</span></tt>: ID of the monitor to ping </li>
<li><tt class="docutils literal"><span class="pre">outstr</span></tt>: double pointer with the resulting reply </li>
<li><tt class="docutils literal"><span class="pre">outstrlen</span></tt>: pointer with the size of the reply in outstr </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_connect">
<span class="target" id="librados_8h_1a4176493c4660ee4e575351b27f1e5716"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_connect</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em><big>)</big><a class="headerlink" href="#rados_connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect to the cluster.</p>
<p><dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>BUG: Before calling this, calling a function that communicates with the cluster will crash.</dd>
<dt><strong>Pre</strong></dt>
<dd>The cluster handle is configured with at least a monitor address. If cephx is enabled, a client name and secret must also be set.</dd>
<dt><strong>Post</strong></dt>
<dd>If this succeeds, any function in librados may be used</dd>
<dt><strong>Return</strong></dt>
<dd>0 on sucess, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: The cluster to connect to. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_shutdown">
<span class="target" id="librados_8h_1a4c22ecfd1a92786498dc8813e6b87d4b"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_shutdown</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em><big>)</big><a class="headerlink" href="#rados_shutdown" title="Permalink to this definition">¶</a></dt>
<dd><p>Disconnects from the cluster.</p>
<p>For clean up, this is only necessary after rados_connect() has succeeded.</p>
<p><dl class="docutils">
<dt><strong>Warning</strong></dt>
<dd>This does not guarantee any asynchronous writes have completed. To do that, you must call rados_aio_flush() on all open io contexts.</dd>
<dt><strong>Warning</strong></dt>
<dd>We implicitly call rados_watch_flush() on shutdown. If there are watches being used, this should be done explicitly before destroying the relevant IoCtx. We do it here as a safety measure.</dd>
<dt><strong>Post</strong></dt>
<dd>the cluster handle cannot be used again</dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: the cluster to shutdown </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Configuration</p>
<p>These functions read and update Ceph configuration for a cluster handle. Any configuration changes must be done before connecting to the cluster.</p>
<p>Options that librados users might want to set include:<ul class="simple">
<li>mon_host</li>
<li>auth_supported</li>
<li>key, keyfile, or keyring when using cephx</li>
<li>log_file, log_to_stderr, err_to_stderr, and log_to_syslog</li>
<li>debug_rados, debug_objecter, debug_monc, debug_auth, or debug_ms</li>
</ul>
</p>
<p>All possible options can be found in src/common/config_opts.h in ceph.git </p>
<dl class="function">
<dt id="rados_conf_read_file">
<span class="target" id="librados_8h_1a5170b2ff56c95ee659d296ffcaa93850"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_conf_read_file</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char *<em>&nbsp;path</em><big>)</big><a class="headerlink" href="#rados_conf_read_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure the cluster handle using a Ceph config file</p>
<p>If path is NULL, the default locations are searched, and the first found is used. The locations are:<ul class="simple">
<li>$CEPH_CONF (environment variable)</li>
<li>/etc/ceph/ceph.conf</li>
<li>~/.ceph/config</li>
<li>ceph.conf (in the current working directory)</li>
</ul>
</p>
<p><dl class="docutils">
<dt><strong>Pre</strong></dt>
<dd>rados_connect() has not been called on the cluster handle</dd>
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: cluster handle to configure </li>
<li><tt class="docutils literal"><span class="pre">path</span></tt>: path to a Ceph configuration file </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_conf_parse_argv">
<span class="target" id="librados_8h_1a2db871e5def16fffe89cfa6a15d15c7d"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_conf_parse_argv</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, int<em>&nbsp;argc</em>, const char **<em>&nbsp;argv</em><big>)</big><a class="headerlink" href="#rados_conf_parse_argv" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure the cluster handle with command line arguments</p>
<p>argv can contain any common Ceph command line option, including any configuration parameter prefixed by &#8216;&#8216; and replacing spaces with dashes or underscores. For example, the following options are equivalent:<ul class="simple">
<li>mon-host 10.0.0.1:6789</li>
<li>mon_host 10.0.0.1:6789</li>
<li>-m 10.0.0.1:6789</li>
</ul>
</p>
<p><dl class="docutils">
<dt><strong>Pre</strong></dt>
<dd>rados_connect() has not been called on the cluster handle</dd>
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: cluster handle to configure </li>
<li><tt class="docutils literal"><span class="pre">argc</span></tt>: number of arguments in argv </li>
<li><tt class="docutils literal"><span class="pre">argv</span></tt>: arguments to parse </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_conf_parse_argv_remainder">
<span class="target" id="librados_8h_1a4b940f3adbd61b9bfc61c70180f99a2a"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_conf_parse_argv_remainder</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, int<em>&nbsp;argc</em>, const char **<em>&nbsp;argv</em>, const char **<em>&nbsp;remargv</em><big>)</big><a class="headerlink" href="#rados_conf_parse_argv_remainder" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure the cluster handle with command line arguments, returning any remainders. Same rados_conf_parse_argv, except for extra remargv argument to hold returns unrecognized arguments.</p>
<p><dl class="docutils">
<dt><strong>Pre</strong></dt>
<dd>rados_connect() has not been called on the cluster handle</dd>
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: cluster handle to configure </li>
<li><tt class="docutils literal"><span class="pre">argc</span></tt>: number of arguments in argv </li>
<li><tt class="docutils literal"><span class="pre">argv</span></tt>: arguments to parse </li>
<li><tt class="docutils literal"><span class="pre">remargv</span></tt>: char* array for returned unrecognized arguments </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_conf_parse_env">
<span class="target" id="librados_8h_1a8d01404bf97ef89f6e8b71253cf387fa"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_conf_parse_env</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char *<em>&nbsp;var</em><big>)</big><a class="headerlink" href="#rados_conf_parse_env" title="Permalink to this definition">¶</a></dt>
<dd><p>Configure the cluster handle based on an environment variable</p>
<p>The contents of the environment variable are parsed as if they were Ceph command line options. If var is NULL, the CEPH_ARGS environment variable is used.</p>
<p><dl class="docutils">
<dt><strong>Pre</strong></dt>
<dd>rados_connect() has not been called on the cluster handle</dd>
<dt><strong>Note</strong></dt>
<dd>BUG: this is not threadsafe - it uses a static buffer</dd>
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: cluster handle to configure </li>
<li><tt class="docutils literal"><span class="pre">var</span></tt>: name of the environment variable to read </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_conf_set">
<span class="target" id="librados_8h_1a668b1ea063260d532866f840d3acac9a"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_conf_set</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char *<em>&nbsp;option</em>, const char *<em>&nbsp;value</em><big>)</big><a class="headerlink" href="#rados_conf_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a configuration option</p>
<p><dl class="docutils">
<dt><strong>Pre</strong></dt>
<dd>rados_connect() has not been called on the cluster handle</dd>
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Return</strong></dt>
<dd>-ENOENT when the option is not a Ceph configuration option </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: cluster handle to configure </li>
<li><tt class="docutils literal"><span class="pre">option</span></tt>: option to set </li>
<li><tt class="docutils literal"><span class="pre">value</span></tt>: value of the option </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_conf_get">
<span class="target" id="librados_8h_1abfc74223915b1454cae8052255502d52"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_conf_get</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char *<em>&nbsp;option</em>, char *<em>&nbsp;buf</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_conf_get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the value of a configuration option</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Return</strong></dt>
<dd>-ENAMETOOLONG if the buffer is too short to contain the requested value </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: configuration to read </li>
<li><tt class="docutils literal"><span class="pre">option</span></tt>: which option to read </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: where to write the configuration value </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: the size of buf in bytes </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Pools</p>
<p>RADOS pools are separate namespaces for objects. Pools may have different crush rules associated with them, so they could have differing replication levels or placement strategies. RADOS permissions are also tied to pools - users can have different read, write, and execute permissions on a per-pool basis. </p>
<dl class="function">
<dt id="rados_pool_list">
<span class="target" id="librados_8h_1a7c704b5329e2fbbbcb4707f3b9eb645e"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_pool_list</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, char *<em>&nbsp;buf</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_pool_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List pools</p>
<p>Gets a list of pool names as NULL-terminated strings. The pool names will be placed in the supplied buffer one after another. After the last pool name, there will be two 0 bytes in a row.</p>
<p>If len is too short to fit all the pool name entries we need, we will fill as much as we can.</p>
<p>Buf may be null to determine the buffer size needed to list all pools.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>length of the buffer we would need to list all pools </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: cluster handle </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: output buffer </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: output buffer length </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_inconsistent_pg_list">
<span class="target" id="librados_8h_1a69386d14d9c01818c36118d6fc1862b2"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_inconsistent_pg_list</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, int64_t<em>&nbsp;pool</em>, char *<em>&nbsp;buf</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_inconsistent_pg_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List inconsistent placement groups of the given pool</p>
<p>Gets a list of inconsistent placement groups as NULL-terminated strings. The placement group names will be placed in the supplied buffer one after another. After the last name, there will be two 0 types in a row.</p>
<p>If len is too short to fit all the placement group entries we need, we will fill as much as we can.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>length of the buffer we would need to list all pools </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: cluster handle </li>
<li><tt class="docutils literal"><span class="pre">pool</span></tt>: pool ID </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: output buffer </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: output buffer length </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_cct">
<span class="target" id="librados_8h_1ad187e4b926e52afb36ae11d0e13c4ead"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> <a class="reference internal" href="#rados_config_t" title="rados_config_t">rados_config_t</a> <tt class="descname">rados_cct</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em><big>)</big><a class="headerlink" href="#rados_cct" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a configuration handle for a rados cluster handle</p>
<p>This handle is valid only as long as the cluster handle is valid.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>config handle for this cluster </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: cluster handle </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_get_instance_id">
<span class="target" id="librados_8h_1a3822759cc115c7c765e079a9d641a799"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> uint64_t <tt class="descname">rados_get_instance_id</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em><big>)</big><a class="headerlink" href="#rados_get_instance_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a global id for current instance</p>
<p>This id is a unique representation of current connection to the cluster</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>instance global id </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: cluster handle </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_create">
<span class="target" id="librados_8h_1ac24160ffe35b9ace2e2e331ae4090681"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_ioctx_create</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char *<em>&nbsp;pool_name</em>, <a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a> *<em>&nbsp;ioctx</em><big>)</big><a class="headerlink" href="#rados_ioctx_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an io context</p>
<p>The io context allows you to perform operations within a particular pool. For more details see rados_ioctx_t.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: which cluster the pool is in </li>
<li><tt class="docutils literal"><span class="pre">pool_name</span></tt>: name of the pool </li>
<li><tt class="docutils literal"><span class="pre">ioctx</span></tt>: where to store the io context </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_create2">
<span class="target" id="librados_8h_1af2a155a7adb7612397b702497bbdc3a5"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_ioctx_create2</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, int64_t<em>&nbsp;pool_id</em>, <a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a> *<em>&nbsp;ioctx</em><big>)</big><a class="headerlink" href="#rados_ioctx_create2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="rados_ioctx_destroy">
<span class="target" id="librados_8h_1a3f705343b9053c2524465a72c4bdc861"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_ioctx_destroy</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em><big>)</big><a class="headerlink" href="#rados_ioctx_destroy" title="Permalink to this definition">¶</a></dt>
<dd><p>The opposite of rados_ioctx_create</p>
<p>This just tells librados that you no longer need to use the io context. It may not be freed immediately if there are pending asynchronous requests on it, but you should not use an io context again after calling this function on it.</p>
<p><dl class="docutils">
<dt><strong>Warning</strong></dt>
<dd>This does not guarantee any asynchronous writes have completed. You must call rados_aio_flush() on the io context before destroying it to do that.</dd>
<dt><strong>Warning</strong></dt>
<dd>If this ioctx is used by rados_watch, the caller needs to be sure that all registered watches are disconnected via rados_unwatch() and that rados_watch_flush() is called. This ensures that a racing watch callback does not make use of a destroyed ioctx.</dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the io context to dispose of </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_cct">
<span class="target" id="librados_8h_1a03cd4b9a87140e7835b6ffb72c8187d2"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> <a class="reference internal" href="#rados_config_t" title="rados_config_t">rados_config_t</a> <tt class="descname">rados_ioctx_cct</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em><big>)</big><a class="headerlink" href="#rados_ioctx_cct" title="Permalink to this definition">¶</a></dt>
<dd><p>Get configuration hadnle for a pool handle</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>rados_config_t for this cluster </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: pool handle </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_get_cluster">
<span class="target" id="librados_8h_1ab251a7fc84fb169edd138d7ec15d8c5e"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> <a class="reference internal" href="#rados_t" title="rados_t">rados_t</a> <tt class="descname">rados_ioctx_get_cluster</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em><big>)</big><a class="headerlink" href="#rados_ioctx_get_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the cluster handle used by this rados_ioctx_t Note that this is a weak reference, and should not be destroyed via rados_shutdown().</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>the cluster handle for this io context </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the io context </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_pool_stat">
<span class="target" id="librados_8h_1ac3b3523507dc0ac32a83e22a2eee0656"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_ioctx_pool_stat</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, struct  <a class="reference internal" href="#rados_pool_stat_t" title="rados_pool_stat_t">rados_pool_stat_t</a>  *<em>&nbsp;stats</em><big>)</big><a class="headerlink" href="#rados_ioctx_pool_stat" title="Permalink to this definition">¶</a></dt>
<dd><p>Get pool usage statistics</p>
<p>Fills in a <a class="reference internal" href="#structrados__pool__stat__t"><em>rados_pool_stat_t</em></a> after querying the cluster.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: determines which pool to query </li>
<li><tt class="docutils literal"><span class="pre">stats</span></tt>: where to store the results </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_pool_lookup">
<span class="target" id="librados_8h_1ab094a6ef983aa2d1bb54566642b918e5"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int64_t <tt class="descname">rados_pool_lookup</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char *<em>&nbsp;pool_name</em><big>)</big><a class="headerlink" href="#rados_pool_lookup" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the id of a pool</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>id of the pool </dd>
<dt><strong>Return</strong></dt>
<dd>-ENOENT if the pool is not found </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: which cluster the pool is in </li>
<li><tt class="docutils literal"><span class="pre">pool_name</span></tt>: which pool to look up </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_pool_reverse_lookup">
<span class="target" id="librados_8h_1a2e9949fa2709a5c121aef94fbaa9ad46"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_pool_reverse_lookup</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, int64_t<em>&nbsp;id</em>, char *<em>&nbsp;buf</em>, size_t<em>&nbsp;maxlen</em><big>)</big><a class="headerlink" href="#rados_pool_reverse_lookup" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the name of a pool</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>length of string stored, or -ERANGE if buffer too small </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: which cluster the pool is in </li>
<li><tt class="docutils literal"><span class="pre">id</span></tt>: the id of the pool </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: where to store the pool name </li>
<li><tt class="docutils literal"><span class="pre">maxlen</span></tt>: size of buffer where name will be stored </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_pool_create">
<span class="target" id="librados_8h_1a0007dc3d96a17f5df1effcd3d079f0ec"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_pool_create</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char *<em>&nbsp;pool_name</em><big>)</big><a class="headerlink" href="#rados_pool_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a pool with default settings</p>
<p>The default owner is the admin user (auid 0). The default crush rule is rule 0.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: the cluster in which the pool will be created </li>
<li><tt class="docutils literal"><span class="pre">pool_name</span></tt>: the name of the new pool </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_pool_create_with_auid">
<span class="target" id="librados_8h_1a0ddaa1aa21e3ec37b16d2664fa040fab"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_pool_create_with_auid</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char *<em>&nbsp;pool_name</em>, uint64_t<em>&nbsp;auid</em><big>)</big><a class="headerlink" href="#rados_pool_create_with_auid" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a pool owned by a specific auid</p>
<p>The auid is the authenticated user id to give ownership of the pool. TODO: document auid and the rest of the auth system</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: the cluster in which the pool will be created </li>
<li><tt class="docutils literal"><span class="pre">pool_name</span></tt>: the name of the new pool </li>
<li><tt class="docutils literal"><span class="pre">auid</span></tt>: the id of the owner of the new pool </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_pool_create_with_crush_rule">
<span class="target" id="librados_8h_1a4de57d42b5856c289fde94611b92ef00"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_pool_create_with_crush_rule</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char *<em>&nbsp;pool_name</em>, uint8_t<em>&nbsp;crush_rule_num</em><big>)</big><a class="headerlink" href="#rados_pool_create_with_crush_rule" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a pool with a specific CRUSH rule</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: the cluster in which the pool will be created </li>
<li><tt class="docutils literal"><span class="pre">pool_name</span></tt>: the name of the new pool </li>
<li><tt class="docutils literal"><span class="pre">crush_rule_num</span></tt>: which rule to use for placement in the new pool1 </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_pool_create_with_all">
<span class="target" id="librados_8h_1a9f06b11e9f39cc2058759ffc924c376f"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_pool_create_with_all</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char *<em>&nbsp;pool_name</em>, uint64_t<em>&nbsp;auid</em>, uint8_t<em>&nbsp;crush_rule_num</em><big>)</big><a class="headerlink" href="#rados_pool_create_with_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a pool with a specific CRUSH rule and auid</p>
<p>This is a combination of rados_pool_create_with_crush_rule() and rados_pool_create_with_auid().</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: the cluster in which the pool will be created </li>
<li><tt class="docutils literal"><span class="pre">pool_name</span></tt>: the name of the new pool </li>
<li><tt class="docutils literal"><span class="pre">crush_rule_num</span></tt>: which rule to use for placement in the new pool2 </li>
<li><tt class="docutils literal"><span class="pre">auid</span></tt>: the id of the owner of the new pool </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_pool_get_base_tier">
<span class="target" id="librados_8h_1a39453238a28559db6285d37e4f146fda"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_pool_get_base_tier</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, int64_t<em>&nbsp;pool</em>, int64_t *<em>&nbsp;base_tier</em><big>)</big><a class="headerlink" href="#rados_pool_get_base_tier" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the pool that is the base tier for this pool.</p>
<p>The return value is the ID of the pool that should be used to read from/write to. If tiering is not set up for the pool, returns <tt class="docutils literal"><span class="pre">pool</span></tt>.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: the cluster the pool is in </li>
<li><tt class="docutils literal"><span class="pre">pool</span></tt>: ID of the pool to query </li>
<li><tt class="docutils literal"><span class="pre">base_tier</span></tt>: base tier, or <tt class="docutils literal"><span class="pre">pool</span></tt> if tiering is not configured </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_pool_delete">
<span class="target" id="librados_8h_1a01ebc54925104a5448e683ce84691db6"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_pool_delete</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, const char *<em>&nbsp;pool_name</em><big>)</big><a class="headerlink" href="#rados_pool_delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a pool and all data inside it</p>
<p>The pool is removed from the cluster immediately, but the actual data is deleted in the background.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: the cluster the pool is in </li>
<li><tt class="docutils literal"><span class="pre">pool_name</span></tt>: which pool to delete </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_pool_set_auid">
<span class="target" id="librados_8h_1a41fa47100a5008e566b37fc8fa3a5188"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_ioctx_pool_set_auid</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, uint64_t<em>&nbsp;auid</em><big>)</big><a class="headerlink" href="#rados_ioctx_pool_set_auid" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt to change an io context&#8217;s associated auid &#8220;owner&#8221;</p>
<p>Requires that you have write permission on both the current and new auid.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: reference to the pool to change. </li>
<li><tt class="docutils literal"><span class="pre">auid</span></tt>: the auid you wish the io to have. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_pool_get_auid">
<span class="target" id="librados_8h_1a37ec07eec1dfe00e0629c2d48bf273a9"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_ioctx_pool_get_auid</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, uint64_t *<em>&nbsp;auid</em><big>)</big><a class="headerlink" href="#rados_ioctx_pool_get_auid" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the auid of a pool</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: pool to query </li>
<li><tt class="docutils literal"><span class="pre">auid</span></tt>: where to store the auid </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_pool_requires_alignment">
<span class="target" id="librados_8h_1ab5c09be567bc1feb8984a3b1ece0cd56"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_ioctx_pool_requires_alignment</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em><big>)</big><a class="headerlink" href="#rados_ioctx_pool_requires_alignment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="rados_ioctx_pool_requires_alignment2">
<span class="target" id="librados_8h_1aafcab4c7c350d517df52c8e308046012"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_ioctx_pool_requires_alignment2</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, int *<em>&nbsp;requires</em><big>)</big><a class="headerlink" href="#rados_ioctx_pool_requires_alignment2" title="Permalink to this definition">¶</a></dt>
<dd><p>Test whether the specified pool requires alignment or not.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: pool to query </li>
<li><tt class="docutils literal"><span class="pre">requires</span></tt>: 1 if alignment is supported, 0 if not. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_pool_required_alignment">
<span class="target" id="librados_8h_1a0cb1c52fe21bf9d9779326b88a64073d"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> uint64_t <tt class="descname">rados_ioctx_pool_required_alignment</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em><big>)</big><a class="headerlink" href="#rados_ioctx_pool_required_alignment" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="rados_ioctx_pool_required_alignment2">
<span class="target" id="librados_8h_1a72832fdf5bfde1ad344eba3b0cc8821e"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_ioctx_pool_required_alignment2</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, uint64_t *<em>&nbsp;alignment</em><big>)</big><a class="headerlink" href="#rados_ioctx_pool_required_alignment2" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the alignment flavor of a pool</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: pool to query </li>
<li><tt class="docutils literal"><span class="pre">alignment</span></tt>: where to store the alignment flavor </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_get_id">
<span class="target" id="librados_8h_1a4c3d4ac83a5232c2a4ccec46ddb025bb"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int64_t <tt class="descname">rados_ioctx_get_id</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em><big>)</big><a class="headerlink" href="#rados_ioctx_get_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the pool id of the io context</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>the id of the pool the io context uses </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the io context to query </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_get_pool_name">
<span class="target" id="librados_8h_1ad607af55d4850b4a079bd53949ab993b"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_ioctx_get_pool_name</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, char *<em>&nbsp;buf</em>, unsigned<em>&nbsp;maxlen</em><big>)</big><a class="headerlink" href="#rados_ioctx_get_pool_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the pool name of the io context</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>length of string stored, or -ERANGE if buffer too small </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the io context to query </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: pointer to buffer where name will be stored </li>
<li><tt class="docutils literal"><span class="pre">maxlen</span></tt>: size of buffer where name will be stored </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Object Locators</p>
<dl class="function">
<dt id="rados_ioctx_locator_set_key">
<span class="target" id="librados_8h_1a2e89c516a1d2d462b3e37f4b71ff8313"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_ioctx_locator_set_key</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;key</em><big>)</big><a class="headerlink" href="#rados_ioctx_locator_set_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the key for mapping objects to pgs within an io context.</p>
<p>The key is used instead of the object name to determine which placement groups an object is put in. This affects all subsequent operations of the io context - until a different locator key is set, all objects in this io context will be placed in the same pg.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the io context to change </li>
<li><tt class="docutils literal"><span class="pre">key</span></tt>: the key to use as the object locator, or NULL to discard any previously set key </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_set_namespace">
<span class="target" id="librados_8h_1ab8ee4979c52cf36a32db54a9529b327b"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_ioctx_set_namespace</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;nspace</em><big>)</big><a class="headerlink" href="#rados_ioctx_set_namespace" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the namespace for objects within an io context</p>
<p>The namespace specification further refines a pool into different domains. The mapping of objects to pgs is also based on this value.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the io context to change </li>
<li><tt class="docutils literal"><span class="pre">nspace</span></tt>: the name to use as the namespace, or NULL use the default namespace </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Listing Objects</p>
<dl class="function">
<dt id="rados_nobjects_list_open">
<span class="target" id="librados_8h_1a22e50405d87eb14439239d715a530d6d"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_nobjects_list_open</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a> *<em>&nbsp;ctx</em><big>)</big><a class="headerlink" href="#rados_nobjects_list_open" title="Permalink to this definition">¶</a></dt>
<dd><p>Start listing objects in a pool</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool to list from </li>
<li><tt class="docutils literal"><span class="pre">ctx</span></tt>: the handle to store list context in </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_nobjects_list_get_pg_hash_position">
<span class="target" id="librados_8h_1ad67fee7e912ce55c839b57cceb660709"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> uint32_t <tt class="descname">rados_nobjects_list_get_pg_hash_position</tt><big>(</big><a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a><em>&nbsp;ctx</em><big>)</big><a class="headerlink" href="#rados_nobjects_list_get_pg_hash_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Return hash position of iterator, rounded to the current PG</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>current hash position, rounded to the current pg </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">ctx</span></tt>: iterator marking where you are in the listing </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_nobjects_list_seek">
<span class="target" id="librados_8h_1a5a7f2778daff7a4efad775cca61ae651"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> uint32_t <tt class="descname">rados_nobjects_list_seek</tt><big>(</big><a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a><em>&nbsp;ctx</em>, uint32_t<em>&nbsp;pos</em><big>)</big><a class="headerlink" href="#rados_nobjects_list_seek" title="Permalink to this definition">¶</a></dt>
<dd><p>Reposition object iterator to a different hash position</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>actual (rounded) position we moved to </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">ctx</span></tt>: iterator marking where you are in the listing </li>
<li><tt class="docutils literal"><span class="pre">pos</span></tt>: hash position to move to </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_nobjects_list_seek_cursor">
<span class="target" id="librados_8h_1ad2ebd647ad5ab1752f0152b452fac9d7"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> uint32_t <tt class="descname">rados_nobjects_list_seek_cursor</tt><big>(</big><a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a><em>&nbsp;ctx</em>, <a class="reference internal" href="#rados_object_list_cursor" title="rados_object_list_cursor">rados_object_list_cursor</a><em>&nbsp;cursor</em><big>)</big><a class="headerlink" href="#rados_nobjects_list_seek_cursor" title="Permalink to this definition">¶</a></dt>
<dd><p>Reposition object iterator to a different position</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>rounded position we moved to </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">ctx</span></tt>: iterator marking where you are in the listing </li>
<li><tt class="docutils literal"><span class="pre">cursor</span></tt>: position to move to </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_nobjects_list_get_cursor">
<span class="target" id="librados_8h_1a2f5296ee7e1f65b8e305fec371464b16"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_nobjects_list_get_cursor</tt><big>(</big><a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a><em>&nbsp;ctx</em>, <a class="reference internal" href="#rados_object_list_cursor" title="rados_object_list_cursor">rados_object_list_cursor</a> *<em>&nbsp;cursor</em><big>)</big><a class="headerlink" href="#rados_nobjects_list_get_cursor" title="Permalink to this definition">¶</a></dt>
<dd><p>Reposition object iterator to a different position</p>
<p>The returned handle must be released with rados_object_list_cursor_free().</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">ctx</span></tt>: iterator marking where you are in the listing </li>
<li><tt class="docutils literal"><span class="pre">cursor</span></tt>: where to store cursor </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_nobjects_list_next">
<span class="target" id="librados_8h_1adeba815154ac9b24e731a14e04281668"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_nobjects_list_next</tt><big>(</big><a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a><em>&nbsp;ctx</em>, const char **<em>&nbsp;entry</em>, const char **<em>&nbsp;key</em>, const char **<em>&nbsp;nspace</em><big>)</big><a class="headerlink" href="#rados_nobjects_list_next" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the next object name and locator in the pool</p>
<p><em>entry and *key are valid until next call to rados_nobjects_list_</em></p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Return</strong></dt>
<dd>-ENOENT when there are no more objects to list </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">ctx</span></tt>: iterator marking where you are in the listing </li>
<li><tt class="docutils literal"><span class="pre">entry</span></tt>: where to store the name of the entry </li>
<li><tt class="docutils literal"><span class="pre">key</span></tt>: where to store the object locator (set to NULL to ignore) </li>
<li><tt class="docutils literal"><span class="pre">nspace</span></tt>: where to store the object namespace (set to NULL to ignore) </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_nobjects_list_close">
<span class="target" id="librados_8h_1af87da9fc306f53098ed4fe9a5fdfbd84"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_nobjects_list_close</tt><big>(</big><a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a><em>&nbsp;ctx</em><big>)</big><a class="headerlink" href="#rados_nobjects_list_close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the object listing handle.</p>
<p>This should be called when the handle is no longer needed. The handle should not be used after it has been closed.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">ctx</span></tt>: the handle to close </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_object_list_begin">
<span class="target" id="librados_8h_1a0d21887b9d2c2a5f1d9b5ae6c26ed058"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> <a class="reference internal" href="#rados_object_list_cursor" title="rados_object_list_cursor">rados_object_list_cursor</a> <tt class="descname">rados_object_list_begin</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em><big>)</big><a class="headerlink" href="#rados_object_list_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Get cursor handle pointing to the <em>beginning</em> of a pool.</p>
<p>This is an opaque handle pointing to the start of a pool. It must be released with rados_object_list_cursor_free().</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>handle for the pool, NULL on error (pool does not exist) </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: ioctx for the pool </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_object_list_end">
<span class="target" id="librados_8h_1a796c912c2b8dfc01ee29a1a6c6be3a1d"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> <a class="reference internal" href="#rados_object_list_cursor" title="rados_object_list_cursor">rados_object_list_cursor</a> <tt class="descname">rados_object_list_end</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em><big>)</big><a class="headerlink" href="#rados_object_list_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Get cursor handle pointing to the <em>end</em> of a pool.</p>
<p>This is an opaque handle pointing to the start of a pool. It must be released with rados_object_list_cursor_free().</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>handle for the pool, NULL on error (pool does not exist) </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: ioctx for the pool </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_object_list_is_end">
<span class="target" id="librados_8h_1a6a33505dae2e80dfd4490c0844e0e6fa"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_object_list_is_end</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_object_list_cursor" title="rados_object_list_cursor">rados_object_list_cursor</a><em>&nbsp;cur</em><big>)</big><a class="headerlink" href="#rados_object_list_is_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a cursor has reached the end of a pool</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>1 if the cursor has reached the end of the pool, 0 otherwise </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: ioctx </li>
<li><tt class="docutils literal"><span class="pre">cur</span></tt>: cursor </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_object_list_cursor_free">
<span class="target" id="librados_8h_1a8cc7059044982ff45cba5d2c5e1dc7b9"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_object_list_cursor_free</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_object_list_cursor" title="rados_object_list_cursor">rados_object_list_cursor</a><em>&nbsp;cur</em><big>)</big><a class="headerlink" href="#rados_object_list_cursor_free" title="Permalink to this definition">¶</a></dt>
<dd><p>Release a cursor</p>
<p>Release a cursor. The handle may not be used after this point.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: ioctx </li>
<li><tt class="docutils literal"><span class="pre">cur</span></tt>: cursor </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_object_list_cursor_cmp">
<span class="target" id="librados_8h_1a802ac9d4131ed132af4c471a0a6a3960"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_object_list_cursor_cmp</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_object_list_cursor" title="rados_object_list_cursor">rados_object_list_cursor</a><em>&nbsp;lhs</em>, <a class="reference internal" href="#rados_object_list_cursor" title="rados_object_list_cursor">rados_object_list_cursor</a><em>&nbsp;rhs</em><big>)</big><a class="headerlink" href="#rados_object_list_cursor_cmp" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare two cursor positions</p>
<p>Compare two cursors, and indicate whether the first cursor precedes, matches, or follows the second.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>-1, 0, or 1 for lhs &lt; rhs, lhs == rhs, or lhs &gt; rhs </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: ioctx </li>
<li><tt class="docutils literal"><span class="pre">lhs</span></tt>: first cursor </li>
<li><tt class="docutils literal"><span class="pre">rhs</span></tt>: second cursor </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_object_list">
<span class="target" id="librados_8h_1ac3a07c5a22622012579cdf4630d92e14"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_object_list</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const <a class="reference internal" href="#rados_object_list_cursor" title="rados_object_list_cursor">rados_object_list_cursor</a><em>&nbsp;start</em>, const <a class="reference internal" href="#rados_object_list_cursor" title="rados_object_list_cursor">rados_object_list_cursor</a><em>&nbsp;finish</em>, const size_t<em>&nbsp;result_size</em>, const char *<em>&nbsp;filter_buf</em>, const size_t<em>&nbsp;filter_buf_len</em>, <a class="reference internal" href="#rados_object_list_item" title="rados_object_list_item">rados_object_list_item</a>  *<em>&nbsp;results</em>, <a class="reference internal" href="#rados_object_list_cursor" title="rados_object_list_cursor">rados_object_list_cursor</a> *<em>&nbsp;next</em><big>)</big><a class="headerlink" href="#rados_object_list" title="Permalink to this definition">¶</a></dt>
<dd><p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>the number of items set in the result array </dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_object_list_free">
<span class="target" id="librados_8h_1aba19a7cc9a7f89060220b3b1c0971070"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_object_list_free</tt><big>(</big>const size_t<em>&nbsp;result_size</em>, <a class="reference internal" href="#rados_object_list_item" title="rados_object_list_item">rados_object_list_item</a>  *<em>&nbsp;results</em><big>)</big><a class="headerlink" href="#rados_object_list_free" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="rados_object_list_slice">
<span class="target" id="librados_8h_1a6b85810b3e8c53eda7ecc71d2d89adeb"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_object_list_slice</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const <a class="reference internal" href="#rados_object_list_cursor" title="rados_object_list_cursor">rados_object_list_cursor</a><em>&nbsp;start</em>, const <a class="reference internal" href="#rados_object_list_cursor" title="rados_object_list_cursor">rados_object_list_cursor</a><em>&nbsp;finish</em>, const size_t<em>&nbsp;n</em>, const size_t<em>&nbsp;m</em>, <a class="reference internal" href="#rados_object_list_cursor" title="rados_object_list_cursor">rados_object_list_cursor</a> *<em>&nbsp;split_start</em>, <a class="reference internal" href="#rados_object_list_cursor" title="rados_object_list_cursor">rados_object_list_cursor</a> *<em>&nbsp;split_finish</em><big>)</big><a class="headerlink" href="#rados_object_list_slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain cursors delineating a subset of a range. Use this when you want to split up the work of iterating over the global namespace. Expected use case is when you are iterating in parallel, with <tt class="docutils literal"><span class="pre">m</span></tt> workers, and each worker taking an id <tt class="docutils literal"><span class="pre">n</span></tt>.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">start</span></tt>: start of the range to be sliced up (inclusive) </li>
<li><tt class="docutils literal"><span class="pre">finish</span></tt>: end of the range to be sliced up (exclusive) </li>
<li><tt class="docutils literal"><span class="pre">m</span></tt>: how many chunks to divide start-finish into </li>
<li><tt class="docutils literal"><span class="pre">n</span></tt>: which of the m chunks you would like to get cursors for </li>
<li><tt class="docutils literal"><span class="pre">split_start</span></tt>: cursor populated with start of the subrange (inclusive) </li>
<li><tt class="docutils literal"><span class="pre">split_finish</span></tt>: cursor populated with end of the subrange (exclusive) </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Snapshots</p>
<p>RADOS snapshots are based upon sequence numbers that form a snapshot context. They are pool-specific. The snapshot context consists of the current snapshot sequence number for a pool, and an array of sequence numbers at which snapshots were taken, in descending order. Whenever a snapshot is created or deleted, the snapshot sequence number for the pool is increased. To add a new snapshot, the new snapshot sequence number must be increased and added to the snapshot context.</p>
<p>There are two ways to manage these snapshot contexts:<ol class="arabic simple">
<li>within the RADOS cluster These are called pool snapshots, and store the snapshot context in the OSDMap. These represent a snapshot of all the objects in a pool.</li>
<li>within the RADOS clients These are called self-managed snapshots, and push the responsibility for keeping track of the snapshot context to the clients. For every write, the client must send the snapshot context. In librados, this is accomplished with rados_selfmanaged_snap_set_write_ctx(). These are more difficult to manage, but are restricted to specific objects instead of applying to an entire pool. </li>
</ol>
</p>
<dl class="function">
<dt id="rados_ioctx_snap_create">
<span class="target" id="librados_8h_1ad51eaaea0ff8775386cb46e8d3482461"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_ioctx_snap_create</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;snapname</em><big>)</big><a class="headerlink" href="#rados_ioctx_snap_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a pool-wide snapshot</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool to snapshot </li>
<li><tt class="docutils literal"><span class="pre">snapname</span></tt>: the name of the snapshot </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_snap_remove">
<span class="target" id="librados_8h_1aa7f436d59ceab1779a342770dd33816b"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_ioctx_snap_remove</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;snapname</em><big>)</big><a class="headerlink" href="#rados_ioctx_snap_remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a pool snapshot</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool to delete the snapshot from </li>
<li><tt class="docutils literal"><span class="pre">snapname</span></tt>: which snapshot to delete </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_snap_rollback">
<span class="target" id="librados_8h_1a32f26dfcf00f7d5ad2ece4bea0e549b9"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_ioctx_snap_rollback</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, const char *<em>&nbsp;snapname</em><big>)</big><a class="headerlink" href="#rados_ioctx_snap_rollback" title="Permalink to this definition">¶</a></dt>
<dd><p>Rollback an object to a pool snapshot</p>
<p>The contents of the object will be the same as when the snapshot was taken.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool in which the object is stored </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: the name of the object to rollback </li>
<li><tt class="docutils literal"><span class="pre">snapname</span></tt>: which snapshot to rollback to </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_rollback">
<span class="target" id="librados_8h_1aba0559b2cf1d82b9527507788a994f78"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_rollback</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, const char *<em>&nbsp;snapname</em><big>)</big><a class="headerlink" href="#rados_rollback" title="Permalink to this definition">¶</a></dt>
<dd><p><dl class="docutils">
<dt><strong>Warning</strong></dt>
<dd>Deprecated: Use rados_ioctx_snap_rollback() instead </dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_snap_set_read">
<span class="target" id="librados_8h_1ac0952bef2b12373b2cb7c86d59131fc9"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_ioctx_snap_set_read</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a><em>&nbsp;snap</em><big>)</big><a class="headerlink" href="#rados_ioctx_snap_set_read" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the snapshot from which reads are performed.</p>
<p>Subsequent reads will return data as it was at the time of that snapshot.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the io context to change </li>
<li><tt class="docutils literal"><span class="pre">snap</span></tt>: the id of the snapshot to set, or LIBRADOS_SNAP_HEAD for no snapshot (i.e. normal operation) </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_selfmanaged_snap_create">
<span class="target" id="librados_8h_1a0c1349c0fa36033abac30052bee2a8f3"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_ioctx_selfmanaged_snap_create</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a> *<em>&nbsp;snapid</em><big>)</big><a class="headerlink" href="#rados_ioctx_selfmanaged_snap_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Allocate an ID for a self-managed snapshot</p>
<p>Get a unique ID to put in the snaphot context to create a snapshot. A clone of an object is not created until a write with the new snapshot context is completed.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool in which the snapshot will exist </li>
<li><tt class="docutils literal"><span class="pre">snapid</span></tt>: where to store the newly allocated snapshot ID </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_ioctx_selfmanaged_snap_create">
<span class="target" id="librados_8h_1aa86ae909fb281b2c349782c2443a7ee0"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_aio_ioctx_selfmanaged_snap_create</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a> *<em>&nbsp;snapid</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em><big>)</big><a class="headerlink" href="#rados_aio_ioctx_selfmanaged_snap_create" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="rados_ioctx_selfmanaged_snap_remove">
<span class="target" id="librados_8h_1a82b319c2e959e354e9f4065111b3451d"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_ioctx_selfmanaged_snap_remove</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a><em>&nbsp;snapid</em><big>)</big><a class="headerlink" href="#rados_ioctx_selfmanaged_snap_remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a self-managed snapshot</p>
<p>This increases the snapshot sequence number, which will cause snapshots to be removed lazily.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool in which the snapshot will exist </li>
<li><tt class="docutils literal"><span class="pre">snapid</span></tt>: where to store the newly allocated snapshot ID </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_ioctx_selfmanaged_snap_remove">
<span class="target" id="librados_8h_1a93c13b4a0705e57c8d1f0dd122c216fa"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_aio_ioctx_selfmanaged_snap_remove</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a><em>&nbsp;snapid</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em><big>)</big><a class="headerlink" href="#rados_aio_ioctx_selfmanaged_snap_remove" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="rados_ioctx_selfmanaged_snap_rollback">
<span class="target" id="librados_8h_1ada1171cf52b6b37571cc5d8519da489b"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_ioctx_selfmanaged_snap_rollback</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a><em>&nbsp;snapid</em><big>)</big><a class="headerlink" href="#rados_ioctx_selfmanaged_snap_rollback" title="Permalink to this definition">¶</a></dt>
<dd><p>Rollback an object to a self-managed snapshot</p>
<p>The contents of the object will be the same as when the snapshot was taken.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool in which the object is stored </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: the name of the object to rollback </li>
<li><tt class="docutils literal"><span class="pre">snapid</span></tt>: which snapshot to rollback to </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_selfmanaged_snap_set_write_ctx">
<span class="target" id="librados_8h_1a167b88a0cccb06c553e786cf1190ba22"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_ioctx_selfmanaged_snap_set_write_ctx</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a><em>&nbsp;seq</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a> *<em>&nbsp;snaps</em>, int<em>&nbsp;num_snaps</em><big>)</big><a class="headerlink" href="#rados_ioctx_selfmanaged_snap_set_write_ctx" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the snapshot context for use when writing to objects</p>
<p>This is stored in the io context, and applies to all future writes.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Return</strong></dt>
<dd>-EINVAL if snaps are not in descending order </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the io context to change </li>
<li><tt class="docutils literal"><span class="pre">seq</span></tt>: the newest snapshot sequence number for the pool </li>
<li><tt class="docutils literal"><span class="pre">snaps</span></tt>: array of snapshots in sorted by descending id </li>
<li><tt class="docutils literal"><span class="pre">num_snaps</span></tt>: how many snaphosts are in the snaps array </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_snap_list">
<span class="target" id="librados_8h_1a07cbdeb89d3bb57712e2efd9a276b216"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_ioctx_snap_list</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a> *<em>&nbsp;snaps</em>, int<em>&nbsp;maxlen</em><big>)</big><a class="headerlink" href="#rados_ioctx_snap_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List all the ids of pool snapshots</p>
<p>If the output array does not have enough space to fit all the snapshots, -ERANGE is returned and the caller should retry with a larger array.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>number of snapshots on success, negative error code on failure </dd>
<dt><strong>Return</strong></dt>
<dd>-ERANGE is returned if the snaps array is too short </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool to read from </li>
<li><tt class="docutils literal"><span class="pre">snaps</span></tt>: where to store the results </li>
<li><tt class="docutils literal"><span class="pre">maxlen</span></tt>: the number of rados_snap_t that fit in the snaps array </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_snap_lookup">
<span class="target" id="librados_8h_1a0e3605c1e6ec7e1f74d89e6f5cb6c780"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_ioctx_snap_lookup</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;name</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a> *<em>&nbsp;id</em><big>)</big><a class="headerlink" href="#rados_ioctx_snap_lookup" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the id of a pool snapshot</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool to read from </li>
<li><tt class="docutils literal"><span class="pre">name</span></tt>: the snapshot to find </li>
<li><tt class="docutils literal"><span class="pre">id</span></tt>: where to store the result </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_snap_get_name">
<span class="target" id="librados_8h_1a5c4dd3bc1af3e693559cdd77677d0367"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_ioctx_snap_get_name</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a><em>&nbsp;id</em>, char *<em>&nbsp;name</em>, int<em>&nbsp;maxlen</em><big>)</big><a class="headerlink" href="#rados_ioctx_snap_get_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the name of a pool snapshot</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Return</strong></dt>
<dd>-ERANGE if the name array is too small </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool to read from </li>
<li><tt class="docutils literal"><span class="pre">id</span></tt>: the snapshot to find </li>
<li><tt class="docutils literal"><span class="pre">name</span></tt>: where to store the result </li>
<li><tt class="docutils literal"><span class="pre">maxlen</span></tt>: the size of the name array </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_ioctx_snap_get_stamp">
<span class="target" id="librados_8h_1a43e4b3c47a04540b9dae9526f51446b2"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_ioctx_snap_get_stamp</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_snap_t" title="rados_snap_t">rados_snap_t</a><em>&nbsp;id</em>, time_t *<em>&nbsp;t</em><big>)</big><a class="headerlink" href="#rados_ioctx_snap_get_stamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Find when a pool snapshot occurred</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool the snapshot was taken in </li>
<li><tt class="docutils literal"><span class="pre">id</span></tt>: the snapshot to lookup </li>
<li><tt class="docutils literal"><span class="pre">t</span></tt>: where to store the result </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Synchronous I/O</p>
<p>Writes are replicated to a number of OSDs based on the configuration of the pool they are in. These write functions block until data is in memory on all replicas of the object they&#8217;re writing to - they are equivalent to doing the corresponding asynchronous write, and the calling rados_ioctx_wait_for_complete(). For greater data safety, use the asynchronous functions and rados_aio_wait_for_safe(). </p>
<dl class="function">
<dt id="rados_get_last_version">
<span class="target" id="librados_8h_1af03c0d22c25c1473d29bc418a16f2131"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> uint64_t <tt class="descname">rados_get_last_version</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em><big>)</big><a class="headerlink" href="#rados_get_last_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the version of the last object read or written to.</p>
<p>This exposes the internal version number of the last object read or written via this io context</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>last read or written object version </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the io context to check </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write">
<span class="target" id="librados_8h_1a6c14a0314a6bed507dd815183598376b"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_write</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, const char *<em>&nbsp;buf</em>, size_t<em>&nbsp;len</em>, uint64_t<em>&nbsp;off</em><big>)</big><a class="headerlink" href="#rados_write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write <em>len</em> bytes from <em>buf</em> into the <em>oid</em> object, starting at offset <em>off</em>. The value of <em>len</em> must be &lt;= UINT_MAX/2.</p>
<p><dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>This will never return a positive value not equal to len. </dd>
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the io context in which the write will occur </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: name of the object </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: data to write </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: length of the data, in bytes </li>
<li><tt class="docutils literal"><span class="pre">off</span></tt>: byte offset in the object to begin writing at </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_full">
<span class="target" id="librados_8h_1a8dd9ea7a01a033f6d41ed4af3c801b02"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_write_full</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, const char *<em>&nbsp;buf</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_write_full" title="Permalink to this definition">¶</a></dt>
<dd><p>Write <em>len</em> bytes from <em>buf</em> into the <em>oid</em> object. The value of <em>len</em> must be &lt;= UINT_MAX/2.</p>
<p>The object is filled with the provided data. If the object exists, it is atomically truncated and then written.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the io context in which the write will occur </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: name of the object </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: data to write </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: length of the data, in bytes </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_writesame">
<span class="target" id="librados_8h_1a7ec1a7b675f1253764ca1b668f84418d"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_writesame</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, const char *<em>&nbsp;buf</em>, size_t<em>&nbsp;data_len</em>, size_t<em>&nbsp;write_len</em>, uint64_t<em>&nbsp;off</em><big>)</big><a class="headerlink" href="#rados_writesame" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the same <em>data_len</em> bytes from <em>buf</em> multiple times into the <em>oid</em> object. <em>write_len</em> bytes are written in total, which must be a multiple of <em>data_len</em>. The value of <em>write_len</em> and <em>data_len</em> must be &lt;= UINT_MAX/2.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the io context in which the write will occur </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: name of the object </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: data to write </li>
<li><tt class="docutils literal"><span class="pre">data_len</span></tt>: length of the data, in bytes </li>
<li><tt class="docutils literal"><span class="pre">write_len</span></tt>: the total number of bytes to write </li>
<li><tt class="docutils literal"><span class="pre">off</span></tt>: byte offset in the object to begin writing at </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_append">
<span class="target" id="librados_8h_1a540fd1ea20ff7c54bab80f240fcc7e4f"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_append</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, const char *<em>&nbsp;buf</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_append" title="Permalink to this definition">¶</a></dt>
<dd><p>Append <em>len</em> bytes from <em>buf</em> into the <em>oid</em> object. The value of <em>len</em> must be &lt;= UINT_MAX/2.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context to operate in </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: the name of the object </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: the data to append </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: length of buf (in bytes) </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_read">
<span class="target" id="librados_8h_1adba16f73ecb0aa12ed9773e2faa2aeef"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_read</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, char *<em>&nbsp;buf</em>, size_t<em>&nbsp;len</em>, uint64_t<em>&nbsp;off</em><big>)</big><a class="headerlink" href="#rados_read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read data from an object</p>
<p>The io context determines the snapshot to read from, if any was set by rados_ioctx_snap_set_read().</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>number of bytes read on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context in which to perform the read </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: the name of the object to read from </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: where to store the results </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: the number of bytes to read </li>
<li><tt class="docutils literal"><span class="pre">off</span></tt>: the offset to start reading from in the object </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_checksum">
<span class="target" id="librados_8h_1a9ae5437fd6a2026be264dffda9b4fc89"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_checksum</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, <a class="reference internal" href="#rados_checksum_type_t" title="rados_checksum_type_t">rados_checksum_type_t</a><em>&nbsp;type</em>, const char *<em>&nbsp;init_value</em>, size_t<em>&nbsp;init_value_len</em>, size_t<em>&nbsp;len</em>, uint64_t<em>&nbsp;off</em>, size_t<em>&nbsp;chunk_size</em>, char *<em>&nbsp;pchecksum</em>, size_t<em>&nbsp;checksum_len</em><big>)</big><a class="headerlink" href="#rados_checksum" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute checksum from object data</p>
<p>The io context determines the snapshot to checksum, if any was set by rados_ioctx_snap_set_read(). The length of the init_value and resulting checksum are dependent upon the checksum type:</p>
<p>XXHASH64: le64 XXHASH32: le32 CRC32C: le32</p>
<p>The checksum result is encoded the following manner:</p>
<p>le32 num_checksum_chunks { leXX checksum for chunk (where XX = appropriate size for the checksum type) } * num_checksum_chunks</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context in which to perform the checksum </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: the name of the object to checksum </li>
<li><tt class="docutils literal"><span class="pre">type</span></tt>: the checksum algorithm to utilize </li>
<li><tt class="docutils literal"><span class="pre">init_value</span></tt>: the init value for the algorithm </li>
<li><tt class="docutils literal"><span class="pre">init_value_len</span></tt>: the length of the init value </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: the number of bytes to checksum </li>
<li><tt class="docutils literal"><span class="pre">off</span></tt>: the offset to start checksuming in the object </li>
<li><tt class="docutils literal"><span class="pre">chunk_size</span></tt>: optional length-aligned chunk size for checksums </li>
<li><tt class="docutils literal"><span class="pre">pchecksum</span></tt>: where to store the checksum result </li>
<li><tt class="docutils literal"><span class="pre">checksum_len</span></tt>: the number of bytes available for the result </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_remove">
<span class="target" id="librados_8h_1a7f798a662c135887fa8d2c615f7ddb24"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_remove</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em><big>)</big><a class="headerlink" href="#rados_remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete an object</p>
<p><dl class="docutils">
<dt><strong>Note</strong></dt>
<dd>This does not delete any snapshots of the object.</dd>
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool to delete the object from </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: the name of the object to delete </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_trunc">
<span class="target" id="librados_8h_1a9d097d3def2362959a3af634076977ee"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_trunc</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, uint64_t<em>&nbsp;size</em><big>)</big><a class="headerlink" href="#rados_trunc" title="Permalink to this definition">¶</a></dt>
<dd><p>Resize an object</p>
<p>If this enlarges the object, the new area is logically filled with zeroes. If this shrinks the object, the excess data is removed.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context in which to truncate </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: the name of the object </li>
<li><tt class="docutils literal"><span class="pre">size</span></tt>: the new size of the object in bytes </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_cmpext">
<span class="target" id="librados_8h_1ac7faf7936a1af89dbd078fe3a8eaa22c"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_cmpext</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, const char *<em>&nbsp;cmp_buf</em>, size_t<em>&nbsp;cmp_len</em>, uint64_t<em>&nbsp;off</em><big>)</big><a class="headerlink" href="#rados_cmpext" title="Permalink to this definition">¶</a></dt>
<dd><p>Compare an on-disk object range with a buffer</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure, (-MAX_ERRNO - mismatch_off) on mismatch </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context in which to perform the comparison </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: name of the object </li>
<li><tt class="docutils literal"><span class="pre">cmp_buf</span></tt>: buffer containing bytes to be compared with object contents </li>
<li><tt class="docutils literal"><span class="pre">cmp_len</span></tt>: length to compare and size of  in bytes </li>
<li><tt class="docutils literal"><span class="pre">off</span></tt>: object byte offset at which to start the comparison </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Xattrs</p>
<p>Extended attributes are stored as extended attributes on the files representing an object on the OSDs. Thus, they have the same limitations as the underlying filesystem. On ext4, this means that the total data stored in xattrs cannot exceed 4KB. </p>
<dl class="function">
<dt id="rados_getxattr">
<span class="target" id="librados_8h_1a1a42661f155dfdfc25573904f9fe8749"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_getxattr</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, const char *<em>&nbsp;name</em>, char *<em>&nbsp;buf</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_getxattr" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the value of an extended attribute on an object.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>length of xattr value on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context in which the attribute is read </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: name of the object </li>
<li><tt class="docutils literal"><span class="pre">name</span></tt>: which extended attribute to read </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: where to store the result </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: size of buf in bytes </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_setxattr">
<span class="target" id="librados_8h_1a68c320a11946a5e3de8a07f1f63b0663"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_setxattr</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, const char *<em>&nbsp;name</em>, const char *<em>&nbsp;buf</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_setxattr" title="Permalink to this definition">¶</a></dt>
<dd><p>Set an extended attribute on an object.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context in which xattr is set </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: name of the object </li>
<li><tt class="docutils literal"><span class="pre">name</span></tt>: which extended attribute to set </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: what to store in the xattr </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: the number of bytes in buf </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_rmxattr">
<span class="target" id="librados_8h_1a3ce9090dfd315a5489e66f6e1babe4ed"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_rmxattr</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, const char *<em>&nbsp;name</em><big>)</big><a class="headerlink" href="#rados_rmxattr" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete an extended attribute from an object.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context in which to delete the xattr </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: the name of the object </li>
<li><tt class="docutils literal"><span class="pre">name</span></tt>: which xattr to delete </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_getxattrs">
<span class="target" id="librados_8h_1a3cd7a2f9aabdff37d3feaba25adb6001"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_getxattrs</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, <a class="reference internal" href="#rados_xattrs_iter_t" title="rados_xattrs_iter_t">rados_xattrs_iter_t</a> *<em>&nbsp;iter</em><big>)</big><a class="headerlink" href="#rados_getxattrs" title="Permalink to this definition">¶</a></dt>
<dd><p>Start iterating over xattrs on an object.</p>
<p><dl class="docutils">
<dt><strong>Post</strong></dt>
<dd>iter is a valid iterator</dd>
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context in which to list xattrs </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: name of the object </li>
<li><tt class="docutils literal"><span class="pre">iter</span></tt>: where to store the iterator </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_getxattrs_next">
<span class="target" id="librados_8h_1ab9fe9f160d6d11441ceb4570d56c8630"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_getxattrs_next</tt><big>(</big><a class="reference internal" href="#rados_xattrs_iter_t" title="rados_xattrs_iter_t">rados_xattrs_iter_t</a><em>&nbsp;iter</em>, const char **<em>&nbsp;name</em>, const char **<em>&nbsp;val</em>, size_t *<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_getxattrs_next" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the next xattr on the object</p>
<p><dl class="docutils">
<dt><strong>Pre</strong></dt>
<dd>iter is a valid iterator</dd>
<dt><strong>Post</strong></dt>
<dd>name is the NULL-terminated name of the next xattr, and val contains the value of the xattr, which is of length len. If the end of the list has been reached, name and val are NULL, and len is 0.</dd>
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">iter</span></tt>: iterator to advance </li>
<li><tt class="docutils literal"><span class="pre">name</span></tt>: where to store the name of the next xattr </li>
<li><tt class="docutils literal"><span class="pre">val</span></tt>: where to store the value of the next xattr </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: the number of bytes in val </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_getxattrs_end">
<span class="target" id="librados_8h_1abbf5f8bb4a12a188bfa122d5ec030824"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_getxattrs_end</tt><big>(</big><a class="reference internal" href="#rados_xattrs_iter_t" title="rados_xattrs_iter_t">rados_xattrs_iter_t</a><em>&nbsp;iter</em><big>)</big><a class="headerlink" href="#rados_getxattrs_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the xattr iterator.</p>
<p>iter should not be used after this is called.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">iter</span></tt>: the iterator to close </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Asynchronous Xattrs</p>
<p>Extended attributes are stored as extended attributes on the files representing an object on the OSDs. Thus, they have the same limitations as the underlying filesystem. On ext4, this means that the total data stored in xattrs cannot exceed 4KB. </p>
<dl class="function">
<dt id="rados_aio_getxattr">
<span class="target" id="librados_8h_1abc37139524577dc3e9b881fdcc1d80d2"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_getxattr</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, const char *<em>&nbsp;name</em>, char *<em>&nbsp;buf</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_aio_getxattr" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronously get the value of an extended attribute on an object.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>length of xattr value on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context in which the attribute is read </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: name of the object </li>
<li><tt class="docutils literal"><span class="pre">completion</span></tt>: what to do when the getxattr completes </li>
<li><tt class="docutils literal"><span class="pre">name</span></tt>: which extended attribute to read </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: where to store the result </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: size of buf in bytes </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_setxattr">
<span class="target" id="librados_8h_1aa876ebd1977efb45fa1be1a37b7c1ffd"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_setxattr</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, const char *<em>&nbsp;name</em>, const char *<em>&nbsp;buf</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_aio_setxattr" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronously set an extended attribute on an object.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context in which xattr is set </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: name of the object </li>
<li><tt class="docutils literal"><span class="pre">completion</span></tt>: what to do when the setxattr completes </li>
<li><tt class="docutils literal"><span class="pre">name</span></tt>: which extended attribute to set </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: what to store in the xattr </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: the number of bytes in buf </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_rmxattr">
<span class="target" id="librados_8h_1a53971c5fff31bdd689efdbb08ef8bbfd"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_rmxattr</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, const char *<em>&nbsp;name</em><big>)</big><a class="headerlink" href="#rados_aio_rmxattr" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronously delete an extended attribute from an object.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context in which to delete the xattr </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: the name of the object </li>
<li><tt class="docutils literal"><span class="pre">completion</span></tt>: what to do when the rmxattr completes </li>
<li><tt class="docutils literal"><span class="pre">name</span></tt>: which xattr to delete </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_getxattrs">
<span class="target" id="librados_8h_1a409fa5b00c3bd63d5b04e0df50f8eace"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_getxattrs</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, <a class="reference internal" href="#rados_xattrs_iter_t" title="rados_xattrs_iter_t">rados_xattrs_iter_t</a> *<em>&nbsp;iter</em><big>)</big><a class="headerlink" href="#rados_aio_getxattrs" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronously start iterating over xattrs on an object.</p>
<p><dl class="docutils">
<dt><strong>Post</strong></dt>
<dd>iter is a valid iterator</dd>
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context in which to list xattrs </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: name of the object </li>
<li><tt class="docutils literal"><span class="pre">iter</span></tt>: where to store the iterator </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Hints</p>
<dl class="function">
<dt id="rados_set_alloc_hint">
<span class="target" id="librados_8h_1abd78efb9532478e17b10ccbc971b91e7"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_set_alloc_hint</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, uint64_t<em>&nbsp;expected_object_size</em>, uint64_t<em>&nbsp;expected_write_size</em><big>)</big><a class="headerlink" href="#rados_set_alloc_hint" title="Permalink to this definition">¶</a></dt>
<dd><p>Set allocation hint for an object</p>
<p>This is an advisory operation, it will always succeed (as if it was submitted with a LIBRADOS_OP_FLAG_FAILOK flag set) and is not guaranteed to do anything on the backend.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool the object is in </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: the name of the object </li>
<li><tt class="docutils literal"><span class="pre">expected_object_size</span></tt>: expected size of the object, in bytes </li>
<li><tt class="docutils literal"><span class="pre">expected_write_size</span></tt>: expected size of writes to the object, in bytes </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_set_alloc_hint2">
<span class="target" id="librados_8h_1a9708cc7393eb0bd1dd4c3d1e0ade2bac"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_set_alloc_hint2</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, uint64_t<em>&nbsp;expected_object_size</em>, uint64_t<em>&nbsp;expected_write_size</em>, uint32_t<em>&nbsp;flags</em><big>)</big><a class="headerlink" href="#rados_set_alloc_hint2" title="Permalink to this definition">¶</a></dt>
<dd><p>Set allocation hint for an object</p>
<p>This is an advisory operation, it will always succeed (as if it was submitted with a LIBRADOS_OP_FLAG_FAILOK flag set) and is not guaranteed to do anything on the backend.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool the object is in </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: the name of the object </li>
<li><tt class="docutils literal"><span class="pre">expected_object_size</span></tt>: expected size of the object, in bytes </li>
<li><tt class="docutils literal"><span class="pre">expected_write_size</span></tt>: expected size of writes to the object, in bytes </li>
<li><tt class="docutils literal"><span class="pre">flags</span></tt>: hints about future IO patterns </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Object Operations</p>
<p>A single rados operation can do multiple operations on one object atomicly. The whole operation will suceed or fail, and no partial results will be visible.</p>
<p>Operations may be either reads, which can return data, or writes, which cannot. The effects of writes are applied and visible all at once, so an operation that sets an xattr and then checks its value will not see the updated value. </p>
<dl class="function">
<dt id="rados_create_write_op">
<span class="target" id="librados_8h_1af1a3dddf1756d6ffdb48417b63cc72d6"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> <a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a> <tt class="descname">rados_create_write_op</tt><big>(</big>void<big>)</big><a class="headerlink" href="#rados_create_write_op" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new rados_write_op_t write operation. This will store all actions to be performed atomically. You must call rados_release_write_op when you are finished with it.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>non-NULL on success, NULL on memory allocation error. </dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_release_write_op">
<span class="target" id="librados_8h_1a4fe6fc320c2658c6c3820a2d0e39fb2d"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_release_write_op</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em><big>)</big><a class="headerlink" href="#rados_release_write_op" title="Permalink to this definition">¶</a></dt>
<dd><p>Free a rados_write_op_t, must be called when you&#8217;re done with it. <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to deallocate, created with rados_create_write_op </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_set_flags">
<span class="target" id="librados_8h_1a3cd5c699edf254c1d35f05276a1c8c6f"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_set_flags</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, int<em>&nbsp;flags</em><big>)</big><a class="headerlink" href="#rados_write_op_set_flags" title="Permalink to this definition">¶</a></dt>
<dd><p>Set flags for the last operation added to this write_op. At least one op must have been added to the write_op. <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">flags</span></tt>: see librados.h constants beginning with LIBRADOS_OP_FLAG </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_assert_exists">
<span class="target" id="librados_8h_1a459637c40a24a01ba53f9d74d74c3d25"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_assert_exists</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em><big>)</big><a class="headerlink" href="#rados_write_op_assert_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that the object exists before writing <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to add this action to </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_assert_version">
<span class="target" id="librados_8h_1a3cbd03eef7f3b8004cabdb96d0ea8e1b"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_assert_version</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, uint64_t<em>&nbsp;ver</em><big>)</big><a class="headerlink" href="#rados_write_op_assert_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that the object exists and that its internal version number is equal to &#8220;ver&#8221; before writing. &#8220;ver&#8221; should be a version number previously obtained with rados_get_last_version().<ul class="simple">
<li>If the object&#8217;s version is greater than the asserted version then rados_write_op_operate will return -ERANGE instead of executing the op.</li>
<li>If the object&#8217;s version is less than the asserted version then rados_write_op_operate will return -EOVERFLOW instead of executing the op. <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">ver</span></tt>: object version number </li>
</ul>
</dd>
</dl>
</li>
</ul>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_cmpext">
<span class="target" id="librados_8h_1a1304f58547769028259dee8e750fb744"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_cmpext</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, const char *<em>&nbsp;cmp_buf</em>, size_t<em>&nbsp;cmp_len</em>, uint64_t<em>&nbsp;off</em>, int *<em>&nbsp;prval</em><big>)</big><a class="headerlink" href="#rados_write_op_cmpext" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that given object range (extent) satisfies comparison.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">cmp_buf</span></tt>: buffer containing bytes to be compared with object contents </li>
<li><tt class="docutils literal"><span class="pre">cmp_len</span></tt>: length to compare and size of  in bytes </li>
<li><tt class="docutils literal"><span class="pre">off</span></tt>: object byte offset at which to start the comparison </li>
<li><tt class="docutils literal"><span class="pre">prval</span></tt>: returned result of comparison, 0 on success, negative error code on failure, (-MAX_ERRNO - mismatch_off) on mismatch </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_cmpxattr">
<span class="target" id="librados_8h_1afbb02f70537541e97839f41d8c5966cb"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_cmpxattr</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, const char *<em>&nbsp;name</em>, uint8_t<em>&nbsp;comparison_operator</em>, const char *<em>&nbsp;value</em>, size_t<em>&nbsp;value_len</em><big>)</big><a class="headerlink" href="#rados_write_op_cmpxattr" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that given xattr satisfies comparison. If the comparison is not satisfied, the return code of the operation will be -ECANCELED <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">name</span></tt>: name of the xattr to look up </li>
<li><tt class="docutils literal"><span class="pre">comparison_operator</span></tt>: currently undocumented, look for LIBRADOS_CMPXATTR_OP_EQ in librados.h </li>
<li><tt class="docutils literal"><span class="pre">value</span></tt>: buffer to compare actual xattr value to </li>
<li><tt class="docutils literal"><span class="pre">value_len</span></tt>: length of buffer to compare actual xattr value to </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_omap_cmp">
<span class="target" id="librados_8h_1ae438d976007b3416d0bbc730d855f645"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_omap_cmp</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, const char *<em>&nbsp;key</em>, uint8_t<em>&nbsp;comparison_operator</em>, const char *<em>&nbsp;val</em>, size_t<em>&nbsp;val_len</em>, int *<em>&nbsp;prval</em><big>)</big><a class="headerlink" href="#rados_write_op_omap_cmp" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that the an omap value satisfies a comparison, with the supplied value on the right hand side (i.e. for OP_LT, the comparison is actual_value &lt; value.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">key</span></tt>: which omap value to compare </li>
<li><tt class="docutils literal"><span class="pre">comparison_operator</span></tt>: one of LIBRADOS_CMPXATTR_OP_EQ, LIBRADOS_CMPXATTR_OP_LT, or LIBRADOS_CMPXATTR_OP_GT </li>
<li><tt class="docutils literal"><span class="pre">val</span></tt>: value to compare with </li>
<li><tt class="docutils literal"><span class="pre">val_len</span></tt>: length of value in bytes </li>
<li><tt class="docutils literal"><span class="pre">prval</span></tt>: where to store the return value from this action </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_setxattr">
<span class="target" id="librados_8h_1acc58681b93def974e40fe49a05a291d7"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_setxattr</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, const char *<em>&nbsp;name</em>, const char *<em>&nbsp;value</em>, size_t<em>&nbsp;value_len</em><big>)</big><a class="headerlink" href="#rados_write_op_setxattr" title="Permalink to this definition">¶</a></dt>
<dd><p>Set an xattr <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">name</span></tt>: name of the xattr </li>
<li><tt class="docutils literal"><span class="pre">value</span></tt>: buffer to set xattr to </li>
<li><tt class="docutils literal"><span class="pre">value_len</span></tt>: length of buffer to set xattr to </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_rmxattr">
<span class="target" id="librados_8h_1a99388a92b5c0de558fcf994683fe4303"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_rmxattr</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, const char *<em>&nbsp;name</em><big>)</big><a class="headerlink" href="#rados_write_op_rmxattr" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove an xattr <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">name</span></tt>: name of the xattr to remove </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_create">
<span class="target" id="librados_8h_1a871253b998c0bf4a0d68f31b51e90b59"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_create</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, int<em>&nbsp;exclusive</em>, const char *<em>&nbsp;category</em><big>)</big><a class="headerlink" href="#rados_write_op_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the object <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">exclusive</span></tt>: set to either LIBRADOS_CREATE_EXCLUSIVE or LIBRADOS_CREATE_IDEMPOTENT will error if the object already exists. </li>
<li><tt class="docutils literal"><span class="pre">category</span></tt>: category string (DEPRECATED, HAS NO EFFECT) </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_write">
<span class="target" id="librados_8h_1a87fda9540d2afb70031cdc7bf884e6d0"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_write</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, const char *<em>&nbsp;buffer</em>, size_t<em>&nbsp;len</em>, uint64_t<em>&nbsp;offset</em><big>)</big><a class="headerlink" href="#rados_write_op_write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write to offset <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">offset</span></tt>: offset to write to </li>
<li><tt class="docutils literal"><span class="pre">buffer</span></tt>: bytes to write </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: length of buffer </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_write_full">
<span class="target" id="librados_8h_1afff830c06c309f4caff26edd976d362c"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_write_full</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, const char *<em>&nbsp;buffer</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_write_op_write_full" title="Permalink to this definition">¶</a></dt>
<dd><p>Write whole object, atomically replacing it. <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">buffer</span></tt>: bytes to write </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: length of buffer </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_writesame">
<span class="target" id="librados_8h_1ad5efc1f03719403a33c877440c2c27d3"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_writesame</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, const char *<em>&nbsp;buffer</em>, size_t<em>&nbsp;data_len</em>, size_t<em>&nbsp;write_len</em>, uint64_t<em>&nbsp;offset</em><big>)</big><a class="headerlink" href="#rados_write_op_writesame" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the same buffer multiple times <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">buffer</span></tt>: bytes to write </li>
<li><tt class="docutils literal"><span class="pre">data_len</span></tt>: length of buffer </li>
<li><tt class="docutils literal"><span class="pre">write_len</span></tt>: total number of bytes to write, as a multiple of  </li>
<li><tt class="docutils literal"><span class="pre">offset</span></tt>: offset to write to </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_append">
<span class="target" id="librados_8h_1a279d9af15f591158734f8937cc188011"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_append</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, const char *<em>&nbsp;buffer</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_write_op_append" title="Permalink to this definition">¶</a></dt>
<dd><p>Append to end of object. <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">buffer</span></tt>: bytes to write </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: length of buffer </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_remove">
<span class="target" id="librados_8h_1ab3c2aacf0028c76b91ef77ed1d3767b6"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_remove</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em><big>)</big><a class="headerlink" href="#rados_write_op_remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove object <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to add this action to </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_truncate">
<span class="target" id="librados_8h_1aaf7ed5ece0b071f94f82b54daffdaae5"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_truncate</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, uint64_t<em>&nbsp;offset</em><big>)</big><a class="headerlink" href="#rados_write_op_truncate" title="Permalink to this definition">¶</a></dt>
<dd><p>Truncate an object <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">offset</span></tt>: Offset to truncate to </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_zero">
<span class="target" id="librados_8h_1ae24820c042da2d7d18a0a08e87b9e4a0"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_zero</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, uint64_t<em>&nbsp;offset</em>, uint64_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_write_op_zero" title="Permalink to this definition">¶</a></dt>
<dd><p>Zero part of an object <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">offset</span></tt>: Offset to zero </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: length to zero </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_exec">
<span class="target" id="librados_8h_1a4a5e172333ae4886b913f8189a56209e"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_exec</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, const char *<em>&nbsp;cls</em>, const char *<em>&nbsp;method</em>, const char *<em>&nbsp;in_buf</em>, size_t<em>&nbsp;in_len</em>, int *<em>&nbsp;prval</em><big>)</big><a class="headerlink" href="#rados_write_op_exec" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute an OSD class method on an object See rados_exec() for general description.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">cls</span></tt>: the name of the class </li>
<li><tt class="docutils literal"><span class="pre">method</span></tt>: the name of the method </li>
<li><tt class="docutils literal"><span class="pre">in_buf</span></tt>: where to find input </li>
<li><tt class="docutils literal"><span class="pre">in_len</span></tt>: length of in_buf in bytes </li>
<li><tt class="docutils literal"><span class="pre">prval</span></tt>: where to store the return value from the method </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_omap_set">
<span class="target" id="librados_8h_1adfed001930bd8fa7baf874849b784a4d"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_omap_set</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, char const *const *<em>&nbsp;keys</em>, char const *const *<em>&nbsp;vals</em>, const size_t *<em>&nbsp;lens</em>, size_t<em>&nbsp;num</em><big>)</big><a class="headerlink" href="#rados_write_op_omap_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Set key/value pairs on an object</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">keys</span></tt>: array of null-terminated char arrays representing keys to set </li>
<li><tt class="docutils literal"><span class="pre">vals</span></tt>: array of pointers to values to set </li>
<li><tt class="docutils literal"><span class="pre">lens</span></tt>: array of lengths corresponding to each value </li>
<li><tt class="docutils literal"><span class="pre">num</span></tt>: number of key/value pairs to set </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_omap_rm_keys">
<span class="target" id="librados_8h_1ab67e77fa008171af93d6449f87451342"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_omap_rm_keys</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, char const *const *<em>&nbsp;keys</em>, size_t<em>&nbsp;keys_len</em><big>)</big><a class="headerlink" href="#rados_write_op_omap_rm_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove key/value pairs from an object</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">keys</span></tt>: array of null-terminated char arrays representing keys to remove </li>
<li><tt class="docutils literal"><span class="pre">keys_len</span></tt>: number of key/value pairs to remove </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_omap_clear">
<span class="target" id="librados_8h_1a3ccb37b35d552479d894897804532957"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_omap_clear</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em><big>)</big><a class="headerlink" href="#rados_write_op_omap_clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove all key/value pairs from an object</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to add this action to </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_set_alloc_hint">
<span class="target" id="librados_8h_1a10d567a2123f01032d653bfeae40dcc3"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_set_alloc_hint</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, uint64_t<em>&nbsp;expected_object_size</em>, uint64_t<em>&nbsp;expected_write_size</em><big>)</big><a class="headerlink" href="#rados_write_op_set_alloc_hint" title="Permalink to this definition">¶</a></dt>
<dd><p>Set allocation hint for an object</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">expected_object_size</span></tt>: expected size of the object, in bytes </li>
<li><tt class="docutils literal"><span class="pre">expected_write_size</span></tt>: expected size of writes to the object, in bytes </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_set_alloc_hint2">
<span class="target" id="librados_8h_1a099324b07bafcea221c8bddbd7e72c4b"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_write_op_set_alloc_hint2</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, uint64_t<em>&nbsp;expected_object_size</em>, uint64_t<em>&nbsp;expected_write_size</em>, uint32_t<em>&nbsp;flags</em><big>)</big><a class="headerlink" href="#rados_write_op_set_alloc_hint2" title="Permalink to this definition">¶</a></dt>
<dd><p>Set allocation hint for an object</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">expected_object_size</span></tt>: expected size of the object, in bytes </li>
<li><tt class="docutils literal"><span class="pre">expected_write_size</span></tt>: expected size of writes to the object, in bytes </li>
<li><tt class="docutils literal"><span class="pre">flags</span></tt>: hints about future IO patterns </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_operate">
<span class="target" id="librados_8h_1ad8ed722b0defa7d4f6f8bd7b2329680a"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_write_op_operate</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, <a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, time_t *<em>&nbsp;mtime</em>, int<em>&nbsp;flags</em><big>)</big><a class="headerlink" href="#rados_write_op_operate" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a write operation synchronously <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to perform </li>
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the ioctx that the object is in </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: the object id </li>
<li><tt class="docutils literal"><span class="pre">mtime</span></tt>: the time to set the mtime to, NULL for the current time </li>
<li><tt class="docutils literal"><span class="pre">flags</span></tt>: flags to apply to the entire operation (LIBRADOS_OPERATION_*) </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_write_op_operate2">
<span class="target" id="librados_8h_1abe8562ae793f79e6bf50ea936023efa6"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_write_op_operate2</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, <a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, struct timespec *<em>&nbsp;mtime</em>, int<em>&nbsp;flags</em><big>)</big><a class="headerlink" href="#rados_write_op_operate2" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a write operation synchronously <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to perform </li>
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the ioctx that the object is in </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: the object id </li>
<li><tt class="docutils literal"><span class="pre">mtime</span></tt>: the time to set the mtime to, NULL for the current time </li>
<li><tt class="docutils literal"><span class="pre">flags</span></tt>: flags to apply to the entire operation (LIBRADOS_OPERATION_*) </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_write_op_operate">
<span class="target" id="librados_8h_1a509289b47a1b11d70465cd5158731354"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_write_op_operate</tt><big>(</big><a class="reference internal" href="#rados_write_op_t" title="rados_write_op_t">rados_write_op_t</a><em>&nbsp;write_op</em>, <a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, const char *<em>&nbsp;oid</em>, time_t *<em>&nbsp;mtime</em>, int<em>&nbsp;flags</em><big>)</big><a class="headerlink" href="#rados_aio_write_op_operate" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a write operation asynchronously <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">write_op</span></tt>: operation to perform </li>
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the ioctx that the object is in </li>
<li><tt class="docutils literal"><span class="pre">completion</span></tt>: what to do when operation has been attempted </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: the object id </li>
<li><tt class="docutils literal"><span class="pre">mtime</span></tt>: the time to set the mtime to, NULL for the current time </li>
<li><tt class="docutils literal"><span class="pre">flags</span></tt>: flags to apply to the entire operation (LIBRADOS_OPERATION_*) </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_create_read_op">
<span class="target" id="librados_8h_1a36fb813c7253dd8af8ff063bc6101412"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> <a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a> <tt class="descname">rados_create_read_op</tt><big>(</big>void<big>)</big><a class="headerlink" href="#rados_create_read_op" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a new rados_read_op_t write operation. This will store all actions to be performed atomically. You must call rados_release_read_op when you are finished with it (after it completes, or you decide not to send it in the first place).</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>non-NULL on success, NULL on memory allocation error. </dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_release_read_op">
<span class="target" id="librados_8h_1a46da900e0e90ace24ffc63539f86241e"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_release_read_op</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em><big>)</big><a class="headerlink" href="#rados_release_read_op" title="Permalink to this definition">¶</a></dt>
<dd><p>Free a rados_read_op_t, must be called when you&#8217;re done with it. <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">read_op</span></tt>: operation to deallocate, created with rados_create_read_op </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_set_flags">
<span class="target" id="librados_8h_1afe7176da810543a5eb538222f942962f"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_read_op_set_flags</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, int<em>&nbsp;flags</em><big>)</big><a class="headerlink" href="#rados_read_op_set_flags" title="Permalink to this definition">¶</a></dt>
<dd><p>Set flags for the last operation added to this read_op. At least one op must have been added to the read_op. <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">flags</span></tt>: see librados.h constants beginning with LIBRADOS_OP_FLAG </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_assert_exists">
<span class="target" id="librados_8h_1a8cdac9f1af075afcd19dfcc7d7f7bfc8"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_read_op_assert_exists</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em><big>)</big><a class="headerlink" href="#rados_read_op_assert_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that the object exists before reading <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">read_op</span></tt>: operation to add this action to </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_assert_version">
<span class="target" id="librados_8h_1a2ff9a1cb23a586796efa7f7d91449643"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_read_op_assert_version</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, uint64_t<em>&nbsp;ver</em><big>)</big><a class="headerlink" href="#rados_read_op_assert_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that the object exists and that its internal version number is equal to &#8220;ver&#8221; before reading. &#8220;ver&#8221; should be a version number previously obtained with rados_get_last_version().<ul class="simple">
<li>If the object&#8217;s version is greater than the asserted version then rados_read_op_operate will return -ERANGE instead of executing the op.</li>
<li>If the object&#8217;s version is less than the asserted version then rados_read_op_operate will return -EOVERFLOW instead of executing the op. <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last">
<li><tt class="docutils literal"><span class="pre">read_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">ver</span></tt>: object version number </li>
</ul>
</dd>
</dl>
</li>
</ul>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_cmpext">
<span class="target" id="librados_8h_1a74b68be5015267e70715f1b9cbd7cab9"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_read_op_cmpext</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, const char *<em>&nbsp;cmp_buf</em>, size_t<em>&nbsp;cmp_len</em>, uint64_t<em>&nbsp;off</em>, int *<em>&nbsp;prval</em><big>)</big><a class="headerlink" href="#rados_read_op_cmpext" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that given object range (extent) satisfies comparison.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">read_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">cmp_buf</span></tt>: buffer containing bytes to be compared with object contents </li>
<li><tt class="docutils literal"><span class="pre">cmp_len</span></tt>: length to compare and size of  in bytes </li>
<li><tt class="docutils literal"><span class="pre">off</span></tt>: object byte offset at which to start the comparison </li>
<li><tt class="docutils literal"><span class="pre">prval</span></tt>: returned result of comparison, 0 on success, negative error code on failure, (-MAX_ERRNO - mismatch_off) on mismatch </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_cmpxattr">
<span class="target" id="librados_8h_1a3eb67a54e426d4d1ffc1b8f21c5cfce0"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_read_op_cmpxattr</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, const char *<em>&nbsp;name</em>, uint8_t<em>&nbsp;comparison_operator</em>, const char *<em>&nbsp;value</em>, size_t<em>&nbsp;value_len</em><big>)</big><a class="headerlink" href="#rados_read_op_cmpxattr" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that the an xattr satisfies a comparison If the comparison is not satisfied, the return code of the operation will be -ECANCELED <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">read_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">name</span></tt>: name of the xattr to look up </li>
<li><tt class="docutils literal"><span class="pre">comparison_operator</span></tt>: currently undocumented, look for LIBRADOS_CMPXATTR_OP_EQ in librados.h </li>
<li><tt class="docutils literal"><span class="pre">value</span></tt>: buffer to compare actual xattr value to </li>
<li><tt class="docutils literal"><span class="pre">value_len</span></tt>: length of buffer to compare actual xattr value to </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_getxattrs">
<span class="target" id="librados_8h_1abe53268cfc8f01c5208265391390acd7"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_read_op_getxattrs</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, <a class="reference internal" href="#rados_xattrs_iter_t" title="rados_xattrs_iter_t">rados_xattrs_iter_t</a> *<em>&nbsp;iter</em>, int *<em>&nbsp;prval</em><big>)</big><a class="headerlink" href="#rados_read_op_getxattrs" title="Permalink to this definition">¶</a></dt>
<dd><p>Start iterating over xattrs on an object.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">read_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">iter</span></tt>: where to store the iterator </li>
<li><tt class="docutils literal"><span class="pre">prval</span></tt>: where to store the return value of this action </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_omap_cmp">
<span class="target" id="librados_8h_1a9d9c8a790a67cc917da5b707f56b7b68"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_read_op_omap_cmp</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, const char *<em>&nbsp;key</em>, uint8_t<em>&nbsp;comparison_operator</em>, const char *<em>&nbsp;val</em>, size_t<em>&nbsp;val_len</em>, int *<em>&nbsp;prval</em><big>)</big><a class="headerlink" href="#rados_read_op_omap_cmp" title="Permalink to this definition">¶</a></dt>
<dd><p>Ensure that the an omap value satisfies a comparison, with the supplied value on the right hand side (i.e. for OP_LT, the comparison is actual_value &lt; value.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">read_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">key</span></tt>: which omap value to compare </li>
<li><tt class="docutils literal"><span class="pre">comparison_operator</span></tt>: one of LIBRADOS_CMPXATTR_OP_EQ, LIBRADOS_CMPXATTR_OP_LT, or LIBRADOS_CMPXATTR_OP_GT </li>
<li><tt class="docutils literal"><span class="pre">val</span></tt>: value to compare with </li>
<li><tt class="docutils literal"><span class="pre">val_len</span></tt>: length of value in bytes </li>
<li><tt class="docutils literal"><span class="pre">prval</span></tt>: where to store the return value from this action </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_stat">
<span class="target" id="librados_8h_1ac306f89b05d84ed0c83342a60c746ca7"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_read_op_stat</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, uint64_t *<em>&nbsp;psize</em>, time_t *<em>&nbsp;pmtime</em>, int *<em>&nbsp;prval</em><big>)</big><a class="headerlink" href="#rados_read_op_stat" title="Permalink to this definition">¶</a></dt>
<dd><p>Get object size and mtime <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">read_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">psize</span></tt>: where to store object size </li>
<li><tt class="docutils literal"><span class="pre">pmtime</span></tt>: where to store modification time </li>
<li><tt class="docutils literal"><span class="pre">prval</span></tt>: where to store the return value of this action </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_read">
<span class="target" id="librados_8h_1aa67f45909d4132b50c8407364729aa7a"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_read_op_read</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, uint64_t<em>&nbsp;offset</em>, size_t<em>&nbsp;len</em>, char *<em>&nbsp;buffer</em>, size_t *<em>&nbsp;bytes_read</em>, int *<em>&nbsp;prval</em><big>)</big><a class="headerlink" href="#rados_read_op_read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read bytes from offset into buffer.</p>
<p>prlen will be filled with the number of bytes read if successful. A short read can only occur if the read reaches the end of the object.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">read_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">offset</span></tt>: offset to read from </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: length of buffer </li>
<li><tt class="docutils literal"><span class="pre">buffer</span></tt>: where to put the data </li>
<li><tt class="docutils literal"><span class="pre">bytes_read</span></tt>: where to store the number of bytes read by this action </li>
<li><tt class="docutils literal"><span class="pre">prval</span></tt>: where to store the return value of this action </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_checksum">
<span class="target" id="librados_8h_1a26d4f26fdeb2164f4bfcd49c5976cfaa"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_read_op_checksum</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, <a class="reference internal" href="#rados_checksum_type_t" title="rados_checksum_type_t">rados_checksum_type_t</a><em>&nbsp;type</em>, const char *<em>&nbsp;init_value</em>, size_t<em>&nbsp;init_value_len</em>, uint64_t<em>&nbsp;offset</em>, size_t<em>&nbsp;len</em>, size_t<em>&nbsp;chunk_size</em>, char *<em>&nbsp;pchecksum</em>, size_t<em>&nbsp;checksum_len</em>, int *<em>&nbsp;prval</em><big>)</big><a class="headerlink" href="#rados_read_op_checksum" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute checksum from object data</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">read_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: the name of the object to checksum </li>
<li><tt class="docutils literal"><span class="pre">type</span></tt>: the checksum algorithm to utilize </li>
<li><tt class="docutils literal"><span class="pre">init_value</span></tt>: the init value for the algorithm </li>
<li><tt class="docutils literal"><span class="pre">init_value_len</span></tt>: the length of the init value </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: the number of bytes to checksum </li>
<li><tt class="docutils literal"><span class="pre">off</span></tt>: the offset to start checksuming in the object </li>
<li><tt class="docutils literal"><span class="pre">chunk_size</span></tt>: optional length-aligned chunk size for checksums </li>
<li><tt class="docutils literal"><span class="pre">pchecksum</span></tt>: where to store the checksum result for this action </li>
<li><tt class="docutils literal"><span class="pre">checksum_len</span></tt>: the number of bytes available for the result </li>
<li><tt class="docutils literal"><span class="pre">prval</span></tt>: where to store the return value for this action </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_exec">
<span class="target" id="librados_8h_1a1f87378777c8b7cc7bab5add93055a74"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_read_op_exec</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, const char *<em>&nbsp;cls</em>, const char *<em>&nbsp;method</em>, const char *<em>&nbsp;in_buf</em>, size_t<em>&nbsp;in_len</em>, char **<em>&nbsp;out_buf</em>, size_t *<em>&nbsp;out_len</em>, int *<em>&nbsp;prval</em><big>)</big><a class="headerlink" href="#rados_read_op_exec" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute an OSD class method on an object See rados_exec() for general description.</p>
<p>The output buffer is allocated on the heap; the caller is expected to release that memory with rados_buffer_free(). The buffer and length pointers can all be NULL, in which case they are not filled in.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">read_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">cls</span></tt>: the name of the class </li>
<li><tt class="docutils literal"><span class="pre">method</span></tt>: the name of the method </li>
<li><tt class="docutils literal"><span class="pre">in_buf</span></tt>: where to find input </li>
<li><tt class="docutils literal"><span class="pre">in_len</span></tt>: length of in_buf in bytes </li>
<li><tt class="docutils literal"><span class="pre">out_buf</span></tt>: where to put librados-allocated output buffer </li>
<li><tt class="docutils literal"><span class="pre">out_len</span></tt>: length of out_buf in bytes </li>
<li><tt class="docutils literal"><span class="pre">prval</span></tt>: where to store the return value from the method </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_exec_user_buf">
<span class="target" id="librados_8h_1aaab5404d3a37b629e5bc1f5ddd257912"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_read_op_exec_user_buf</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, const char *<em>&nbsp;cls</em>, const char *<em>&nbsp;method</em>, const char *<em>&nbsp;in_buf</em>, size_t<em>&nbsp;in_len</em>, char *<em>&nbsp;out_buf</em>, size_t<em>&nbsp;out_len</em>, size_t *<em>&nbsp;used_len</em>, int *<em>&nbsp;prval</em><big>)</big><a class="headerlink" href="#rados_read_op_exec_user_buf" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute an OSD class method on an object See rados_exec() for general description.</p>
<p>If the output buffer is too small, prval will be set to -ERANGE and used_len will be 0.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">read_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">cls</span></tt>: the name of the class </li>
<li><tt class="docutils literal"><span class="pre">method</span></tt>: the name of the method </li>
<li><tt class="docutils literal"><span class="pre">in_buf</span></tt>: where to find input </li>
<li><tt class="docutils literal"><span class="pre">in_len</span></tt>: length of in_buf in bytes </li>
<li><tt class="docutils literal"><span class="pre">out_buf</span></tt>: user-provided buffer to read into </li>
<li><tt class="docutils literal"><span class="pre">out_len</span></tt>: length of out_buf in bytes </li>
<li><tt class="docutils literal"><span class="pre">used_len</span></tt>: where to store the number of bytes read into out_buf </li>
<li><tt class="docutils literal"><span class="pre">prval</span></tt>: where to store the return value from the method </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_omap_get_vals">
<span class="target" id="librados_8h_1a4dd1b40ee9316fbef97da5dbcae0c8e7"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_read_op_omap_get_vals</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, const char *<em>&nbsp;start_after</em>, const char *<em>&nbsp;filter_prefix</em>, uint64_t<em>&nbsp;max_return</em>, <a class="reference internal" href="#rados_omap_iter_t" title="rados_omap_iter_t">rados_omap_iter_t</a> *<em>&nbsp;iter</em>, int *<em>&nbsp;prval</em><big>)</big><a class="headerlink" href="#rados_read_op_omap_get_vals" title="Permalink to this definition">¶</a></dt>
<dd><p>Start iterating over key/value pairs on an object.</p>
<p>They will be returned sorted by key.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">read_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">start_after</span></tt>: list keys starting after start_after </li>
<li><tt class="docutils literal"><span class="pre">filter_prefix</span></tt>: list only keys beginning with filter_prefix </li>
<li><tt class="docutils literal"><span class="pre">max_return</span></tt>: list no more than max_return key/value pairs </li>
<li><tt class="docutils literal"><span class="pre">iter</span></tt>: where to store the iterator </li>
<li><tt class="docutils literal"><span class="pre">prval</span></tt>: where to store the return value from this action </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_omap_get_vals2">
<span class="target" id="librados_8h_1a1c39c24a1a171b1e0416373eb7e85a31"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_read_op_omap_get_vals2</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, const char *<em>&nbsp;start_after</em>, const char *<em>&nbsp;filter_prefix</em>, uint64_t<em>&nbsp;max_return</em>, <a class="reference internal" href="#rados_omap_iter_t" title="rados_omap_iter_t">rados_omap_iter_t</a> *<em>&nbsp;iter</em>, unsigned char *<em>&nbsp;pmore</em>, int *<em>&nbsp;prval</em><big>)</big><a class="headerlink" href="#rados_read_op_omap_get_vals2" title="Permalink to this definition">¶</a></dt>
<dd><p>Start iterating over key/value pairs on an object.</p>
<p>They will be returned sorted by key.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">read_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">start_after</span></tt>: list keys starting after start_after </li>
<li><tt class="docutils literal"><span class="pre">filter_prefix</span></tt>: list only keys beginning with filter_prefix </li>
<li><tt class="docutils literal"><span class="pre">max_return</span></tt>: list no more than max_return key/value pairs </li>
<li><tt class="docutils literal"><span class="pre">iter</span></tt>: where to store the iterator </li>
<li><tt class="docutils literal"><span class="pre">pmore</span></tt>: flag indicating whether there are more keys to fetch </li>
<li><tt class="docutils literal"><span class="pre">prval</span></tt>: where to store the return value from this action </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_omap_get_keys">
<span class="target" id="librados_8h_1ae8d0453b0235d998427d90606564c6a4"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_read_op_omap_get_keys</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, const char *<em>&nbsp;start_after</em>, uint64_t<em>&nbsp;max_return</em>, <a class="reference internal" href="#rados_omap_iter_t" title="rados_omap_iter_t">rados_omap_iter_t</a> *<em>&nbsp;iter</em>, int *<em>&nbsp;prval</em><big>)</big><a class="headerlink" href="#rados_read_op_omap_get_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Start iterating over keys on an object.</p>
<p>They will be returned sorted by key, and the iterator will fill in NULL for all values if specified.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">read_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">start_after</span></tt>: list keys starting after start_after </li>
<li><tt class="docutils literal"><span class="pre">max_return</span></tt>: list no more than max_return keys </li>
<li><tt class="docutils literal"><span class="pre">iter</span></tt>: where to store the iterator </li>
<li><tt class="docutils literal"><span class="pre">prval</span></tt>: where to store the return value from this action </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_omap_get_keys2">
<span class="target" id="librados_8h_1ac048ab38b2ce74fba02c51f396296356"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_read_op_omap_get_keys2</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, const char *<em>&nbsp;start_after</em>, uint64_t<em>&nbsp;max_return</em>, <a class="reference internal" href="#rados_omap_iter_t" title="rados_omap_iter_t">rados_omap_iter_t</a> *<em>&nbsp;iter</em>, unsigned char *<em>&nbsp;pmore</em>, int *<em>&nbsp;prval</em><big>)</big><a class="headerlink" href="#rados_read_op_omap_get_keys2" title="Permalink to this definition">¶</a></dt>
<dd><p>Start iterating over keys on an object.</p>
<p>They will be returned sorted by key, and the iterator will fill in NULL for all values if specified.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">read_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">start_after</span></tt>: list keys starting after start_after </li>
<li><tt class="docutils literal"><span class="pre">max_return</span></tt>: list no more than max_return keys </li>
<li><tt class="docutils literal"><span class="pre">iter</span></tt>: where to store the iterator </li>
<li><tt class="docutils literal"><span class="pre">pmore</span></tt>: flag indicating whether there are more keys to fetch </li>
<li><tt class="docutils literal"><span class="pre">prval</span></tt>: where to store the return value from this action </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_omap_get_vals_by_keys">
<span class="target" id="librados_8h_1a24047194f483c33641575336aa306a65"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_read_op_omap_get_vals_by_keys</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, char const *const *<em>&nbsp;keys</em>, size_t<em>&nbsp;keys_len</em>, <a class="reference internal" href="#rados_omap_iter_t" title="rados_omap_iter_t">rados_omap_iter_t</a> *<em>&nbsp;iter</em>, int *<em>&nbsp;prval</em><big>)</big><a class="headerlink" href="#rados_read_op_omap_get_vals_by_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Start iterating over specific key/value pairs</p>
<p>They will be returned sorted by key.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">read_op</span></tt>: operation to add this action to </li>
<li><tt class="docutils literal"><span class="pre">keys</span></tt>: array of pointers to null-terminated keys to get </li>
<li><tt class="docutils literal"><span class="pre">keys_len</span></tt>: the number of strings in keys </li>
<li><tt class="docutils literal"><span class="pre">iter</span></tt>: where to store the iterator </li>
<li><tt class="docutils literal"><span class="pre">prval</span></tt>: where to store the return value from this action </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_read_op_operate">
<span class="target" id="librados_8h_1a3178db23e0b3ed2ed5a6b715d6343e03"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_read_op_operate</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, <a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, int<em>&nbsp;flags</em><big>)</big><a class="headerlink" href="#rados_read_op_operate" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a read operation synchronously <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">read_op</span></tt>: operation to perform </li>
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the ioctx that the object is in </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: the object id </li>
<li><tt class="docutils literal"><span class="pre">flags</span></tt>: flags to apply to the entire operation (LIBRADOS_OPERATION_*) </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_read_op_operate">
<span class="target" id="librados_8h_1ad3289c5789ff988b5b10b545dbc03afa"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_read_op_operate</tt><big>(</big><a class="reference internal" href="#rados_read_op_t" title="rados_read_op_t">rados_read_op_t</a><em>&nbsp;read_op</em>, <a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em>, const char *<em>&nbsp;oid</em>, int<em>&nbsp;flags</em><big>)</big><a class="headerlink" href="#rados_aio_read_op_operate" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a read operation asynchronously <dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">read_op</span></tt>: operation to perform </li>
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the ioctx that the object is in </li>
<li><tt class="docutils literal"><span class="pre">completion</span></tt>: what to do when operation has been attempted </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: the object id </li>
<li><tt class="docutils literal"><span class="pre">flags</span></tt>: flags to apply to the entire operation (LIBRADOS_OPERATION_*) </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Defines</p>
<dl class="define">
<dt id="CEPH_OSD_TMAP_HDR">
<span class="target" id="librados_8h_1a7374c886c3d189e22dab99e8e97b1c4a"></span><tt class="descname">CEPH_OSD_TMAP_HDR</tt><a class="headerlink" href="#CEPH_OSD_TMAP_HDR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="define">
<dt id="CEPH_OSD_TMAP_SET">
<span class="target" id="librados_8h_1ada41defa6d369f2e04ca53fc40754a37"></span><tt class="descname">CEPH_OSD_TMAP_SET</tt><a class="headerlink" href="#CEPH_OSD_TMAP_SET" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="define">
<dt id="CEPH_OSD_TMAP_CREATE">
<span class="target" id="librados_8h_1a0ba9335b21cd46e0cb4b03bf972f73e9"></span><tt class="descname">CEPH_OSD_TMAP_CREATE</tt><a class="headerlink" href="#CEPH_OSD_TMAP_CREATE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="define">
<dt id="CEPH_OSD_TMAP_RM">
<span class="target" id="librados_8h_1a553821d1fdb398b952d8595b2ea7939a"></span><tt class="descname">CEPH_OSD_TMAP_RM</tt><a class="headerlink" href="#CEPH_OSD_TMAP_RM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="define">
<dt id="LIBRADOS_VER_MAJOR">
<span class="target" id="librados_8h_1a0e0a428e7c02e984c30aaf54631b9179"></span><tt class="descname">LIBRADOS_VER_MAJOR</tt><a class="headerlink" href="#LIBRADOS_VER_MAJOR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="define">
<dt id="LIBRADOS_VER_MINOR">
<span class="target" id="librados_8h_1a6921c0c5fa48340c3b43d986b924789d"></span><tt class="descname">LIBRADOS_VER_MINOR</tt><a class="headerlink" href="#LIBRADOS_VER_MINOR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="define">
<dt id="LIBRADOS_VER_EXTRA">
<span class="target" id="librados_8h_1a1365154562de601650c9195216f47597"></span><tt class="descname">LIBRADOS_VER_EXTRA</tt><a class="headerlink" href="#LIBRADOS_VER_EXTRA" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="define">
<dt id="LIBRADOS_VERSION">
<span class="target" id="librados_8h_1a6a37ef77a4f8ab9670d137329fd9ec3d"></span><tt class="descname">LIBRADOS_VERSION</tt><big>(</big>maj, min, extra<big>)</big><a class="headerlink" href="#LIBRADOS_VERSION" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="define">
<dt id="LIBRADOS_VERSION_CODE">
<span class="target" id="librados_8h_1a5931a8379cebc7eed36f7146cfa1afa2"></span><tt class="descname">LIBRADOS_VERSION_CODE</tt><a class="headerlink" href="#LIBRADOS_VERSION_CODE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="define">
<dt id="LIBRADOS_SUPPORTS_WATCH">
<span class="target" id="librados_8h_1a49279ff58e94fe7bc89cf2a9561abc49"></span><tt class="descname">LIBRADOS_SUPPORTS_WATCH</tt><a class="headerlink" href="#LIBRADOS_SUPPORTS_WATCH" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="define">
<dt id="LIBRADOS_LOCK_FLAG_RENEW">
<span class="target" id="librados_8h_1a8422e60e2574925bf18537aac98fff00"></span><tt class="descname">LIBRADOS_LOCK_FLAG_RENEW</tt><a class="headerlink" href="#LIBRADOS_LOCK_FLAG_RENEW" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="define">
<dt id="LIBRADOS_CREATE_EXCLUSIVE">
<span class="target" id="librados_8h_1ac1f2fb141026970b30b31c6b510c40ec"></span><tt class="descname">LIBRADOS_CREATE_EXCLUSIVE</tt><a class="headerlink" href="#LIBRADOS_CREATE_EXCLUSIVE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="define">
<dt id="LIBRADOS_CREATE_IDEMPOTENT">
<span class="target" id="librados_8h_1a9d95de9eadd0c19d2d882207f68cd087"></span><tt class="descname">LIBRADOS_CREATE_IDEMPOTENT</tt><a class="headerlink" href="#LIBRADOS_CREATE_IDEMPOTENT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="define">
<dt id="CEPH_RADOS_API">
<span class="target" id="librados_8h_1aafc8385a5a2f57cee390b248a5edb1ee"></span><tt class="descname">CEPH_RADOS_API</tt><a class="headerlink" href="#CEPH_RADOS_API" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="define">
<dt id="LIBRADOS_SNAP_HEAD">
<span class="target" id="librados_8h_1a4f7b1b8bdc639f1bc8d66327d53977bd"></span><tt class="descname">LIBRADOS_SNAP_HEAD</tt><a class="headerlink" href="#LIBRADOS_SNAP_HEAD" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="define">
<dt id="LIBRADOS_SNAP_DIR">
<span class="target" id="librados_8h_1a94024e58d58fb0a06c184e5b1e725ccd"></span><tt class="descname">LIBRADOS_SNAP_DIR</tt><a class="headerlink" href="#LIBRADOS_SNAP_DIR" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="define">
<dt id="VOIDPTR_RADOS_T">
<span class="target" id="librados_8h_1a1719ba6b7d7d1c354174867d5433fb11"></span><tt class="descname">VOIDPTR_RADOS_T</tt><a class="headerlink" href="#VOIDPTR_RADOS_T" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Typedefs</p>
<dl class="typedef">
<dt id="rados_t">
<span class="target" id="librados_8h_1abda043338e76ae05b784cc194ff15cfa"></span><em class="property">typedef </em><tt class="descname">rados_t</tt><a class="headerlink" href="#rados_t" title="Permalink to this definition">¶</a></dt>
<dd><p>A handle for interacting with a RADOS cluster. It encapsulates all RADOS client configuration, including username, key for authentication, logging, and debugging. Talking different clusters  or to the same cluster with different users  requires different cluster handles. </p>
</dd></dl>

<dl class="typedef">
<dt id="rados_config_t">
<span class="target" id="librados_8h_1af3fd0fbac3bc0beb1f4b559b8f8f15f8"></span><em class="property">typedef </em><tt class="descname">rados_config_t</tt><a class="headerlink" href="#rados_config_t" title="Permalink to this definition">¶</a></dt>
<dd><p>A handle for the ceph configuration context for the rados_t cluster instance. This can be used to share configuration context/state (e.g., logging configuration) between librados instance.</p>
<p><dl class="docutils">
<dt><strong>Warning</strong></dt>
<dd>The config context does not have independent reference counting. As such, a rados_config_t handle retrieved from a given rados_t is only valid as long as that rados_t. </dd>
</dl>
</p>
</dd></dl>

<dl class="typedef">
<dt id="rados_ioctx_t">
<span class="target" id="librados_8h_1aa892568c6a8b4f1c07785b228014e3e3"></span><em class="property">typedef </em><tt class="descname">rados_ioctx_t</tt><a class="headerlink" href="#rados_ioctx_t" title="Permalink to this definition">¶</a></dt>
<dd><p>An io context encapsulates a few settings for all I/O operations done on it:<ul class="simple">
<li>pool - set when the io context is created (see rados_ioctx_create())</li>
<li>snapshot context for writes (see rados_ioctx_selfmanaged_snap_set_write_ctx())</li>
<li>snapshot id to read from (see rados_ioctx_snap_set_read())</li>
<li>object locator for all single-object operations (see rados_ioctx_locator_set_key())</li>
<li>namespace for all single-object operations (see rados_ioctx_set_namespace()). Set to LIBRADOS_ALL_NSPACES before rados_nobjects_list_open() will list all objects in all namespaces.</li>
</ul>
</p>
<p><dl class="docutils">
<dt><strong>Warning</strong></dt>
<dd>Changing any of these settings is not thread-safe - librados users must synchronize any of these changes on their own, or use separate io contexts for each thread </dd>
</dl>
</p>
</dd></dl>

<dl class="typedef">
<dt id="rados_list_ctx_t">
<span class="target" id="librados_8h_1ad0584c3ac7134ce95522fe9cf0505c52"></span><em class="property">typedef </em><tt class="descname">rados_list_ctx_t</tt><a class="headerlink" href="#rados_list_ctx_t" title="Permalink to this definition">¶</a></dt>
<dd><p>An iterator for listing the objects in a pool. Used with rados_nobjects_list_open(), rados_nobjects_list_next(), and rados_nobjects_list_close(). </p>
</dd></dl>

<dl class="typedef">
<dt id="rados_object_list_cursor">
<span class="target" id="librados_8h_1a259249958276daf836c8f5b48b6838b8"></span><em class="property">typedef </em><tt class="descname">rados_object_list_cursor</tt><a class="headerlink" href="#rados_object_list_cursor" title="Permalink to this definition">¶</a></dt>
<dd><p>The cursor used with rados_enumerate_objects and accompanying methods. </p>
</dd></dl>

<dl class="typedef">
<dt id="rados_object_list_item">
<span class="target" id="librados_8h_1a4bb30c09aeb21eda562fbe9c0b9850c5"></span><em class="property">typedef </em>struct <a class="reference internal" href="#rados_object_list_item" title="rados_object_list_item">rados_object_list_item</a>  <tt class="descname">rados_object_list_item</tt><a class="headerlink" href="#rados_object_list_item" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="typedef">
<dt id="rados_snap_t">
<span class="target" id="librados_8h_1ac997570481a967558a27892037ed0f40"></span><em class="property">typedef </em><tt class="descname">rados_snap_t</tt><a class="headerlink" href="#rados_snap_t" title="Permalink to this definition">¶</a></dt>
<dd><p>The id of a snapshot. </p>
</dd></dl>

<dl class="typedef">
<dt id="rados_xattrs_iter_t">
<span class="target" id="librados_8h_1a44416b1d487862521589e0ead757fe3c"></span><em class="property">typedef </em><tt class="descname">rados_xattrs_iter_t</tt><a class="headerlink" href="#rados_xattrs_iter_t" title="Permalink to this definition">¶</a></dt>
<dd><p>An iterator for listing extended attrbutes on an object. Used with rados_getxattrs(), rados_getxattrs_next(), and rados_getxattrs_end(). </p>
</dd></dl>

<dl class="typedef">
<dt id="rados_omap_iter_t">
<span class="target" id="librados_8h_1aa90e492075bc31d7037695d79a4bf136"></span><em class="property">typedef </em><tt class="descname">rados_omap_iter_t</tt><a class="headerlink" href="#rados_omap_iter_t" title="Permalink to this definition">¶</a></dt>
<dd><p>An iterator for listing omap key/value pairs on an object. Used with rados_read_op_omap_get_keys(), rados_read_op_omap_get_vals(), rados_read_op_omap_get_vals_by_keys(), rados_omap_get_next(), and rados_omap_get_end(). </p>
</dd></dl>

<dl class="typedef">
<dt id="rados_write_op_t">
<span class="target" id="librados_8h_1a8d8e4bd6677c21be8527089d735d8c9f"></span><em class="property">typedef </em><tt class="descname">rados_write_op_t</tt><a class="headerlink" href="#rados_write_op_t" title="Permalink to this definition">¶</a></dt>
<dd><p>An object write operation stores a number of operations which can be executed atomically. For usage, see:<ul class="simple">
<li>Creation and deletion: rados_create_write_op() rados_release_write_op()</li>
<li>Extended attribute manipulation: rados_write_op_cmpxattr() rados_write_op_cmpxattr(), rados_write_op_setxattr(), rados_write_op_rmxattr()</li>
<li>Object map key/value pairs: rados_write_op_omap_set(), rados_write_op_omap_rm_keys(), rados_write_op_omap_clear(), rados_write_op_omap_cmp()</li>
<li>Object properties: rados_write_op_assert_exists(), rados_write_op_assert_version()</li>
<li>Creating objects: rados_write_op_create()</li>
<li>IO on objects: rados_write_op_append(), rados_write_op_write(), rados_write_op_zero rados_write_op_write_full(), rados_write_op_writesame(), rados_write_op_remove, rados_write_op_truncate(), rados_write_op_zero(), rados_write_op_cmpext()</li>
<li>Hints: rados_write_op_set_alloc_hint()</li>
<li>Performing the operation: rados_write_op_operate(), rados_aio_write_op_operate() </li>
</ul>
</p>
</dd></dl>

<dl class="typedef">
<dt id="rados_read_op_t">
<span class="target" id="librados_8h_1a6b0c4c8af0568903adcdd3b376c9d0c3"></span><em class="property">typedef </em><tt class="descname">rados_read_op_t</tt><a class="headerlink" href="#rados_read_op_t" title="Permalink to this definition">¶</a></dt>
<dd><p>An object read operation stores a number of operations which can be executed atomically. For usage, see:<ul class="simple">
<li>Creation and deletion: rados_create_read_op() rados_release_read_op()</li>
<li>Extended attribute manipulation: rados_read_op_cmpxattr(), rados_read_op_getxattr(), rados_read_op_getxattrs()</li>
<li>Object map key/value pairs: rados_read_op_omap_get_vals(), rados_read_op_omap_get_keys(), rados_read_op_omap_get_vals_by_keys(), rados_read_op_omap_cmp()</li>
<li>Object properties: rados_read_op_stat(), rados_read_op_assert_exists(), rados_read_op_assert_version()</li>
<li>IO on objects: rados_read_op_read(), rados_read_op_checksum(), rados_read_op_cmpext()</li>
<li>Custom operations: rados_read_op_exec(), rados_read_op_exec_user_buf()</li>
<li>Request properties: rados_read_op_set_flags()</li>
<li>Performing the operation: rados_read_op_operate(), rados_aio_read_op_operate() </li>
</ul>
</p>
</dd></dl>

<dl class="typedef">
<dt id="rados_completion_t">
<span class="target" id="librados_8h_1a103477d70e54fcefe12d6efeac226b95"></span><em class="property">typedef </em><tt class="descname">rados_completion_t</tt><a class="headerlink" href="#rados_completion_t" title="Permalink to this definition">¶</a></dt>
<dd><p>Represents the state of an asynchronous operation - it contains the return value once the operation completes, and can be used to block until the operation is complete or safe. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Enums</p>
<dl class="enum">
<dt id="__anonymous0">
<span class="target" id="librados_8h_1a06fc87d81c62e9abb8790b6e5713c55b"></span><em class="property">enum </em><tt class="descname"><strong>[anonymous]</strong></tt><a class="headerlink" href="#__anonymous0" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Values:</em></p>
<dl class="enumvalue">
<dt id="LIBRADOS_OP_FLAG_EXCL">
<span class="target" id="librados_8h_1a06fc87d81c62e9abb8790b6e5713c55baff6ea20a1a925a1498302cad07b4ff52"></span><tt class="descname">LIBRADOS_OP_FLAG_EXCL</tt> =  0x1<a class="headerlink" href="#LIBRADOS_OP_FLAG_EXCL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_OP_FLAG_FAILOK">
<span class="target" id="librados_8h_1a06fc87d81c62e9abb8790b6e5713c55ba2c73bded10de4b1a8754a89e7ae93887"></span><tt class="descname">LIBRADOS_OP_FLAG_FAILOK</tt> = 0x2<a class="headerlink" href="#LIBRADOS_OP_FLAG_FAILOK" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_OP_FLAG_FADVISE_RANDOM">
<span class="target" id="librados_8h_1a06fc87d81c62e9abb8790b6e5713c55bab5be2a94eb79badadc9456c45d6f1841"></span><tt class="descname">LIBRADOS_OP_FLAG_FADVISE_RANDOM</tt> = 0x4<a class="headerlink" href="#LIBRADOS_OP_FLAG_FADVISE_RANDOM" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_OP_FLAG_FADVISE_SEQUENTIAL">
<span class="target" id="librados_8h_1a06fc87d81c62e9abb8790b6e5713c55ba0c8c16bf2b135b5bf519389ed4b79742"></span><tt class="descname">LIBRADOS_OP_FLAG_FADVISE_SEQUENTIAL</tt> = 0x8<a class="headerlink" href="#LIBRADOS_OP_FLAG_FADVISE_SEQUENTIAL" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_OP_FLAG_FADVISE_WILLNEED">
<span class="target" id="librados_8h_1a06fc87d81c62e9abb8790b6e5713c55ba1b93fe7705f5b03384def1ad43b73a86"></span><tt class="descname">LIBRADOS_OP_FLAG_FADVISE_WILLNEED</tt> = 0x10<a class="headerlink" href="#LIBRADOS_OP_FLAG_FADVISE_WILLNEED" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_OP_FLAG_FADVISE_DONTNEED">
<span class="target" id="librados_8h_1a06fc87d81c62e9abb8790b6e5713c55ba75277c9bba643f4dfcd629549c7aeff7"></span><tt class="descname">LIBRADOS_OP_FLAG_FADVISE_DONTNEED</tt> = 0x20<a class="headerlink" href="#LIBRADOS_OP_FLAG_FADVISE_DONTNEED" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_OP_FLAG_FADVISE_NOCACHE">
<span class="target" id="librados_8h_1a06fc87d81c62e9abb8790b6e5713c55ba6701f8ce0bcc4db4e36f1f744bc2751b"></span><tt class="descname">LIBRADOS_OP_FLAG_FADVISE_NOCACHE</tt> = 0x40<a class="headerlink" href="#LIBRADOS_OP_FLAG_FADVISE_NOCACHE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="enum">
<dt id="rados_checksum_type_t">
<span class="target" id="librados_8h_1a21d5ea2e2efa6a927e446514178318da"></span><em class="property">enum </em><tt class="descname">rados_checksum_type_t</tt><a class="headerlink" href="#rados_checksum_type_t" title="Permalink to this definition">¶</a></dt>
<dd><p><em>Values:</em></p>
<dl class="enumvalue">
<dt id="LIBRADOS_CHECKSUM_TYPE_XXHASH32">
<span class="target" id="librados_8h_1a21d5ea2e2efa6a927e446514178318daa72537a490295370ecaa487f9ff0311e7"></span><tt class="descname">LIBRADOS_CHECKSUM_TYPE_XXHASH32</tt> = 0<a class="headerlink" href="#LIBRADOS_CHECKSUM_TYPE_XXHASH32" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_CHECKSUM_TYPE_XXHASH64">
<span class="target" id="librados_8h_1a21d5ea2e2efa6a927e446514178318daa52ec18ad685189812518893f4da1b74a"></span><tt class="descname">LIBRADOS_CHECKSUM_TYPE_XXHASH64</tt> = 1<a class="headerlink" href="#LIBRADOS_CHECKSUM_TYPE_XXHASH64" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="enumvalue">
<dt id="LIBRADOS_CHECKSUM_TYPE_CRC32C">
<span class="target" id="librados_8h_1a21d5ea2e2efa6a927e446514178318daac161c13163b636a2b5b864bfc13f18e0"></span><tt class="descname">LIBRADOS_CHECKSUM_TYPE_CRC32C</tt> = 2<a class="headerlink" href="#LIBRADOS_CHECKSUM_TYPE_CRC32C" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Functions</p>
<dl class="function">
<dt id="rados_version">
<span class="target" id="librados_8h_1a7be6f8d87e887d3d1da13bf77f43b587"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_version</tt><big>(</big>int *<em>&nbsp;major</em>, int *<em>&nbsp;minor</em>, int *<em>&nbsp;extra</em><big>)</big><a class="headerlink" href="#rados_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the version of librados.</p>
<p>The version number is major.minor.extra. Note that this is unrelated to the Ceph version number.</p>
<p>TODO: define version semantics, i.e.:<ul class="simple">
<li>incrementing major is for backwards-incompatible changes</li>
<li>incrementing minor is for backwards-compatible changes</li>
<li>incrementing extra is for bug fixes</li>
</ul>
</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">major</span></tt>: where to store the major version number </li>
<li><tt class="docutils literal"><span class="pre">minor</span></tt>: where to store the minor version number </li>
<li><tt class="docutils literal"><span class="pre">extra</span></tt>: where to store the extra version number </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_cluster_stat">
<span class="target" id="librados_8h_1a865143515247a530c221cead44a3c482"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_cluster_stat</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, struct  <a class="reference internal" href="#rados_cluster_stat_t" title="rados_cluster_stat_t">rados_cluster_stat_t</a>  *<em>&nbsp;result</em><big>)</big><a class="headerlink" href="#rados_cluster_stat" title="Permalink to this definition">¶</a></dt>
<dd><p>Read usage info about the cluster</p>
<p>This tells you total space, space used, space available, and number of objects. These are not updated immediately when data is written, they are eventually consistent.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: cluster to query </li>
<li><tt class="docutils literal"><span class="pre">result</span></tt>: where to store the results </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_cluster_fsid">
<span class="target" id="librados_8h_1ad962962c237c99a9188befff6c7f2ede"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_cluster_fsid</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, char *<em>&nbsp;buf</em>, size_t<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_cluster_fsid" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the fsid of the cluster as a hexadecimal string.</p>
<p>The fsid is a unique id of an entire Ceph cluster.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Return</strong></dt>
<dd>-ERANGE if the buffer is too short to contain the fsid </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: where to get the fsid </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: where to write the fsid </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: the size of buf in bytes (should be 37) </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_wait_for_latest_osdmap">
<span class="target" id="librados_8h_1a764137a5aa25c7a725b14ac2b5a561a5"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_wait_for_latest_osdmap</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em><big>)</big><a class="headerlink" href="#rados_wait_for_latest_osdmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Get/wait for the most recent osdmap</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on sucess, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: the cluster to shutdown </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_omap_get_next">
<span class="target" id="librados_8h_1a662629ba980ffffa8a65b17481b435d6"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_omap_get_next</tt><big>(</big><a class="reference internal" href="#rados_omap_iter_t" title="rados_omap_iter_t">rados_omap_iter_t</a><em>&nbsp;iter</em>, char **<em>&nbsp;key</em>, char **<em>&nbsp;val</em>, size_t *<em>&nbsp;len</em><big>)</big><a class="headerlink" href="#rados_omap_get_next" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the next omap key/value pair on the object</p>
<p><dl class="docutils">
<dt><strong>Pre</strong></dt>
<dd>iter is a valid iterator</dd>
<dt><strong>Post</strong></dt>
<dd>key and val are the next key/value pair. key is null-terminated, and val has length len. If the end of the list has been reached, key and val are NULL, and len is 0. key and val will not be accessible after rados_omap_get_end() is called on iter, so if they are needed after that they should be copied.</dd>
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">iter</span></tt>: iterator to advance </li>
<li><tt class="docutils literal"><span class="pre">key</span></tt>: where to store the key of the next omap entry </li>
<li><tt class="docutils literal"><span class="pre">val</span></tt>: where to store the value of the next omap entry </li>
<li><tt class="docutils literal"><span class="pre">len</span></tt>: where to store the number of bytes in val </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_omap_get_end">
<span class="target" id="librados_8h_1acb0a5de9aed41fafb7cd6ded011f97a6"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_omap_get_end</tt><big>(</big><a class="reference internal" href="#rados_omap_iter_t" title="rados_omap_iter_t">rados_omap_iter_t</a><em>&nbsp;iter</em><big>)</big><a class="headerlink" href="#rados_omap_get_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the omap iterator.</p>
<p>iter should not be used after this is called.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">iter</span></tt>: the iterator to close </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_stat">
<span class="target" id="librados_8h_1ad7a13f3f1c0b5e0fe2c46d4213ecb4ae"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_stat</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, uint64_t *<em>&nbsp;psize</em>, time_t *<em>&nbsp;pmtime</em><big>)</big><a class="headerlink" href="#rados_stat" title="Permalink to this definition">¶</a></dt>
<dd><p>Get object stats (size/mtime)</p>
<p>TODO: when are these set, and by whom? can they be out of date?</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: ioctx </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: object name </li>
<li><tt class="docutils literal"><span class="pre">psize</span></tt>: where to store object size </li>
<li><tt class="docutils literal"><span class="pre">pmtime</span></tt>: where to store modification time </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_tmap_update">
<span class="target" id="librados_8h_1a2899b207714ad34c2a3339bf2f2d55ca"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_tmap_update</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, const char *<em>&nbsp;cmdbuf</em>, size_t<em>&nbsp;cmdbuflen</em><big>)</big><a class="headerlink" href="#rados_tmap_update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update tmap (trivial map)</p>
<p>Do compound update to a tmap object, inserting or deleting some number of records. cmdbuf is a series of operation byte codes, following by command payload. Each command is a single-byte command code, whose value is one of CEPH_OSD_TMAP_*.</p>
<p><ul class="simple">
<li>update tmap &#8216;header&#8217;<ul>
<li>1 byte = CEPH_OSD_TMAP_HDR</li>
<li>4 bytes = data length (little endian)</li>
<li>N bytes = data</li>
</ul>
</li>
<li>insert/update one key/value pair<ul>
<li>1 byte = CEPH_OSD_TMAP_SET</li>
<li>4 bytes = key name length (little endian)</li>
<li>N bytes = key name</li>
<li>4 bytes = data length (little endian)</li>
<li>M bytes = data</li>
</ul>
</li>
<li>insert one key/value pair; return -EEXIST if it already exists.<ul>
<li>1 byte = CEPH_OSD_TMAP_CREATE</li>
<li>4 bytes = key name length (little endian)</li>
<li>N bytes = key name</li>
<li>4 bytes = data length (little endian)</li>
<li>M bytes = data</li>
</ul>
</li>
<li>remove one key/value pair<ul>
<li>1 byte = CEPH_OSD_TMAP_RM</li>
<li>4 bytes = key name length (little endian)</li>
<li>N bytes = key name</li>
</ul>
</li>
</ul>
</p>
<p>Restrictions:<ul class="simple">
<li>The HDR update must preceed any key/value updates.</li>
<li>All key/value updates must be in lexicographically sorted order in cmdbuf.</li>
<li>You can read/write to a tmap object via the regular APIs, but you should be careful not to corrupt it. Also be aware that the object format may change without notice.</li>
</ul>
</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: ioctx </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: object name </li>
<li><tt class="docutils literal"><span class="pre">cmdbuf</span></tt>: command buffer </li>
<li><tt class="docutils literal"><span class="pre">cmdbuflen</span></tt>: command buffer length in bytes </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_tmap_put">
<span class="target" id="librados_8h_1a862cac022c8a12a904f730fa05167e56"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_tmap_put</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, const char *<em>&nbsp;buf</em>, size_t<em>&nbsp;buflen</em><big>)</big><a class="headerlink" href="#rados_tmap_put" title="Permalink to this definition">¶</a></dt>
<dd><p>Store complete tmap (trivial map) object</p>
<p>Put a full tmap object into the store, replacing what was there.</p>
<p>The format of buf is:<ul class="simple">
<li>4 bytes - length of header (little endian)</li>
<li>N bytes - header data</li>
<li>4 bytes - number of keys (little endian)</li>
</ul>
</p>
<p>and for each key,<ul class="simple">
<li>4 bytes - key name length (little endian)</li>
<li>N bytes - key name</li>
<li>4 bytes - value length (little endian)</li>
<li>M bytes - value data</li>
</ul>
</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: ioctx </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: object name </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: buffer </li>
<li><tt class="docutils literal"><span class="pre">buflen</span></tt>: buffer length in bytes </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_tmap_get">
<span class="target" id="librados_8h_1ab34aaa6c90333775be0c871f5c3f021d"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_tmap_get</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, char *<em>&nbsp;buf</em>, size_t<em>&nbsp;buflen</em><big>)</big><a class="headerlink" href="#rados_tmap_get" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetch complete tmap (trivial map) object</p>
<p>Read a full tmap object. See rados_tmap_put() for the format the data is returned in.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Return</strong></dt>
<dd>-ERANGE if buf isn&#8217;t big enough </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: ioctx </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: object name </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: buffer </li>
<li><tt class="docutils literal"><span class="pre">buflen</span></tt>: buffer length in bytes </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_exec">
<span class="target" id="librados_8h_1a53adcdedd6b93cd9bde6c0e97a6b4d79"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_exec</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, const char *<em>&nbsp;cls</em>, const char *<em>&nbsp;method</em>, const char *<em>&nbsp;in_buf</em>, size_t<em>&nbsp;in_len</em>, char *<em>&nbsp;buf</em>, size_t<em>&nbsp;out_len</em><big>)</big><a class="headerlink" href="#rados_exec" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute an OSD class method on an object</p>
<p>The OSD has a plugin mechanism for performing complicated operations on an object atomically. These plugins are called classes. This function allows librados users to call the custom methods. The input and output formats are defined by the class. Classes in ceph.git can be found in src/cls subdirectories</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>the length of the output, or -ERANGE if out_buf does not have enough space to store it (For methods that return data). For methods that don&#8217;t return data, the return value is method-specific. </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context in which to call the method </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: the object to call the method on </li>
<li><tt class="docutils literal"><span class="pre">cls</span></tt>: the name of the class </li>
<li><tt class="docutils literal"><span class="pre">method</span></tt>: the name of the method </li>
<li><tt class="docutils literal"><span class="pre">in_buf</span></tt>: where to find input </li>
<li><tt class="docutils literal"><span class="pre">in_len</span></tt>: length of in_buf in bytes </li>
<li><tt class="docutils literal"><span class="pre">buf</span></tt>: where to store output </li>
<li><tt class="docutils literal"><span class="pre">out_len</span></tt>: length of buf in bytes </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_cache_pin">
<span class="target" id="librados_8h_1a3d11ce24baf1983c75bc8e3ca3c5cdf4"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_cache_pin</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em><big>)</big><a class="headerlink" href="#rados_cache_pin" title="Permalink to this definition">¶</a></dt>
<dd><p>Pin an object in the cache tier</p>
<p>When an object is pinned in the cache tier, it stays in the cache tier, and won&#8217;t be flushed out.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool the object is in </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: the object id </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_cache_unpin">
<span class="target" id="librados_8h_1a4e5bf47b06bb1bc606f618a9a3ac19c9"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_cache_unpin</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em><big>)</big><a class="headerlink" href="#rados_cache_unpin" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpin an object in the cache tier</p>
<p>After an object is unpinned in the cache tier, it can be flushed out</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the pool the object is in </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: the object id </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_lock_exclusive">
<span class="target" id="librados_8h_1ab16f58c1b95d4d8e9e91f82de5f4f1a9"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_lock_exclusive</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;oid</em>, const char *<em>&nbsp;name</em>, const char *<em>&nbsp;cookie</em>, const char *<em>&nbsp;desc</em>, struct timeval *<em>&nbsp;duration</em>, uint8_t<em>&nbsp;flags</em><big>)</big><a class="headerlink" href="#rados_lock_exclusive" title="Permalink to this definition">¶</a></dt>
<dd><p>Take an exclusive lock on an object.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Return</strong></dt>
<dd>-EBUSY if the lock is already held by another (client, cookie) pair </dd>
<dt><strong>Return</strong></dt>
<dd>-EEXIST if the lock is already held by the same (client, cookie) pair </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context to operate in </li>
<li><tt class="docutils literal"><span class="pre">oid</span></tt>: the name of the object </li>
<li><tt class="docutils literal"><span class="pre">name</span></tt>: the name of the lock </li>
<li><tt class="docutils literal"><span class="pre">cookie</span></tt>: user-defined identifier for this instance of the lock </li>
<li><tt class="docutils literal"><span class="pre">desc</span></tt>: user-defined lock description </li>
<li><tt class="docutils literal"><span class="pre">duration</span></tt>: the duration of the lock. Set to NULL for infinite duration. </li>
<li><tt class="docutils literal"><span class="pre">flags</span></tt>: lock flags </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_lock_shared">
<span class="target" id="librados_8h_1a2c6b48376f9bb95c8d2f9e332b4aeaf5"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_lock_shared</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, const char *<em>&nbsp;name</em>, const char *<em>&nbsp;cookie</em>, const char *<em>&nbsp;tag</em>, const char *<em>&nbsp;desc</em>, struct timeval *<em>&nbsp;duration</em>, uint8_t<em>&nbsp;flags</em><big>)</big><a class="headerlink" href="#rados_lock_shared" title="Permalink to this definition">¶</a></dt>
<dd><p>Take a shared lock on an object.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Return</strong></dt>
<dd>-EBUSY if the lock is already held by another (client, cookie) pair </dd>
<dt><strong>Return</strong></dt>
<dd>-EEXIST if the lock is already held by the same (client, cookie) pair </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context to operate in </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: the name of the object </li>
<li><tt class="docutils literal"><span class="pre">name</span></tt>: the name of the lock </li>
<li><tt class="docutils literal"><span class="pre">cookie</span></tt>: user-defined identifier for this instance of the lock </li>
<li><tt class="docutils literal"><span class="pre">tag</span></tt>: The tag of the lock </li>
<li><tt class="docutils literal"><span class="pre">desc</span></tt>: user-defined lock description </li>
<li><tt class="docutils literal"><span class="pre">duration</span></tt>: the duration of the lock. Set to NULL for infinite duration. </li>
<li><tt class="docutils literal"><span class="pre">flags</span></tt>: lock flags </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_unlock">
<span class="target" id="librados_8h_1a9190641a8d05ba18002fe4e1f08ebae1"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_unlock</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, const char *<em>&nbsp;name</em>, const char *<em>&nbsp;cookie</em><big>)</big><a class="headerlink" href="#rados_unlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Release a shared or exclusive lock on an object.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Return</strong></dt>
<dd>-ENOENT if the lock is not held by the specified (client, cookie) pair </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context to operate in </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: the name of the object </li>
<li><tt class="docutils literal"><span class="pre">name</span></tt>: the name of the lock </li>
<li><tt class="docutils literal"><span class="pre">cookie</span></tt>: user-defined identifier for the instance of the lock </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_aio_unlock">
<span class="target" id="librados_8h_1a4671577661a5b191f06947e0cb61d5dd"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_aio_unlock</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, const char *<em>&nbsp;name</em>, const char *<em>&nbsp;cookie</em>, <a class="reference internal" href="#rados_completion_t" title="rados_completion_t">rados_completion_t</a><em>&nbsp;completion</em><big>)</big><a class="headerlink" href="#rados_aio_unlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronous release a shared or exclusive lock on an object.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context to operate in </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: the name of the object </li>
<li><tt class="docutils literal"><span class="pre">name</span></tt>: the name of the lock </li>
<li><tt class="docutils literal"><span class="pre">cookie</span></tt>: user-defined identifier for the instance of the lock </li>
<li><tt class="docutils literal"><span class="pre">completion</span></tt>: what to do when operation has been attempted </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_list_lockers">
<span class="target" id="librados_8h_1a5bbe10652a96add66edf90c8d737f6e9"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> ssize_t <tt class="descname">rados_list_lockers</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, const char *<em>&nbsp;name</em>, int *<em>&nbsp;exclusive</em>, char *<em>&nbsp;tag</em>, size_t *<em>&nbsp;tag_len</em>, char *<em>&nbsp;clients</em>, size_t *<em>&nbsp;clients_len</em>, char *<em>&nbsp;cookies</em>, size_t *<em>&nbsp;cookies_len</em>, char *<em>&nbsp;addrs</em>, size_t *<em>&nbsp;addrs_len</em><big>)</big><a class="headerlink" href="#rados_list_lockers" title="Permalink to this definition">¶</a></dt>
<dd><p>List clients that have locked the named object lock and information about the lock.</p>
<p>The number of bytes required in each buffer is put in the corresponding size out parameter. If any of the provided buffers are too short, -ERANGE is returned after these sizes are filled in.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>number of lockers on success, negative error code on failure </dd>
<dt><strong>Return</strong></dt>
<dd>-ERANGE if any of the buffers are too short </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context to operate in </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: the name of the object </li>
<li><tt class="docutils literal"><span class="pre">name</span></tt>: the name of the lock </li>
<li><tt class="docutils literal"><span class="pre">exclusive</span></tt>: where to store whether the lock is exclusive (1) or shared (0) </li>
<li><tt class="docutils literal"><span class="pre">tag</span></tt>: where to store the tag associated with the object lock </li>
<li><tt class="docutils literal"><span class="pre">tag_len</span></tt>: number of bytes in tag buffer </li>
<li><tt class="docutils literal"><span class="pre">clients</span></tt>: buffer in which locker clients are stored, separated by &#8216;\0&#8217; </li>
<li><tt class="docutils literal"><span class="pre">clients_len</span></tt>: number of bytes in the clients buffer </li>
<li><tt class="docutils literal"><span class="pre">cookies</span></tt>: buffer in which locker cookies are stored, separated by &#8216;\0&#8217; </li>
<li><tt class="docutils literal"><span class="pre">cookies_len</span></tt>: number of bytes in the cookies buffer </li>
<li><tt class="docutils literal"><span class="pre">addrs</span></tt>: buffer in which locker addresses are stored, separated by &#8216;\0&#8217; </li>
<li><tt class="docutils literal"><span class="pre">addrs_len</span></tt>: number of bytes in the clients buffer </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_break_lock">
<span class="target" id="librados_8h_1a541c71bbd6497cb92c4933bab8f12afd"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_break_lock</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, const char *<em>&nbsp;o</em>, const char *<em>&nbsp;name</em>, const char *<em>&nbsp;client</em>, const char *<em>&nbsp;cookie</em><big>)</big><a class="headerlink" href="#rados_break_lock" title="Permalink to this definition">¶</a></dt>
<dd><p>Releases a shared or exclusive lock on an object, which was taken by the specified client.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Return</strong></dt>
<dd>-ENOENT if the lock is not held by the specified (client, cookie) pair </dd>
<dt><strong>Return</strong></dt>
<dd>-EINVAL if the client cannot be parsed </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">io</span></tt>: the context to operate in </li>
<li><tt class="docutils literal"><span class="pre">o</span></tt>: the name of the object </li>
<li><tt class="docutils literal"><span class="pre">name</span></tt>: the name of the lock </li>
<li><tt class="docutils literal"><span class="pre">client</span></tt>: the client currently holding the lock </li>
<li><tt class="docutils literal"><span class="pre">cookie</span></tt>: user-defined identifier for the instance of the lock </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_blacklist_add">
<span class="target" id="librados_8h_1ab21db9859670ba925ae1bbc7e150e968"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_blacklist_add</tt><big>(</big><a class="reference internal" href="#rados_t" title="rados_t">rados_t</a><em>&nbsp;cluster</em>, char *<em>&nbsp;client_address</em>, uint32_t<em>&nbsp;expire_seconds</em><big>)</big><a class="headerlink" href="#rados_blacklist_add" title="Permalink to this definition">¶</a></dt>
<dd><p>Blacklists the specified client from the OSDs</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>0 on success, negative error code on failure </dd>
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><tt class="docutils literal"><span class="pre">cluster</span></tt>: cluster handle </li>
<li><tt class="docutils literal"><span class="pre">client_address</span></tt>: client address </li>
<li><tt class="docutils literal"><span class="pre">expire_seconds</span></tt>: number of seconds to blacklist (0 for default) </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="function">
<dt id="rados_objects_list_open">
<span class="target" id="librados_8h_1a91049937a19a2ad5abe2bfe0d7ca7c36"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_objects_list_open</tt><big>(</big><a class="reference internal" href="#rados_ioctx_t" title="rados_ioctx_t">rados_ioctx_t</a><em>&nbsp;io</em>, <a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a> *<em>&nbsp;ctx</em><big>)</big><a class="headerlink" href="#rados_objects_list_open" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="rados_objects_list_get_pg_hash_position">
<span class="target" id="librados_8h_1a180c89c14f7e1196d6c68cda56afa080"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> uint32_t <tt class="descname">rados_objects_list_get_pg_hash_position</tt><big>(</big><a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a><em>&nbsp;ctx</em><big>)</big><a class="headerlink" href="#rados_objects_list_get_pg_hash_position" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="rados_objects_list_seek">
<span class="target" id="librados_8h_1afe558022903cb55107ec98a12be908cb"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> uint32_t <tt class="descname">rados_objects_list_seek</tt><big>(</big><a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a><em>&nbsp;ctx</em>, uint32_t<em>&nbsp;pos</em><big>)</big><a class="headerlink" href="#rados_objects_list_seek" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="rados_objects_list_next">
<span class="target" id="librados_8h_1abe8c875c7b27b57001202487e0b1ba10"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> int <tt class="descname">rados_objects_list_next</tt><big>(</big><a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a><em>&nbsp;ctx</em>, const char **<em>&nbsp;entry</em>, const char **<em>&nbsp;key</em><big>)</big><a class="headerlink" href="#rados_objects_list_next" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="rados_objects_list_close">
<span class="target" id="librados_8h_1a1f422e53604e1796d6c1650ec0ccb079"></span><a class="reference internal" href="#CEPH_RADOS_API" title="CEPH_RADOS_API">CEPH_RADOS_API</a> void <tt class="descname">rados_objects_list_close</tt><big>(</big><a class="reference internal" href="#rados_list_ctx_t" title="rados_list_ctx_t">rados_list_ctx_t</a><em>&nbsp;ctx</em><big>)</big><a class="headerlink" href="#rados_objects_list_close" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<dl class="struct">
<dt>
<span class="target" id="structrados__object__list__item"></span><em class="property">struct </em><tt class="descname">rados_object_list_item</tt></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="rados_object_list_item::oid_length">
<span class="target" id="structrados__object__list__item_1ab435d1c0f7cfac2dbd6be0c2a3ab438e"></span>size_t <tt class="descname">oid_length</tt><a class="headerlink" href="#rados_object_list_item::oid_length" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="rados_object_list_item::oid">
<span class="target" id="structrados__object__list__item_1a8f579ff1575094f48ef759e5814c55de"></span>char* <tt class="descname">oid</tt><a class="headerlink" href="#rados_object_list_item::oid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="rados_object_list_item::nspace_length">
<span class="target" id="structrados__object__list__item_1aa717865eb172ba1f7054796fafcebc28"></span>size_t <tt class="descname">nspace_length</tt><a class="headerlink" href="#rados_object_list_item::nspace_length" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="rados_object_list_item::nspace">
<span class="target" id="structrados__object__list__item_1a3efdaa04909dc96ca679e9c1c908d0c6"></span>char* <tt class="descname">nspace</tt><a class="headerlink" href="#rados_object_list_item::nspace" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="rados_object_list_item::locator_length">
<span class="target" id="structrados__object__list__item_1a37a4a7c93e674c5a6ff6eb1d3775054d"></span>size_t <tt class="descname">locator_length</tt><a class="headerlink" href="#rados_object_list_item::locator_length" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="rados_object_list_item::locator">
<span class="target" id="structrados__object__list__item_1a167c9fab6a08d37c4959abb447f4e927"></span>char* <tt class="descname">locator</tt><a class="headerlink" href="#rados_object_list_item::locator" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="struct">
<dt id="rados_pool_stat_t">
<span class="target" id="structrados__pool__stat__t"></span><em class="property">struct </em><tt class="descname">rados_pool_stat_t</tt><a class="headerlink" href="#rados_pool_stat_t" title="Permalink to this definition">¶</a></dt>
<dd><em>#include &lt;librados.h&gt;</em><p>Usage information for a pool. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="rados_pool_stat_t::num_bytes">
<span class="target" id="structrados__pool__stat__t_1ae6385fec35785692a72ded4521051349"></span>uint64_t <tt class="descname">num_bytes</tt><a class="headerlink" href="#rados_pool_stat_t::num_bytes" title="Permalink to this definition">¶</a></dt>
<dd><p>space used in bytes </p>
</dd></dl>

<dl class="variable">
<dt id="rados_pool_stat_t::num_kb">
<span class="target" id="structrados__pool__stat__t_1ab9dfedb097f054908307faaa66b7e109"></span>uint64_t <tt class="descname">num_kb</tt><a class="headerlink" href="#rados_pool_stat_t::num_kb" title="Permalink to this definition">¶</a></dt>
<dd><p>space used in KB </p>
</dd></dl>

<dl class="variable">
<dt id="rados_pool_stat_t::num_objects">
<span class="target" id="structrados__pool__stat__t_1ad0f3fc2289e2242e4d81475b3b9c6ee7"></span>uint64_t <tt class="descname">num_objects</tt><a class="headerlink" href="#rados_pool_stat_t::num_objects" title="Permalink to this definition">¶</a></dt>
<dd><p>number of objects in the pool </p>
</dd></dl>

<dl class="variable">
<dt id="rados_pool_stat_t::num_object_clones">
<span class="target" id="structrados__pool__stat__t_1a934a353ee4ee657b1e47b66ffc99ee02"></span>uint64_t <tt class="descname">num_object_clones</tt><a class="headerlink" href="#rados_pool_stat_t::num_object_clones" title="Permalink to this definition">¶</a></dt>
<dd><p>number of clones of objects </p>
</dd></dl>

<dl class="variable">
<dt id="rados_pool_stat_t::num_object_copies">
<span class="target" id="structrados__pool__stat__t_1a3e537978ffb81be0a6355f3bb6159290"></span>uint64_t <tt class="descname">num_object_copies</tt><a class="headerlink" href="#rados_pool_stat_t::num_object_copies" title="Permalink to this definition">¶</a></dt>
<dd><p>num_objects * num_replicas </p>
</dd></dl>

<dl class="variable">
<dt id="rados_pool_stat_t::num_objects_missing_on_primary">
<span class="target" id="structrados__pool__stat__t_1a2f0995af81b64c8678dc4bdecd42a8c5"></span>uint64_t <tt class="descname">num_objects_missing_on_primary</tt><a class="headerlink" href="#rados_pool_stat_t::num_objects_missing_on_primary" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="rados_pool_stat_t::num_objects_unfound">
<span class="target" id="structrados__pool__stat__t_1a1be8f89a42f68ef7f25d5dcf728ea7b0"></span>uint64_t <tt class="descname">num_objects_unfound</tt><a class="headerlink" href="#rados_pool_stat_t::num_objects_unfound" title="Permalink to this definition">¶</a></dt>
<dd><p>number of objects found on no OSDs </p>
</dd></dl>

<dl class="variable">
<dt id="rados_pool_stat_t::num_objects_degraded">
<span class="target" id="structrados__pool__stat__t_1af63ab0187a498098d898f4dd1b49cb5c"></span>uint64_t <tt class="descname">num_objects_degraded</tt><a class="headerlink" href="#rados_pool_stat_t::num_objects_degraded" title="Permalink to this definition">¶</a></dt>
<dd><p>number of objects replicated fewer times than they should be (but found on at least one OSD) </p>
</dd></dl>

<dl class="variable">
<dt id="rados_pool_stat_t::num_rd">
<span class="target" id="structrados__pool__stat__t_1aca0e0d878b451946c96a8f0fb46075df"></span>uint64_t <tt class="descname">num_rd</tt><a class="headerlink" href="#rados_pool_stat_t::num_rd" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="rados_pool_stat_t::num_rd_kb">
<span class="target" id="structrados__pool__stat__t_1abef90de3656e1aa464e70661bff8220b"></span>uint64_t <tt class="descname">num_rd_kb</tt><a class="headerlink" href="#rados_pool_stat_t::num_rd_kb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="rados_pool_stat_t::num_wr">
<span class="target" id="structrados__pool__stat__t_1a8c77f7bf4c192e522df7496288f23f8f"></span>uint64_t <tt class="descname">num_wr</tt><a class="headerlink" href="#rados_pool_stat_t::num_wr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="rados_pool_stat_t::num_wr_kb">
<span class="target" id="structrados__pool__stat__t_1af56c7186ba19df57f7978b6ce734361a"></span>uint64_t <tt class="descname">num_wr_kb</tt><a class="headerlink" href="#rados_pool_stat_t::num_wr_kb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="struct">
<dt id="rados_cluster_stat_t">
<span class="target" id="structrados__cluster__stat__t"></span><em class="property">struct </em><tt class="descname">rados_cluster_stat_t</tt><a class="headerlink" href="#rados_cluster_stat_t" title="Permalink to this definition">¶</a></dt>
<dd><em>#include &lt;librados.h&gt;</em><p>Cluster-wide usage information </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Public Members</p>
<dl class="variable">
<dt id="rados_cluster_stat_t::kb">
<span class="target" id="structrados__cluster__stat__t_1a37633ef0eb7d786d06869a7401167966"></span>uint64_t <tt class="descname">kb</tt><a class="headerlink" href="#rados_cluster_stat_t::kb" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="rados_cluster_stat_t::kb_used">
<span class="target" id="structrados__cluster__stat__t_1ac2c7d8f0977feed733742e5a1d046f5e"></span>uint64_t <tt class="descname">kb_used</tt><a class="headerlink" href="#rados_cluster_stat_t::kb_used" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="rados_cluster_stat_t::kb_avail">
<span class="target" id="structrados__cluster__stat__t_1aeb381150d5a01aeb57015512d820b302"></span>uint64_t <tt class="descname">kb_avail</tt><a class="headerlink" href="#rados_cluster_stat_t::kb_avail" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="variable">
<dt id="rados_cluster_stat_t::num_objects">
<span class="target" id="structrados__cluster__stat__t_1addd82ed2ef92adc7ecb8c051ad68bd66"></span>uint64_t <tt class="descname">num_objects</tt><a class="headerlink" href="#rados_cluster_stat_t::num_objects" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</dd></dl>

</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../">
              <img class="logo" src="../../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../../">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../start/intro/">Ceph 简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../start/">安装（快速）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install/">安装（手动）</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../">Ceph 存储集群</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../configuration/">配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../deployment/">部署</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../operations/">运维</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/">手册页</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/">故障排除</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../">APIs</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../librados-intro/">librados 简介</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="">librados (C)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">实例：连接并写入一个对象</a></li>
<li class="toctree-l4"><a class="reference internal" href="#io">异步 IO</a></li>
<li class="toctree-l4"><a class="reference internal" href="#api-calls">API calls</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../libradospp/">librados (C++)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../python/">librados (Python)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../objclass-sdk/">object class</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../cephfs/">Ceph 文件系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rbd/rbd/">Ceph 块设备</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../radosgw/">Ceph 对象网关</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mgr/">Ceph 管理器守护进程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/">API 文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../architecture/">体系结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/">开发文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release-notes/">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../releases/">Ceph 版本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary/">Ceph 术语</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../README/">中文版翻译说明</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../translation-convention/">中文版词语翻译惯例</a></li>
</ul>


<!-- ugly kludge to make genindex look like it's part of the toc -->
<ul style="margin-top: -10px"><li class="toctree-l1"><a class="reference internal" href="../../../genindex/">Index</a></li></ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../libradospp/" title="LibradosPP (C++)"
             >next</a> |</li>
        <li class="right" >
          <a href="../librados-intro/" title="librados 简介"
             >previous</a> |</li>
        <li><a href="../../../">Ceph Documentation</a> &raquo;</li>
          <li><a href="../../" >Ceph 存储集群</a> &raquo;</li>
          <li><a href="../" >Ceph 存储集群 API</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2016, Red Hat, Inc, and contributors. Licensed under Creative Commons BY-SA.
    </div>
  </body>
</html>