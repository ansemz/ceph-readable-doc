
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Hard Disk and File System Recommendations &mdash; Ceph Documentation</title>
    
    <link rel="stylesheet" href="../../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     'dev',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="top" title="Ceph Documentation" href="../../../" />
    <link rel="up" title="Configuration" href="../" />
    <link rel="next" title="Configuring Ceph" href="../ceph-conf/" />
    <link rel="prev" title="Configuration" href="../" />
    <script type="text/javascript" src="http://ayni.ceph.com/public/js/ceph.js"></script>

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../ceph-conf/" title="Configuring Ceph"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../" title="Configuration"
             accesskey="P">previous</a> |</li>
        <li><a href="../../../">Ceph Documentation</a> &raquo;</li>
          <li><a href="../../" >Ceph Storage Cluster</a> &raquo;</li>
          <li><a href="../" accesskey="U">Configuration</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="hard-disk-and-file-system-recommendations">
<h1>Hard Disk and File System Recommendations<a class="headerlink" href="#hard-disk-and-file-system-recommendations" title="Permalink to this headline">¶</a></h1>
<div class="section" id="hard-drive-prep">
<span id="index-0"></span><h2>Hard Drive Prep<a class="headerlink" href="#hard-drive-prep" title="Permalink to this headline">¶</a></h2>
<p>Ceph aims for data safety, which means that when the <a class="reference internal" href="../../../glossary/#term-ceph-client"><em class="xref std std-term">Ceph Client</em></a>
receives notice that data was written to a storage drive, that data was actually
written to the storage drive. For old kernels (&lt;2.6.33), disable the write cache
if the journal is on a raw drive. Newer kernels should work fine.</p>
<p>Use <tt class="docutils literal"><span class="pre">hdparm</span></tt> to disable write caching on the hard disk:</p>
<div class="highlight-python"><pre>sudo hdparm -W 0 /dev/hda 0</pre>
</div>
<p>In production environments, we recommend running a <a class="reference internal" href="../../../glossary/#term-ceph-osd-daemon"><em class="xref std std-term">Ceph OSD Daemon</em></a> with
separate drives for the operating system and the data. If you run data and an
operating system on a single disk, we recommend creating a separate partition
for your data.</p>
</div>
<div class="section" id="filesystems">
<span id="index-1"></span><h2>Filesystems<a class="headerlink" href="#filesystems" title="Permalink to this headline">¶</a></h2>
<p>Ceph OSD Daemons rely heavily upon the stability and performance of the
underlying filesystem.</p>
<div class="section" id="recommended">
<h3>Recommended<a class="headerlink" href="#recommended" title="Permalink to this headline">¶</a></h3>
<p>We currently recommend <tt class="docutils literal"><span class="pre">XFS</span></tt> for production deployments.</p>
<p>We used to recommend <tt class="docutils literal"><span class="pre">btrfs</span></tt> for testing, development, and any non-critical
deployments becuase it has the most promising set of features.  However, we
now plan to avoid using a kernel file system entirely with the new BlueStore
backend.  <tt class="docutils literal"><span class="pre">btrfs</span></tt> is still supported and has a comparatively compelling
set of features, but be mindful of its stability and support status in your
Linux distribution.</p>
</div>
<div class="section" id="not-recommended">
<h3>Not recommended<a class="headerlink" href="#not-recommended" title="Permalink to this headline">¶</a></h3>
<p>We recommend <em>against</em> using <tt class="docutils literal"><span class="pre">ext4</span></tt> due to limitations in the size
of xattrs it can store, and the problems this causes with the way Ceph
handles long RADOS object names.  Although these issues will generally
not surface with Ceph clusters using only short object names (e.g., an
RBD workload that does not include long RBD image names), other users
like RGW make extensive use of long object names and can break.</p>
<p>Starting with the Jewel release, the <tt class="docutils literal"><span class="pre">ceph-osd</span></tt> daemon will refuse
to start if the configured max object name cannot be safely stored on
<tt class="docutils literal"><span class="pre">ext4</span></tt>.  If the cluster is only being used with short object names
(e.g., RBD only), you can continue using <tt class="docutils literal"><span class="pre">ext4</span></tt> by setting the
following configuration option:</p>
<div class="highlight-python"><pre>osd max object name len = 256
osd max object namespace len = 64</pre>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This may result in difficult-to-diagnose errors if you try
to use RGW or other librados clients that do not properly
handle or politely surface any resulting ENAMETOOLONG
errors.</p>
</div>
</div>
</div>
<div class="section" id="filesystem-background-info">
<h2>Filesystem Background Info<a class="headerlink" href="#filesystem-background-info" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">XFS</span></tt>, <tt class="docutils literal"><span class="pre">btrfs</span></tt> and <tt class="docutils literal"><span class="pre">ext4</span></tt> file systems provide numerous
advantages in highly scaled data storage environments when <a class="reference external" href="http://en.wikipedia.org/wiki/Comparison_of_file_systems">compared</a>
to <tt class="docutils literal"><span class="pre">ext3</span></tt>.</p>
<p><tt class="docutils literal"><span class="pre">XFS</span></tt>, <tt class="docutils literal"><span class="pre">btrfs</span></tt> and <tt class="docutils literal"><span class="pre">ext4</span></tt> are <a class="reference external" href="http://en.wikipedia.org/wiki/Journaling_file_system">journaling file systems</a>, which means that
they are more robust when recovering from crashes, power outages, etc. These
filesystems journal all of the changes they will make before performing writes.</p>
<p><tt class="docutils literal"><span class="pre">XFS</span></tt> was developed for Silicon Graphics, and is a mature and stable
filesystem. By contrast, <tt class="docutils literal"><span class="pre">btrfs</span></tt> is a relatively new file system that aims
to address the long-standing wishes of system administrators working with
large scale data storage environments. <tt class="docutils literal"><span class="pre">btrfs</span></tt> has some unique features
and advantages compared to other Linux filesystems.</p>
<p><tt class="docutils literal"><span class="pre">btrfs</span></tt> is a <a class="reference external" href="http://en.wikipedia.org/wiki/Copy-on-write">copy-on-write</a> filesystem. It supports file creation
timestamps and checksums that verify metadata integrity, so it can detect
bad copies of data and fix them with the good copies. The copy-on-write
capability means that <tt class="docutils literal"><span class="pre">btrfs</span></tt> can support snapshots that are writable.
<tt class="docutils literal"><span class="pre">btrfs</span></tt> supports transparent compression and other features.</p>
<p><tt class="docutils literal"><span class="pre">btrfs</span></tt> also incorporates multi-device management into the file system,
which enables you to support heterogeneous disk storage infrastructure,
data allocation policies. The community also aims to provide <tt class="docutils literal"><span class="pre">fsck</span></tt>,
deduplication, and data encryption support in the future.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../">
              <img class="logo" src="../../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../../">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../start/intro/">Intro to Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../start/">Installation (Quick)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../install/">Installation (Manual)</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../">Ceph Storage Cluster</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../">Configuration</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="">Disks and Filesystems</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hard-drive-prep">Hard Drive Prep</a></li>
<li class="toctree-l4"><a class="reference internal" href="#filesystems">Filesystems</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#recommended">Recommended</a></li>
<li class="toctree-l5"><a class="reference internal" href="#not-recommended">Not recommended</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#filesystem-background-info">Filesystem Background Info</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../ceph-conf/">Configuring Ceph</a></li>
<li class="toctree-l3"><a class="reference internal" href="../network-config-ref/">Network Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../auth-config-ref/">Auth Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mon-config-ref/">Monitor Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mon-lookup-dns/">Looking op Monitors through DNS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mon-osd-interaction/">Heartbeat Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../osd-config-ref/">OSD Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../filestore-config-ref/">Filestore Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../journal-ref/">Journal Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pool-pg-config-ref/">Pool, PG &amp; CRUSH Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ms-ref/">Messaging Settings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../general-config-ref/">General Settings</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../deployment/">Deployment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../operations/">Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/">Man Pages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../troubleshooting/">Troubleshooting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../api/">APIs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../cephfs/">Ceph Filesystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../rbd/rbd/">Ceph Block Device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../radosgw/">Ceph Object Gateway</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../mgr/">Ceph Manager Daemon</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api/">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../architecture/">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev/">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../release-notes/">Release Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../releases/">Ceph Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../glossary/">Glossary</a></li>
</ul>


<!-- ugly kludge to make genindex look like it's part of the toc -->
<ul style="margin-top: -10px"><li class="toctree-l1"><a class="reference internal" href="../../../genindex/">Index</a></li></ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../ceph-conf/" title="Configuring Ceph"
             >next</a> |</li>
        <li class="right" >
          <a href="../" title="Configuration"
             >previous</a> |</li>
        <li><a href="../../../">Ceph Documentation</a> &raquo;</li>
          <li><a href="../../" >Ceph Storage Cluster</a> &raquo;</li>
          <li><a href="../" >Configuration</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2016, Red Hat, Inc, and contributors. Licensed under Creative Commons BY-SA.
    </div>
  </body>
</html>