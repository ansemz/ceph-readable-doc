
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>ceph-mgr 模块开发指南 &#8212; Ceph Documentation</title>
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/js/ceph.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="ceph-mgr orchestrator 模块" href="../orchestrator_modules/" />
    <link rel="prev" title="ceph-mgr 管理员指南" href="../administrator/" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../orchestrator_modules/" title="ceph-mgr orchestrator 模块"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../administrator/" title="ceph-mgr 管理员指南"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../" accesskey="U">Ceph 管理器守护进程</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            

<div id="dev-warning" class="admonition note" style="display:none;">
  <p class="first admonition-title">Notice</p>
  <p class="last">This document is for a development version of Ceph.</p>
</div>

<div id="eol-warning" class="admonition warning" style="display:none;">
  <p class="first admonition-title">Warning</p>
  <p class="last">This document is for an unsupported version of Ceph.</p>
</div>
  <div id="docubetter" align="right" style="display:none; padding: 15px; font-weight: bold;">
    <a id="edit-on-github" href="https://github.com/ceph/ceph/edit/master/doc/mgr/modules.rst" rel="nofollow">Edit on GitHub</a> | <a href="https://pad.ceph.com/p/Report_Documentation_Bugs">Report a Documentation Bug</a>
  </div>

  
  <div class="section" id="ceph-mgr">
<span id="mgr-module-dev"></span><h1>ceph-mgr 模块开发指南<a class="headerlink" href="#ceph-mgr" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>这是开发者文档，所述的 Ceph 内部机制仅供 ceph-mgr 模块开发者使用。</p>
</div>
<div class="section" id="id1">
<h2>创建插件<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>在 pybind/mgr/ 目录下，创建一个 python 模块，在此模块内创建一个继承 <code class="docutils literal notranslate"><span class="pre">MgrModule</span></code> 的类。为了让 ceph-mgr 能探测到你的模块，你的目录必须包含一个名为 <cite>module.py</cite> 的文件。</p>
<p>需要覆盖的、最重要的方法有：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">serve</span></code> 成员函数，服务器类型的模块必须覆盖。此函数应该永远阻塞。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">notify</span></code> 成员函数，如果你的模块想对新的集群数据有所动作。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">handle_command</span></code> 成员函数，如果你的模块要暴露 CLI 命令。</p></li>
</ul>
<p>Some modules interface with external orchestrators to deploy
Ceph services.  These also inherit from <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code>, which adds
additional methods to the base <code class="docutils literal notranslate"><span class="pre">MgrModule</span></code> class.  See
<a class="reference internal" href="../orchestrator_modules/#orchestrator-modules"><span class="std std-ref">Orchestrator modules</span></a> for more on
creating these modules.</p>
</div>
<div class="section" id="id2">
<h2>安装插件<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>你自己的模块放入 <code class="docutils literal notranslate"><span class="pre">mgr</span> <span class="pre">module</span> <span class="pre">path</span></code> 配置选项所指的路径后，可以用 <code class="docutils literal notranslate"><span class="pre">ceph</span> <span class="pre">mgr</span> <span class="pre">module</span> <span class="pre">enable</span></code> 命令启用它：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ceph</span> <span class="n">mgr</span> <span class="n">module</span> <span class="n">enable</span> <span class="n">mymodule</span>
</pre></div>
</div>
<p>请注意， MgrModule 接口不稳定，所以 Ceph 树以外维护的模块用于较新或较低版本的 Ceph 时可能很容易崩溃。</p>
</div>
<div class="section" id="id3">
<h2>日志记录<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">MgrModule</span></code> instances have a <code class="docutils literal notranslate"><span class="pre">log</span></code> property which is a logger instance that
sends log messages into the Ceph logging layer where they will be recorded
in the mgr daemon’s log file.</p>
<p>Use it the same way you would any other python logger.  The python
log levels debug, info, warn, err are mapped into the Ceph
severities 20, 4, 1 and 0 respectively.</p>
</div>
<div class="section" id="exposing-commands">
<h2>Exposing commands<a class="headerlink" href="#exposing-commands" title="Permalink to this headline">¶</a></h2>
<p>Set the <code class="docutils literal notranslate"><span class="pre">COMMANDS</span></code> class attribute of your plugin to a list of dicts
like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">COMMANDS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;cmd&quot;</span><span class="p">:</span> <span class="s2">&quot;foobar name=myarg,type=CephString&quot;</span><span class="p">,</span>
        <span class="s2">&quot;desc&quot;</span><span class="p">:</span> <span class="s2">&quot;Do something awesome&quot;</span><span class="p">,</span>
        <span class="s2">&quot;perm&quot;</span><span class="p">:</span> <span class="s2">&quot;rw&quot;</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">cmd</span></code> part of each entry is parsed in the same way as internal
Ceph mon and admin socket commands (see mon/MonCommands.h in
the Ceph source for examples). Note that the “poll” field is optional,
and is set to False by default; this indicates to the <code class="docutils literal notranslate"><span class="pre">ceph</span></code> CLI
that it should call this command repeatedly and output results (see
<code class="docutils literal notranslate"><span class="pre">ceph</span> <span class="pre">-h</span></code> and its <code class="docutils literal notranslate"><span class="pre">--period</span></code> option).</p>
<p>Each command is expected to return a tuple <code class="docutils literal notranslate"><span class="pre">(retval,</span> <span class="pre">stdout,</span> <span class="pre">stderr)</span></code>.
<code class="docutils literal notranslate"><span class="pre">retval</span></code> is an integer representing a libc error code (e.g. EINVAL,
EPERM, or 0 for no error), <code class="docutils literal notranslate"><span class="pre">stdout</span></code> is a string containing any
non-error output, and <code class="docutils literal notranslate"><span class="pre">stderr</span></code> is a string containing any progress or
error explanation output.  Either or both of the two strings may be empty.</p>
<p>Implement the <code class="docutils literal notranslate"><span class="pre">handle_command</span></code> function to respond to the commands
when they are sent:</p>
<dl class="method">
<dt id="mgr_module.MgrModule.handle_command">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">handle_command</code><span class="sig-paren">(</span><em class="sig-param">inbuf</em>, <em class="sig-param">cmd</em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.handle_command" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by ceph-mgr to request the plugin to handle one
of the commands that it declared in self.COMMANDS</p>
<p>Return a status code, an output buffer, and an
output string.  The output buffer is for data results,
the output string is for informative text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inbuf</strong> (<em>str</em>) – content of any “-i &lt;file&gt;” supplied to ceph cli</p></li>
<li><p><strong>cmd</strong> (<em>dict</em>) – from Ceph’s cmdmap_t</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HandleCommandResult or a 3-tuple of (int, str, str)</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="id4">
<h2>配置选项<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>Modules can load and store configuration options using the
<code class="docutils literal notranslate"><span class="pre">set_module_option</span></code> and <code class="docutils literal notranslate"><span class="pre">get_module_option</span></code> methods.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">set_module_option</span></code> and <code class="docutils literal notranslate"><span class="pre">get_module_option</span></code> to
manage user-visible configuration options that are not blobs (like
certificates). If you want to persist module-internal data or
binary configuration data consider using the <a class="reference internal" href="#kv-store">KV store</a>.</p>
</div>
<p>You must declare your available configuration options in the
<code class="docutils literal notranslate"><span class="pre">MODULE_OPTIONS</span></code> class attribute, like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MODULE_OPTIONS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;my_option&quot;</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>If you try to use set_module_option or get_module_option on options not declared
in <code class="docutils literal notranslate"><span class="pre">MODULE_OPTIONS</span></code>, an exception will be raised.</p>
<p>You may choose to provide setter commands in your module to perform
high level validation.  Users can also modify configuration using
the normal <cite>ceph config set</cite> command, where the configuration options
for a mgr module are named like <cite>mgr/&lt;module name&gt;/&lt;option&gt;</cite>.</p>
<p>If a configuration option is different depending on which node the mgr
is running on, then use <em>localized</em> configuration (
<code class="docutils literal notranslate"><span class="pre">get_localized_module_option</span></code>, <code class="docutils literal notranslate"><span class="pre">set_localized_module_option</span></code>).
This may be necessary for options such as what address to listen on.
Localized options may also be set externally with <code class="docutils literal notranslate"><span class="pre">ceph</span> <span class="pre">config</span> <span class="pre">set</span></code>,
where they key name is like <code class="docutils literal notranslate"><span class="pre">mgr/&lt;module</span> <span class="pre">name&gt;/&lt;mgr</span> <span class="pre">id&gt;/&lt;option&gt;</span></code></p>
<p>If you need to load and store data (e.g. something larger, binary, or multiline),
use the KV store instead of configuration options (see next section).</p>
<p>Hints for using config options:</p>
<ul class="simple">
<li><p>Reads are fast: ceph-mgr keeps a local in-memory copy, so in many cases
you can just do a get_module_option every time you use a option, rather than
copying it out into a variable.</p></li>
<li><p>Writes block until the value is persisted (i.e. round trip to the monitor),
but reads from another thread will see the new value immediately.</p></li>
<li><p>If a user has used <cite>config set</cite> from the command line, then the new
value will become visible to <cite>get_module_option</cite> immediately, although the
mon-&gt;mgr update is asynchronous, so <cite>config set</cite> will return a fraction
of a second before the new value is visible on the mgr.</p></li>
<li><p>To delete a config value (i.e. revert to default), just pass <code class="docutils literal notranslate"><span class="pre">None</span></code> to
set_module_option.</p></li>
</ul>
<dl class="method">
<dt id="mgr_module.MgrModule.get_module_option">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">get_module_option</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">default=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_module_option" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the value of a persistent configuration setting</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – </p></li>
<li><p><strong>default</strong> (<em>str</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mgr_module.MgrModule.set_module_option">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">set_module_option</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">val</em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.set_module_option" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the value of a persistent configuration setting</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> (<em>str</em>) – </p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mgr_module.MgrModule.get_localized_module_option">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">get_localized_module_option</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">default=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_localized_module_option" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve localized configuration for this ceph-mgr instance
:param str key:
:param str default:
:return: str</p>
</dd></dl>

<dl class="method">
<dt id="mgr_module.MgrModule.set_localized_module_option">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">set_localized_module_option</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">val</em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.set_localized_module_option" title="Permalink to this definition">¶</a></dt>
<dd><p>Set localized configuration for this ceph-mgr instance
:param str key:
:param str val:
:return: str</p>
</dd></dl>

</div>
<div class="section" id="kv-store">
<h2>KV store<a class="headerlink" href="#kv-store" title="Permalink to this headline">¶</a></h2>
<p>Modules have access to a private (per-module) key value store, which
is implemented using the monitor’s “config-key” commands.  Use
the <code class="docutils literal notranslate"><span class="pre">set_store</span></code> and <code class="docutils literal notranslate"><span class="pre">get_store</span></code> methods to access the KV store from
your module.</p>
<p>The KV store commands work in a similar way to the configuration
commands.  Reads are fast, operating from a local cache.  Writes block
on persistence and do a round trip to the monitor.</p>
<p>This data can be access from outside of ceph-mgr using the
<code class="docutils literal notranslate"><span class="pre">ceph</span> <span class="pre">config-key</span> <span class="pre">[get|set]</span></code> commands.  Key names follow the same
conventions as configuration options.  Note that any values updated
from outside of ceph-mgr will not be seen by running modules until
the next restart.  Users should be discouraged from accessing module KV
data externally – if it is necessary for users to populate data, modules
should provide special commands to set the data via the module.</p>
<p>Use the <code class="docutils literal notranslate"><span class="pre">get_store_prefix</span></code> function to enumerate keys within
a particular prefix (i.e. all keys starting with a particular substring).</p>
<dl class="method">
<dt id="mgr_module.MgrModule.get_store">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">get_store</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">default=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_store" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a value from this module’s persistent key value store</p>
</dd></dl>

<dl class="method">
<dt id="mgr_module.MgrModule.set_store">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">set_store</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">val</em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.set_store" title="Permalink to this definition">¶</a></dt>
<dd><p>Set a value in this module’s persistent key value store.
If val is None, remove key from store</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<em>str</em>) – </p></li>
<li><p><strong>val</strong> (<em>str</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mgr_module.MgrModule.get_localized_store">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">get_localized_store</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">default=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_localized_store" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="mgr_module.MgrModule.set_localized_store">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">set_localized_store</code><span class="sig-paren">(</span><em class="sig-param">key</em>, <em class="sig-param">val</em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.set_localized_store" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="mgr_module.MgrModule.get_store_prefix">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">get_store_prefix</code><span class="sig-paren">(</span><em class="sig-param">key_prefix</em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_store_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve a dict of KV store keys to values, where the keys
have the given prefix</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key_prefix</strong> (<em>str</em>) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="id5">
<h2>访问集群数据<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>Modules have access to the in-memory copies of the Ceph cluster’s
state that the mgr maintains.  Accessor functions as exposed
as members of MgrModule.</p>
<p>Calls that access the cluster or daemon state are generally going
from Python into native C++ routines.  There is some overhead to this,
but much less than for example calling into a REST API or calling into
an SQL database.</p>
<p>There are no consistency rules about access to cluster structures or
daemon metadata.  For example, an OSD might exist in OSDMap but
have no metadata, or vice versa.  On a healthy cluster these
will be very rare transient states, but modules should be written
to cope with the possibility.</p>
<p>Note that these accessors must not be called in the modules <code class="docutils literal notranslate"><span class="pre">__init__</span></code>
function. This will result in a circular locking exception.</p>
<dl class="method">
<dt id="mgr_module.MgrModule.get">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">get</code><span class="sig-paren">(</span><em class="sig-param">data_name</em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by the plugin to fetch named cluster-wide objects from ceph-mgr.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data_name</strong> (<em>str</em>) – Valid things to fetch are osd_crush_map_text,
osd_map, osd_map_tree, osd_map_crush, config, mon_map, fs_map,
osd_metadata, pg_summary, io_rate, pg_dump, df, osd_stats,
health, mon_status, devices, device &lt;devid&gt;, pg_stats,
pool_stats, pg_ready, osd_ping_times.</p>
</dd>
</dl>
<dl class="simple">
<dt>Note:</dt><dd><p>All these structures have their own JSON representations: experiment
or look at the C++ <code class="docutils literal notranslate"><span class="pre">dump()</span></code> methods to learn about them.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mgr_module.MgrModule.get_server">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">get_server</code><span class="sig-paren">(</span><em class="sig-param">hostname</em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_server" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by the plugin to fetch metadata about a particular hostname from
ceph-mgr.</p>
<p>This is information that ceph-mgr has gleaned from the daemon metadata
reported by daemons running on a particular server.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hostname</strong> – a hostname</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mgr_module.MgrModule.list_servers">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">list_servers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.list_servers" title="Permalink to this definition">¶</a></dt>
<dd><p>Like <code class="docutils literal notranslate"><span class="pre">get_server</span></code>, but gives information about all servers (i.e. all
unique hostnames that have been mentioned in daemon metadata)</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>a list of information about all servers</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mgr_module.MgrModule.get_metadata">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">get_metadata</code><span class="sig-paren">(</span><em class="sig-param">svc_type</em>, <em class="sig-param">svc_id</em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetch the daemon metadata for a particular service.</p>
<p>ceph-mgr fetches metadata asynchronously, so are windows of time during
addition/removal of services where the metadata is not available to
modules.  <code class="docutils literal notranslate"><span class="pre">None</span></code> is returned if no metadata is available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>svc_type</strong> (<em>str</em>) – service type (e.g., ‘mds’, ‘osd’, ‘mon’)</p></li>
<li><p><strong>svc_id</strong> (<em>str</em>) – service id. convert OSD integer IDs to strings when
calling this</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>dict, or None if no metadata found</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mgr_module.MgrModule.get_daemon_status">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">get_daemon_status</code><span class="sig-paren">(</span><em class="sig-param">svc_type</em>, <em class="sig-param">svc_id</em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_daemon_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetch the latest status for a particular service daemon.</p>
<p>This method may return <code class="docutils literal notranslate"><span class="pre">None</span></code> if no status information is
available, for example because the daemon hasn’t fully started yet.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>svc_type</strong> – string (e.g., ‘rgw’)</p></li>
<li><p><strong>svc_id</strong> – string</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dict, or None if the service is not found</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mgr_module.MgrModule.get_perf_schema">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">get_perf_schema</code><span class="sig-paren">(</span><em class="sig-param">svc_type</em>, <em class="sig-param">svc_name</em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_perf_schema" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by the plugin to fetch perf counter schema info.
svc_name can be nullptr, as can svc_type, in which case
they are wildcards</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>svc_type</strong> (<em>str</em>) – </p></li>
<li><p><strong>svc_name</strong> (<em>str</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of dicts describing the counters requested</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mgr_module.MgrModule.get_counter">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">get_counter</code><span class="sig-paren">(</span><em class="sig-param">svc_type</em>, <em class="sig-param">svc_name</em>, <em class="sig-param">path</em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_counter" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by the plugin to fetch the latest performance counter data for a
particular counter on a particular service.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>svc_type</strong> (<em>str</em>) – </p></li>
<li><p><strong>svc_name</strong> (<em>str</em>) – </p></li>
<li><p><strong>path</strong> (<em>str</em>) – a period-separated concatenation of the subsystem and the
counter name, for example “mds.inodes”.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A list of two-tuples of (timestamp, value) is returned.  This may be
empty if no data is available.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mgr_module.MgrModule.get_mgr_id">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">get_mgr_id</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.get_mgr_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the name of the manager daemon where this plugin
is currently being executed (i.e. the active manager).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="id6">
<h2>暴露给健康检查<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<p>Modules can raise first class Ceph health checks, which will be reported
in the output of <code class="docutils literal notranslate"><span class="pre">ceph</span> <span class="pre">status</span></code> and in other places that report on the
cluster’s health.</p>
<p>If you use <code class="docutils literal notranslate"><span class="pre">set_health_checks</span></code> to report a problem, be sure to call
it again with an empty dict to clear your health check when the problem
goes away.</p>
<dl class="method">
<dt id="mgr_module.MgrModule.set_health_checks">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">set_health_checks</code><span class="sig-paren">(</span><em class="sig-param">checks</em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.set_health_checks" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the module’s current map of health checks.  Argument is a
dict of check names to info, in this form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s1">&#39;CHECK_FOO&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;warning&#39;</span><span class="p">,</span>           <span class="c1"># or &#39;error&#39;</span>
    <span class="s1">&#39;summary&#39;</span><span class="p">:</span> <span class="s1">&#39;summary string&#39;</span><span class="p">,</span>
    <span class="s1">&#39;count&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>                      <span class="c1"># quantify badness</span>
    <span class="s1">&#39;detail&#39;</span><span class="p">:</span> <span class="p">[</span> <span class="s1">&#39;list&#39;</span><span class="p">,</span> <span class="s1">&#39;of&#39;</span><span class="p">,</span> <span class="s1">&#39;detail&#39;</span><span class="p">,</span> <span class="s1">&#39;strings&#39;</span> <span class="p">],</span>
   <span class="p">},</span>
  <span class="s1">&#39;CHECK_BAR&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;severity&#39;</span><span class="p">:</span> <span class="s1">&#39;error&#39;</span><span class="p">,</span>
    <span class="s1">&#39;summary&#39;</span><span class="p">:</span> <span class="s1">&#39;bars are bad&#39;</span><span class="p">,</span>
    <span class="s1">&#39;detail&#39;</span><span class="p">:</span> <span class="p">[</span> <span class="s1">&#39;too hard&#39;</span> <span class="p">],</span>
  <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>list</strong> – dict of health check dicts</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="id7">
<h2>监视器挂了怎么办？<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<p>The manager daemon gets much of its state (such as the cluster maps)
from the monitor.  If the monitor cluster is inaccessible, whichever
manager was active will continue to run, with the latest state it saw
still in memory.</p>
<p>However, if you are creating a module that shows the cluster state
to the user then you may well not want to mislead them by showing
them that out of date state.</p>
<p>To check if the manager daemon currently has a connection to
the monitor cluster, use this function:</p>
<dl class="method">
<dt id="mgr_module.MgrModule.have_mon_connection">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">have_mon_connection</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.have_mon_connection" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether this ceph-mgr daemon has an open connection
to a monitor.  If it doesn’t, then it’s likely that the
information we have about the cluster is out of date,
and/or the monitor cluster is down.</p>
</dd></dl>

</div>
<div class="section" id="id8">
<h2>在模块不可运行时报告<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<p>If your module cannot be run for any reason (such as a missing dependency),
then you can report that by implementing the <code class="docutils literal notranslate"><span class="pre">can_run</span></code> function.</p>
<dl class="method">
<dt id="mgr_module.MgrModule.can_run">
<em class="property">static </em><code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">can_run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.can_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Implement this function to report whether the module’s dependencies
are met.  For example, if the module needs to import a particular
dependency to work, then use a try/except around the import at
file scope, and then report here if the import failed.</p>
<p>This will be called in a blocking way from the C++ code, so do not
do any I/O that could block in this function.</p>
<p>:return a 2-tuple consisting of a boolean and explanatory string</p>
</dd></dl>

<p>Note that this will only work properly if your module can always be imported:
if you are importing a dependency that may be absent, then do it in a
try/except block so that your module can be loaded far enough to use
<code class="docutils literal notranslate"><span class="pre">can_run</span></code> even if the dependency is absent.</p>
</div>
<div class="section" id="id9">
<h2>发出命令<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h2>
<p>A non-blocking facility is provided for sending monitor commands
to the cluster.</p>
<dl class="method">
<dt id="mgr_module.MgrModule.send_command">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">send_command</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.send_command" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by the plugin to send a command to the mon
cluster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>result</strong> (<em>CommandResult</em>) – an instance of the <code class="docutils literal notranslate"><span class="pre">CommandResult</span></code>
class, defined in the same module as MgrModule.  This acts as a
completion and stores the output of the command.  Use
<code class="docutils literal notranslate"><span class="pre">CommandResult.wait()</span></code> if you want to block on completion.</p></li>
<li><p><strong>svc_type</strong> (<em>str</em>) – </p></li>
<li><p><strong>svc_id</strong> (<em>str</em>) – </p></li>
<li><p><strong>command</strong> (<em>str</em>) – a JSON-serialized command.  This uses the same
format as the ceph command line, which is a dictionary of command
arguments, with the extra <code class="docutils literal notranslate"><span class="pre">prefix</span></code> key containing the command
name itself.  Consult MonCommands.h for available commands and
their expected arguments.</p></li>
<li><p><strong>tag</strong> (<em>str</em>) – used for nonblocking operation: when a command
completes, the <code class="docutils literal notranslate"><span class="pre">notify()</span></code> callback on the MgrModule instance is
triggered, with notify_type set to “command”, and notify_id set to
the tag of the command.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="id10">
<h2>接收通知<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h2>
<p>The manager daemon calls the <code class="docutils literal notranslate"><span class="pre">notify</span></code> function on all active modules
when certain important pieces of cluster state are updated, such as the
cluster maps.</p>
<p>The actual data is not passed into this function, rather it is a cue for
the module to go and read the relevant structure if it is interested.  Most
modules ignore most types of notification: to ignore a notification
simply return from this function without doing anything.</p>
<dl class="method">
<dt id="mgr_module.MgrModule.notify">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">notify</code><span class="sig-paren">(</span><em class="sig-param">notify_type</em>, <em class="sig-param">notify_id</em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.notify" title="Permalink to this definition">¶</a></dt>
<dd><p>Called by the ceph-mgr service to notify the Python plugin
that new state is available.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>notify_type</strong> – string indicating what kind of notification,
such as osd_map, mon_map, fs_map, mon_status,
health, pg_summary, command, service_map</p></li>
<li><p><strong>notify_id</strong> – string (may be empty) that optionally specifies
which entity is being notified about.  With
“command” notifications this is set to the tag
<code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">send_command</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="rados-cephfs">
<h2>访问 RADOS 或 CephFS<a class="headerlink" href="#rados-cephfs" title="Permalink to this headline">¶</a></h2>
<p>If you want to use the librados python API to access data stored in
the Ceph cluster, you can access the <code class="docutils literal notranslate"><span class="pre">rados</span></code> attribute of your
<code class="docutils literal notranslate"><span class="pre">MgrModule</span></code> instance.  This is an instance of <code class="docutils literal notranslate"><span class="pre">rados.Rados</span></code> which
has been constructed for you using the existing Ceph context (an internal
detail of the C++ Ceph code) of the mgr daemon.</p>
<p>Always use this specially constructed librados instance instead of
constructing one by hand.</p>
<p>Similarly, if you are using libcephfs to access the file system, then
use the libcephfs <code class="docutils literal notranslate"><span class="pre">create_with_rados</span></code> to construct it from the
<code class="docutils literal notranslate"><span class="pre">MgrModule.rados</span></code> librados instance, and thereby inherit the correct context.</p>
<p>Remember that your module may be running while other parts of the cluster
are down: do not assume that librados or libcephfs calls will return
promptly – consider whether to use timeouts or to block if the rest of
the cluster is not fully available.</p>
</div>
<div class="section" id="id11">
<h2>备用模式的实现<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h2>
<p>For some modules, it is useful to run on standby manager daemons as well
as on the active daemon.  For example, an HTTP server can usefully
serve HTTP redirect responses from the standby managers so that
the user can point his browser at any of the manager daemons without
having to worry about which one is active.</p>
<p>Standby manager daemons look for a subclass of <code class="docutils literal notranslate"><span class="pre">StandbyModule</span></code>
in each module.  If the class is not found then the module is not
used at all on standby daemons.  If the class is found, then
its <code class="docutils literal notranslate"><span class="pre">serve</span></code> method is called.  Implementations of <code class="docutils literal notranslate"><span class="pre">StandbyModule</span></code>
must inherit from <code class="docutils literal notranslate"><span class="pre">mgr_module.MgrStandbyModule</span></code>.</p>
<p>The interface of <code class="docutils literal notranslate"><span class="pre">MgrStandbyModule</span></code> is much restricted compared to
<code class="docutils literal notranslate"><span class="pre">MgrModule</span></code> – none of the Ceph cluster state is available to
the module.  <code class="docutils literal notranslate"><span class="pre">serve</span></code> and <code class="docutils literal notranslate"><span class="pre">shutdown</span></code> methods are used in the same
way as a normal module class.  The <code class="docutils literal notranslate"><span class="pre">get_active_uri</span></code> method enables
the standby module to discover the address of its active peer in
order to make redirects.  See the <code class="docutils literal notranslate"><span class="pre">MgrStandbyModule</span></code> definition
in the Ceph source code for the full list of methods.</p>
<p>For an example of how to use this interface, look at the source code
of the <code class="docutils literal notranslate"><span class="pre">dashboard</span></code> module.</p>
</div>
<div class="section" id="id12">
<h2>模块间通信<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h2>
<p>Modules can invoke member functions of other modules.</p>
<dl class="method">
<dt id="mgr_module.MgrModule.remote">
<code class="sig-prename descclassname">MgrModule.</code><code class="sig-name descname">remote</code><span class="sig-paren">(</span><em class="sig-param">module_name</em>, <em class="sig-param">method_name</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mgr_module.MgrModule.remote" title="Permalink to this definition">¶</a></dt>
<dd><p>Invoke a method on another module.  All arguments, and the return
value from the other module must be serializable.</p>
<p>Limitation: Do not import any modules within the called method.
Otherwise you will get an error in Python 2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">RuntimeError</span><span class="p">(</span><span class="s1">&#39;cannot unmarshal code objects in restricted execution mode&#39;</span><span class="p">,)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>module_name</strong> – Name of other module.  If module isn’t loaded,
an ImportError exception is raised.</p></li>
<li><p><strong>method_name</strong> – Method name.  If it does not exist, a NameError
exception is raised.</p></li>
<li><p><strong>args</strong> – Argument tuple</p></li>
<li><p><strong>kwargs</strong> – Keyword argument dict</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>RuntimeError</strong> – <strong>Any</strong> error raised within the method is converted to a RuntimeError</p></li>
<li><p><strong>ImportError</strong> – No such module</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<p>Be sure to handle <code class="docutils literal notranslate"><span class="pre">ImportError</span></code> to deal with the case that the desired
module is not enabled.</p>
<p>If the remote method raises a python exception, this will be converted
to a RuntimeError on the calling side, where the message string describes
the exception that was originally thrown.  If your logic intends
to handle certain errors cleanly, it is better to modify the remote method
to return an error value instead of raising an exception.</p>
<p>At time of writing, inter-module calls are implemented without
copies or serialization, so when you return a python object, you’re
returning a reference to that object to the calling module.  It
is recommend <em>not</em> to rely on this reference passing, as in future the
implementation may change to serialize arguments and return
values.</p>
</div>
<div class="section" id="id13">
<h2>日志记录<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h2>
<p>Use your module’s <code class="docutils literal notranslate"><span class="pre">log</span></code> attribute as your logger.  This is a logger
configured to output via the ceph logging framework, to the local ceph-mgr
log files.</p>
<p>Python log severities are mapped to ceph severities as follows:</p>
<ul class="simple">
<li><p>DEBUG is 20</p></li>
<li><p>INFO is 4</p></li>
<li><p>WARN is 1</p></li>
<li><p>ERR is 0</p></li>
</ul>
</div>
<div class="section" id="id14">
<h2>干净地关闭<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h2>
<p>If a module implements the <code class="docutils literal notranslate"><span class="pre">serve()</span></code> method, it should also implement
the <code class="docutils literal notranslate"><span class="pre">shutdown()</span></code> method to shutdown cleanly: misbehaving modules
may otherwise prevent clean shutdown of ceph-mgr.</p>
</div>
<div class="section" id="id15">
<h2>局限性<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h2>
<p>It is not possible to call back into C++ code from a module’s
<code class="docutils literal notranslate"><span class="pre">__init__()</span></code> method.  For example calling <code class="docutils literal notranslate"><span class="pre">self.get_module_option()</span></code> at
this point will result in an assertion failure in ceph-mgr.  For modules
that implement the <code class="docutils literal notranslate"><span class="pre">serve()</span></code> method, it usually makes sense to do most
initialization inside that method instead.</p>
</div>
<div class="section" id="id16">
<h2>还有未竟事宜否？<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h2>
<p>The ceph-mgr python interface is not set in stone.  If you have a need
that is not satisfied by the current interface, please bring it up
on the ceph-devel mailing list.  While it is desired to avoid bloating
the interface, it is not generally very hard to expose existing data
to the Python code when there is a good reason.</p>
</div>
</div>



          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../start/intro/">Ceph 简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/">安装 Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cephadm/">Cephadm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rados/">Ceph 存储集群</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cephfs/">Ceph 文件系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rbd/">Ceph 块设备</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../radosgw/">Ceph 对象网关</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">Ceph 管理器守护进程</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../administrator/">安装和配置</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">模块编程</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">创建插件</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">安装插件</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">日志记录</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exposing-commands">Exposing commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">配置选项</a></li>
<li class="toctree-l3"><a class="reference internal" href="#kv-store">KV store</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">访问集群数据</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">暴露给健康检查</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">监视器挂了怎么办？</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">在模块不可运行时报告</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">发出命令</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">接收通知</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rados-cephfs">访问 RADOS 或 CephFS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">备用模式的实现</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">模块间通信</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id13">日志记录</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id14">干净地关闭</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id15">局限性</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id16">还有未竟事宜否？</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../orchestrator_modules/">编写 orchestrator 插件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dashboard/">仪表盘模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alerts/">Alerts 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../diskprediction/">DiskPrediction 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../localpool/">localpool 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../restful/">REST 风格模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../zabbix/">Zabbix 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prometheus/">Prometheus 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../influx/">Influx 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hello/">Hello 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../telegraf/">Telegraf 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../telemetry/">Telemetry 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iostat/">Iostat 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../osd_support/">OSD Support 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../crash/">Crash 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../insights/">Insights 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../orchestrator/">Orchestrator 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rook/">Rook 模块</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dashboard/">Ceph 仪表盘</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/">API 文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture/">体系结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/developer_guide/">开发者指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/internals/">Ceph 内幕</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../governance/">项目管理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../foundation/">Ceph 基金会</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ceph-volume/">ceph-volume</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/general/">Ceph 版本（总目录）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/">Ceph 版本（索引）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary/">Ceph 术语</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../translation_cn/">中文版翻译资源</a></li>
</ul>


<!-- ugly kludge to make genindex look like it's part of the toc -->
<ul style="margin-top: -10px"><li class="toctree-l1"><a class="reference internal" href="../../genindex/">Index</a></li></ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search/" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../orchestrator_modules/" title="ceph-mgr orchestrator 模块"
             >next</a> |</li>
        <li class="right" >
          <a href="../administrator/" title="ceph-mgr 管理员指南"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../" >Ceph 管理器守护进程</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Ceph authors and contributors. Licensed under Creative Commons Attribution Share Alike 3.0 (CC-BY-SA-3.0).
    </div>
  </body>
</html>