
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>ceph-mgr orchestrator 模块 &#8212; Ceph Documentation</title>
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/js/ceph.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="Ceph 仪表盘" href="../dashboard/" />
    <link rel="prev" title="ceph-mgr 模块开发指南" href="../modules/" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../dashboard/" title="Ceph 仪表盘"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../modules/" title="ceph-mgr 模块开发指南"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../" accesskey="U">Ceph 管理器守护进程</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            

<div id="dev-warning" class="admonition note" style="display:none;">
  <p class="first admonition-title">Notice</p>
  <p class="last">This document is for a development version of Ceph.</p>
</div>

<div id="eol-warning" class="admonition warning" style="display:none;">
  <p class="first admonition-title">Warning</p>
  <p class="last">This document is for an unsupported version of Ceph.</p>
</div>
  <div id="docubetter" align="right" style="display:none; padding: 15px; font-weight: bold;">
    <a id="edit-on-github" href="https://github.com/ceph/ceph/edit/master/doc/mgr/orchestrator_modules.rst" rel="nofollow">Edit on GitHub</a> | <a href="https://pad.ceph.com/p/Report_Documentation_Bugs">Report a Documentation Bug</a>
  </div>

  
  <div class="section" id="ceph-mgr-orchestrator">
<span id="orchestrator-modules"></span><h1>ceph-mgr orchestrator 模块<a class="headerlink" href="#ceph-mgr-orchestrator" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>这是开发者文档，描述的是 Ceph 内部机制，仅适用于编写
ceph-mgr orchestrator 模块的人们。</p>
</div>
<p>In this context, <em>orchestrator</em> refers to some external service that
provides the ability to discover devices and create Ceph services.  This
includes external projects such as ceph-ansible, DeepSea, and Rook.</p>
<p>An <em>orchestrator module</em> is a ceph-mgr module (<a class="reference internal" href="../modules/#mgr-module-dev"><span class="std std-ref">ceph-mgr 模块开发指南</span></a>)
which implements common management operations using a particular
orchestrator.</p>
<p>Orchestrator modules subclass the <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> class: this class is
an interface, it only provides method definitions to be implemented
by subclasses.  The purpose of defining this common interface
for different orchestrators is to enable common UI code, such as
the dashboard, to work with various different backends.</p>
<div class="graphviz"><object data="../../_images/graphviz-01b439e673e075fe481154e92bd10b86897ecd6f.svg" type="image/svg+xml" class="graphviz">
<p class="warning">digraph G {
    subgraph cluster_1 {
        volumes [label=&quot;mgr/volumes&quot;]
        rook [label=&quot;mgr/rook&quot;]
        dashboard [label=&quot;mgr/dashboard&quot;]
        orchestrator_cli [label=&quot;mgr/orchestrator&quot;]
        orchestrator [label=&quot;Orchestrator Interface&quot;]
        cephadm [label=&quot;mgr/cephadm&quot;]

        label = &quot;ceph-mgr&quot;;
    }

    volumes -&gt; orchestrator
    dashboard -&gt; orchestrator
    orchestrator_cli -&gt; orchestrator
    orchestrator -&gt; rook -&gt; rook_io
    orchestrator -&gt; cephadm


    rook_io [label=&quot;Rook&quot;]

    rankdir=&quot;TB&quot;;
}</p></object></div>
<p>Behind all the abstraction, the purpose of orchestrator modules is simple:
enable Ceph to do things like discover available hardware, create and
destroy OSDs, and run MDS and RGW services.</p>
<p>A tutorial is not included here: for full and concrete examples, see
the existing implemented orchestrator modules in the Ceph source tree.</p>
<div class="section" id="id1">
<h2>术语<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>Stateful service</dt><dd><p>a daemon that uses local storage, such as OSD or mon.</p>
</dd>
<dt>Stateless service</dt><dd><p>a daemon that doesn’t use any local storage, such
as an MDS, RGW, nfs-ganesha, iSCSI gateway.</p>
</dd>
<dt>Label</dt><dd><p>arbitrary string tags that may be applied by administrators
to nodes.  Typically administrators use labels to indicate
which nodes should run which kinds of service.  Labels are
advisory (from human input) and do not guarantee that nodes
have particular physical capabilities.</p>
</dd>
<dt>Drive group</dt><dd><p>collection of block devices with common/shared OSD
formatting (typically one or more SSDs acting as
journals/dbs for a group of HDDs).</p>
</dd>
<dt>Placement</dt><dd><p>choice of which node is used to run a service.</p>
</dd>
</dl>
</div>
<div class="section" id="id2">
<h2>关键概念<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>The underlying orchestrator remains the source of truth for information
about whether a service is running, what is running where, which
nodes are available, etc.  Orchestrator modules should avoid taking
any internal copies of this information, and read it directly from
the orchestrator backend as much as possible.</p>
<p>Bootstrapping nodes and adding them to the underlying orchestration
system is outside the scope of Ceph’s orchestrator interface.  Ceph
can only work on nodes when the orchestrator is already aware of them.</p>
<p>Calls to orchestrator modules are all asynchronous, and return <em>completion</em>
objects (see below) rather than returning values immediately.</p>
<p>Where possible, placement of stateless services should be left up to the
orchestrator.</p>
</div>
<div class="section" id="completions-and-batching">
<h2>Completions and batching<a class="headerlink" href="#completions-and-batching" title="Permalink to this headline">¶</a></h2>
<p>All methods that read or modify the state of the system can potentially
be long running.  To handle that, all such methods return a <em>Completion</em>
object.  Orchestrator modules
must implement the <em>process</em> method: this takes a list of completions, and
is responsible for checking if they’re finished, and advancing the underlying
operations as needed.</p>
<p>Each orchestrator module implements its own underlying mechanisms
for completions.  This might involve running the underlying operations
in threads, or batching the operations up before later executing
in one go in the background.  If implementing such a batching pattern, the
module would do no work on any operation until it appeared in a list
of completions passed into <em>process</em>.</p>
<p>Some operations need to show a progress. Those operations need to add
a <em>ProgressReference</em> to the completion. At some point, the progress reference
becomes <em>effective</em>, meaning that the operation has really happened
(e.g. a service has actually been started).</p>
<dl class="method">
<dt id="orchestrator.Orchestrator.process">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">process</code><span class="sig-paren">(</span><em class="sig-param">completions</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.process" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of Completion instances, process any which are
incomplete.</p>
<p>Callers should inspect the detail of each completion to identify
partial completion/progress information, and present that information
to the user.</p>
<p>This method should not block, as this would make it slow to query
a status, while other long running operations are in progress.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="orchestrator.Completion">
<em class="property">class </em><code class="sig-prename descclassname">orchestrator.</code><code class="sig-name descname">Completion</code><span class="sig-paren">(</span><em class="sig-param">_first_promise=None</em>, <em class="sig-param">value=&lt;object object&gt;</em>, <em class="sig-param">on_complete=None</em>, <em class="sig-param">name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Completion" title="Permalink to this definition">¶</a></dt>
<dd><p>Combines multiple promises into one overall operation.</p>
<p>Completions are composable by being able to
call one completion from another completion. I.e. making them re-usable
using Promises E.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span>
<span class="gp">... </span><span class="k">return</span> <span class="n">Orchestrator</span><span class="p">()</span><span class="o">.</span><span class="n">get_hosts</span><span class="p">()</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_create_osd</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">get_hosts</span></code> returns a Completion of list of hosts and
<code class="docutils literal notranslate"><span class="pre">_create_osd</span></code> takes a list of hosts.</p>
<p>The concept behind this is to store the computation steps
explicit and then explicitly evaluate the chain:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span>
<span class="gp">... </span><span class="n">p</span> <span class="o">=</span> <span class="n">Completion</span><span class="p">(</span><span class="n">on_complete</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">on_complete</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">... </span><span class="n">p</span><span class="o">.</span><span class="n">finalize</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span><span class="k">assert</span> <span class="n">p</span><span class="o">.</span><span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;4&quot;</span>
</pre></div>
</div>
<p>or graphically:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">+---------------+</span>      <span class="o">+-----------------+</span>
<span class="o">|</span>               <span class="o">|</span> <span class="n">then</span> <span class="o">|</span>                 <span class="o">|</span>
<span class="o">|</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="n">x</span> <span class="o">|</span> <span class="o">+--&gt;</span> <span class="o">|</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">|</span>
<span class="o">|</span>               <span class="o">|</span>      <span class="o">|</span>                 <span class="o">|</span>
<span class="o">+---------------+</span>      <span class="o">+-----------------+</span>
</pre></div>
</div>
<dl class="method">
<dt id="orchestrator.Completion.fail">
<code class="sig-name descname">fail</code><span class="sig-paren">(</span><em class="sig-param">e</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Completion.fail" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the whole completion to be faild with this exception and end the
evaluation.</p>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Completion.has_result">
<em class="property">property </em><code class="sig-name descname">has_result</code><a class="headerlink" href="#orchestrator.Completion.has_result" title="Permalink to this definition">¶</a></dt>
<dd><p>Has the operation already a result?</p>
<p>For Write operations, it can already have a
result, if the orchestrator’s configuration is
persistently written. Typically this would
indicate that an update had been written to
a manifest, but that the update had not
necessarily been pushed out to the cluster.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Completion.is_errored">
<em class="property">property </em><code class="sig-name descname">is_errored</code><a class="headerlink" href="#orchestrator.Completion.is_errored" title="Permalink to this definition">¶</a></dt>
<dd><p>Has the completion failed. Default implementation looks for
self.exception. Can be overwritten.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Completion.is_finished">
<em class="property">property </em><code class="sig-name descname">is_finished</code><a class="headerlink" href="#orchestrator.Completion.is_finished" title="Permalink to this definition">¶</a></dt>
<dd><p>Could the external operation be deemed as complete,
or should we wait?
We must wait for a read operation only if it is not complete.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Completion.needs_result">
<em class="property">property </em><code class="sig-name descname">needs_result</code><a class="headerlink" href="#orchestrator.Completion.needs_result" title="Permalink to this definition">¶</a></dt>
<dd><p>Could the external operation be deemed as complete,
or should we wait?
We must wait for a read operation only if it is not complete.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Completion.progress_reference">
<em class="property">property </em><code class="sig-name descname">progress_reference</code><a class="headerlink" href="#orchestrator.Completion.progress_reference" title="Permalink to this definition">¶</a></dt>
<dd><p>ProgressReference. Marks this completion
as a write completeion.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">ProgressReference</span></code>]</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Completion.result">
<em class="property">property </em><code class="sig-name descname">result</code><a class="headerlink" href="#orchestrator.Completion.result" title="Permalink to this definition">¶</a></dt>
<dd><p>The result of the operation that we were waited
for.  Only valid after calling Orchestrator.process() on this
completion.</p>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Completion.result_str">
<code class="sig-name descname">result_str</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Completion.result_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Force a string.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="orchestrator.ProgressReference">
<em class="property">class </em><code class="sig-prename descclassname">orchestrator.</code><code class="sig-name descname">ProgressReference</code><span class="sig-paren">(</span><em class="sig-param">message</em>, <em class="sig-param">mgr</em>, <em class="sig-param">completion=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.ProgressReference" title="Permalink to this definition">¶</a></dt>
<dd><dl class="attribute">
<dt id="orchestrator.ProgressReference.completion">
<code class="sig-name descname">completion</code><em class="property">: Optional[Callable[[], Completion]]</em><em class="property"> = None</em><a class="headerlink" href="#orchestrator.ProgressReference.completion" title="Permalink to this definition">¶</a></dt>
<dd><p>The completion can already have a result, before the write
operation is effective. progress == 1 means, the services are
created / removed.</p>
</dd></dl>

<dl class="method">
<dt id="orchestrator.ProgressReference.progress">
<em class="property">property </em><code class="sig-name descname">progress</code><a class="headerlink" href="#orchestrator.ProgressReference.progress" title="Permalink to this definition">¶</a></dt>
<dd><p>if a orchestrator module can provide a more detailed
progress information, it needs to also call <code class="docutils literal notranslate"><span class="pre">progress.update()</span></code>.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="id3">
<h2>错误处理<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>The main goal of error handling within orchestrator modules is to provide debug information to
assist users when dealing with deployment errors.</p>
<dl class="class">
<dt id="orchestrator.OrchestratorError">
<em class="property">class </em><code class="sig-prename descclassname">orchestrator.</code><code class="sig-name descname">OrchestratorError</code><a class="headerlink" href="#orchestrator.OrchestratorError" title="Permalink to this definition">¶</a></dt>
<dd><p>General orchestrator specific error.</p>
<p>Used for deployment, configuration or user errors.</p>
<p>It’s not intended for programming errors or orchestrator internal errors.</p>
</dd></dl>

<dl class="class">
<dt id="orchestrator.NoOrchestrator">
<em class="property">class </em><code class="sig-prename descclassname">orchestrator.</code><code class="sig-name descname">NoOrchestrator</code><span class="sig-paren">(</span><em class="sig-param">msg='No orchestrator configured (try `ceph orch set backend`)'</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.NoOrchestrator" title="Permalink to this definition">¶</a></dt>
<dd><p>No orchestrator in configured.</p>
</dd></dl>

<dl class="class">
<dt id="orchestrator.OrchestratorValidationError">
<em class="property">class </em><code class="sig-prename descclassname">orchestrator.</code><code class="sig-name descname">OrchestratorValidationError</code><a class="headerlink" href="#orchestrator.OrchestratorValidationError" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when an orchestrator doesn’t support a specific feature.</p>
</dd></dl>

<p>In detail, orchestrators need to explicitly deal with different kinds of errors:</p>
<ol class="arabic">
<li><p>No orchestrator configured</p>
<p>See <a class="reference internal" href="#orchestrator.NoOrchestrator" title="orchestrator.NoOrchestrator"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoOrchestrator</span></code></a>.</p>
</li>
<li><p>An orchestrator doesn’t implement a specific method.</p>
<p>For example, an Orchestrator doesn’t support <code class="docutils literal notranslate"><span class="pre">add_host</span></code>.</p>
<p>In this case, a <code class="docutils literal notranslate"><span class="pre">NotImplementedError</span></code> is raised.</p>
</li>
<li><p>Missing features within implemented methods.</p>
<p>E.g. optional parameters to a command that are not supported by the
backend (e.g. the hosts field in <code class="xref py py-func docutils literal notranslate"><span class="pre">Orchestrator.update_mons()</span></code> command with the rook backend).</p>
<p>See <a class="reference internal" href="#orchestrator.OrchestratorValidationError" title="orchestrator.OrchestratorValidationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrchestratorValidationError</span></code></a>.</p>
</li>
<li><p>Input validation errors</p>
<p>The <code class="docutils literal notranslate"><span class="pre">orchestrator_cli</span></code> module and other calling modules are supposed to
provide meaningful error messages.</p>
<p>See <a class="reference internal" href="#orchestrator.OrchestratorValidationError" title="orchestrator.OrchestratorValidationError"><code class="xref py py-class docutils literal notranslate"><span class="pre">OrchestratorValidationError</span></code></a>.</p>
</li>
<li><p>Errors when actually executing commands</p>
<p>The resulting Completion should contain an error string that assists in understanding the
problem. In addition, <code class="xref py py-func docutils literal notranslate"><span class="pre">_Completion.is_errored()</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</li>
<li><p>Invalid configuration in the orchestrator modules</p>
<p>This can be tackled similar to 5.</p>
</li>
</ol>
<p>All other errors are unexpected orchestrator issues and thus should raise an exception that are then
logged into the mgr log file. If there is a completion object at that point,
<code class="xref py py-func docutils literal notranslate"><span class="pre">_Completion.result()</span></code> may contain an error message.</p>
</div>
<div class="section" id="id4">
<h2>排除的功能<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Ceph’s orchestrator interface is not a general purpose framework for
managing linux servers – it is deliberately constrained to manage
the Ceph cluster’s services only.</p></li>
<li><p>Multipathed storage is not handled (multipathing is unnecessary for
Ceph clusters).  Each drive is assumed to be visible only on
a single node.</p></li>
</ul>
</div>
<div class="section" id="id5">
<h2>主机管理<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<dl class="method">
<dt id="orchestrator.Orchestrator.add_host">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">add_host</code><span class="sig-paren">(</span><em class="sig-param">host_spec</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.add_host" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a host to the orchestrator inventory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>host</strong> – hostname</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.remove_host">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">remove_host</code><span class="sig-paren">(</span><em class="sig-param">host</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.remove_host" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a host from the orchestrator inventory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>host</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – hostname</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.get_hosts">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">get_hosts</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.get_hosts" title="Permalink to this definition">¶</a></dt>
<dd><p>Report the hosts in the cluster.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of HostSpec</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.update_host_addr">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">update_host_addr</code><span class="sig-paren">(</span><em class="sig-param">host</em>, <em class="sig-param">addr</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.update_host_addr" title="Permalink to this definition">¶</a></dt>
<dd><p>Update a host’s address</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>host</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – hostname</p></li>
<li><p><strong>addr</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – address (dns name or IP)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.add_host_label">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">add_host_label</code><span class="sig-paren">(</span><em class="sig-param">host</em>, <em class="sig-param">label</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.add_host_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a host label</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.remove_host_label">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">remove_host_label</code><span class="sig-paren">(</span><em class="sig-param">host</em>, <em class="sig-param">label</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.remove_host_label" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a host label</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="orchestrator.HostSpec">
<em class="property">class </em><code class="sig-prename descclassname">orchestrator.</code><code class="sig-name descname">HostSpec</code><span class="sig-paren">(</span><em class="sig-param">hostname</em>, <em class="sig-param">addr=None</em>, <em class="sig-param">labels=None</em>, <em class="sig-param">status=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.HostSpec" title="Permalink to this definition">¶</a></dt>
<dd><p>Information about hosts. Like e.g. <code class="docutils literal notranslate"><span class="pre">kubectl</span> <span class="pre">get</span> <span class="pre">nodes</span></code></p>
</dd></dl>

</div>
<div class="section" id="id6">
<h2>设备<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h2>
<dl class="method">
<dt id="orchestrator.Orchestrator.get_inventory">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">get_inventory</code><span class="sig-paren">(</span><em class="sig-param">host_filter=None</em>, <em class="sig-param">refresh=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.get_inventory" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns something that was created by <cite>ceph-volume inventory</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of InventoryHost</p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="orchestrator.InventoryFilter">
<em class="property">class </em><code class="sig-prename descclassname">orchestrator.</code><code class="sig-name descname">InventoryFilter</code><span class="sig-paren">(</span><em class="sig-param">labels=None</em>, <em class="sig-param">hosts=None</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.InventoryFilter" title="Permalink to this definition">¶</a></dt>
<dd><p>When fetching inventory, use this filter to avoid unnecessarily
scanning the whole estate.</p>
<dl class="simple">
<dt>Typical use: filter by host when presenting UI workflow for configuring</dt><dd><p>a particular server.
filter by label when not all of estate is Ceph servers,
and we want to only learn about the Ceph servers.
filter by label when we are interested particularly
in e.g. OSD servers.</p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="ceph.deployment.inventory.Devices">
<em class="property">class </em><code class="sig-prename descclassname">ceph.deployment.inventory.</code><code class="sig-name descname">Devices</code><span class="sig-paren">(</span><em class="sig-param">devices</em><span class="sig-paren">)</span><a class="headerlink" href="#ceph.deployment.inventory.Devices" title="Permalink to this definition">¶</a></dt>
<dd><p>A container for Device instances with reporting</p>
</dd></dl>

<dl class="class">
<dt id="ceph.deployment.inventory.Device">
<em class="property">class </em><code class="sig-prename descclassname">ceph.deployment.inventory.</code><code class="sig-name descname">Device</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">sys_api=None</em>, <em class="sig-param">available=None</em>, <em class="sig-param">rejected_reasons=None</em>, <em class="sig-param">lvs=None</em>, <em class="sig-param">device_id=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ceph.deployment.inventory.Device" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="placement">
<h2>Placement<a class="headerlink" href="#placement" title="Permalink to this headline">¶</a></h2>
<p>A <a class="reference internal" href="../orchestrator/#orchestrator-cli-placement-spec"><span class="std std-ref">Placement Specification</span></a> defines the placement of
daemons of a specifc service.</p>
<p>In general, stateless services do not require any specific placement
rules as they can run anywhere that sufficient system resources
are available. However, some orchestrators may not include the
functionality to choose a location in this way. Optionally, you can
specify a location when creating a stateless service.</p>
<dl class="class">
<dt id="ceph.deployment.service_spec.PlacementSpec">
<em class="property">class </em><code class="sig-prename descclassname">ceph.deployment.service_spec.</code><code class="sig-name descname">PlacementSpec</code><span class="sig-paren">(</span><em class="sig-param">label=None</em>, <em class="sig-param">hosts=None</em>, <em class="sig-param">count=None</em>, <em class="sig-param">host_pattern=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ceph.deployment.service_spec.PlacementSpec" title="Permalink to this definition">¶</a></dt>
<dd><p>For APIs that need to specify a host subset</p>
<dl class="method">
<dt id="ceph.deployment.service_spec.PlacementSpec.from_string">
<em class="property">classmethod </em><code class="sig-name descname">from_string</code><span class="sig-paren">(</span><em class="sig-param">arg</em><span class="sig-paren">)</span><a class="headerlink" href="#ceph.deployment.service_spec.PlacementSpec.from_string" title="Permalink to this definition">¶</a></dt>
<dd><p>A single integer is parsed as a count:
&gt;&gt;&gt; PlacementSpec.from_string(‘3’)
PlacementSpec(count=3)</p>
<p>A list of names is parsed as host specifications:
&gt;&gt;&gt; PlacementSpec.from_string(‘host1 host2’)
PlacementSpec(hosts=[HostPlacementSpec(hostname=’host1’, network=’’, name=’’), HostPlacementSpec(hostname=’host2’, network=’’, name=’’)])</p>
<p>You can also prefix the hosts with a count as follows:
&gt;&gt;&gt; PlacementSpec.from_string(‘2 host1 host2’)
PlacementSpec(count=2, hosts=[HostPlacementSpec(hostname=’host1’, network=’’, name=’’), HostPlacementSpec(hostname=’host2’, network=’’, name=’’)])</p>
<p>You can spefify labels using <cite>label:&lt;label&gt;</cite>
&gt;&gt;&gt; PlacementSpec.from_string(‘label:mon’)
PlacementSpec(label=’mon’)</p>
<p>Labels als support a count:
&gt;&gt;&gt; PlacementSpec.from_string(‘3 label:mon’)
PlacementSpec(count=3, label=’mon’)</p>
<p>fnmatch is also supported:
&gt;&gt;&gt; PlacementSpec.from_string(‘data[1-3]’)
PlacementSpec(host_pattern=’data[1-3]’)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">PlacementSpec</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="go">PlacementSpec()</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#ceph.deployment.service_spec.PlacementSpec" title="ceph.deployment.service_spec.PlacementSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">PlacementSpec</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="ceph.deployment.service_spec.PlacementSpec.host_pattern">
<code class="sig-name descname">host_pattern</code><em class="property">: Optional[str]</em><em class="property"> = None</em><a class="headerlink" href="#ceph.deployment.service_spec.PlacementSpec.host_pattern" title="Permalink to this definition">¶</a></dt>
<dd><p>fnmatch patterns to select hosts. Can also be a single host.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="id7">
<h2>服务<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="orchestrator.ServiceDescription">
<em class="property">class </em><code class="sig-prename descclassname">orchestrator.</code><code class="sig-name descname">ServiceDescription</code><span class="sig-paren">(</span><em class="sig-param">spec</em>, <em class="sig-param">container_image_id=None</em>, <em class="sig-param">container_image_name=None</em>, <em class="sig-param">rados_config_location=None</em>, <em class="sig-param">service_url=None</em>, <em class="sig-param">last_refresh=None</em>, <em class="sig-param">created=None</em>, <em class="sig-param">size=0</em>, <em class="sig-param">running=0</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.ServiceDescription" title="Permalink to this definition">¶</a></dt>
<dd><p>For responding to queries about the status of a particular service,
stateful or stateless.</p>
<p>This is not about health or performance monitoring of services: it’s
about letting the orchestrator tell Ceph whether and where a
service is scheduled in the cluster.  When an orchestrator tells
Ceph “it’s running on host123”, that’s not a promise that the process
is literally up this second, it’s a description of where the orchestrator
has decided the service should run.</p>
</dd></dl>

<dl class="class">
<dt id="ceph.deployment.service_spec.ServiceSpec">
<em class="property">class </em><code class="sig-prename descclassname">ceph.deployment.service_spec.</code><code class="sig-name descname">ServiceSpec</code><span class="sig-paren">(</span><em class="sig-param">service_type</em>, <em class="sig-param">service_id=None</em>, <em class="sig-param">placement=None</em>, <em class="sig-param">count=None</em>, <em class="sig-param">unmanaged=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ceph.deployment.service_spec.ServiceSpec" title="Permalink to this definition">¶</a></dt>
<dd><p>Details of service creation.</p>
<p>Request to the orchestrator for a cluster of daemons
such as MDS, RGW, iscsi gateway, MONs, MGRs, Prometheus</p>
<p>This structure is supposed to be enough information to
start the services.</p>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.describe_service">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">describe_service</code><span class="sig-paren">(</span><em class="sig-param">service_type=None</em>, <em class="sig-param">service_name=None</em>, <em class="sig-param">refresh=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.describe_service" title="Permalink to this definition">¶</a></dt>
<dd><p>Describe a service (of any kind) that is already configured in
the orchestrator.  For example, when viewing an OSD in the dashboard
we might like to also display information about the orchestrator’s
view of the service (like the kubernetes pod ID).</p>
<p>When viewing a CephFS filesystem in the dashboard, we would use this
to display the pods being currently run for MDS daemons.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of ServiceDescription objects.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.service_action">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">service_action</code><span class="sig-paren">(</span><em class="sig-param">action</em>, <em class="sig-param">service_name</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.service_action" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an action (start/stop/reload) on a service (i.e., all daemons
providing the logical service).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – one of “start”, “stop”, “restart”, “redeploy”, “reconfig”</p></li>
<li><p><strong>service_type</strong> – e.g. “mds”, “rgw”, …</p></li>
<li><p><strong>service_name</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – name of logical service (“cephfs”, “us-east”, …)</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#orchestrator.Completion" title="orchestrator.Completion">Completion</a></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.remove_service">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">remove_service</code><span class="sig-paren">(</span><em class="sig-param">service_name</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.remove_service" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a service (a collection of daemons).</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="id8">
<h2>守护进程<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h2>
<dl class="method">
<dt id="orchestrator.Orchestrator.list_daemons">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">list_daemons</code><span class="sig-paren">(</span><em class="sig-param">service_name=None</em>, <em class="sig-param">daemon_type=None</em>, <em class="sig-param">daemon_id=None</em>, <em class="sig-param">host=None</em>, <em class="sig-param">refresh=False</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.list_daemons" title="Permalink to this definition">¶</a></dt>
<dd><p>Describe a daemon (of any kind) that is already configured in
the orchestrator.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of DaemonDescription objects.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.remove_daemons">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">remove_daemons</code><span class="sig-paren">(</span><em class="sig-param">names</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.remove_daemons" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove specific daemon(s).</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.daemon_action">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">daemon_action</code><span class="sig-paren">(</span><em class="sig-param">action</em>, <em class="sig-param">daemon_type</em>, <em class="sig-param">daemon_id</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.daemon_action" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform an action (start/stop/reload) on a daemon.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – one of “start”, “stop”, “restart”, “redeploy”, “reconfig”</p></li>
<li><p><strong>name</strong> – name of daemon</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#orchestrator.Completion" title="orchestrator.Completion">Completion</a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="osd">
<h2>OSD 管理<a class="headerlink" href="#osd" title="Permalink to this headline">¶</a></h2>
<dl class="method">
<dt id="orchestrator.Orchestrator.create_osds">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">create_osds</code><span class="sig-paren">(</span><em class="sig-param">drive_group</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.create_osds" title="Permalink to this definition">¶</a></dt>
<dd><p>Create one or more OSDs within a single Drive Group.</p>
<p>The principal argument here is the drive_group member
of OsdSpec: other fields are advisory/extensible for any
finer-grained OSD feature enablement (choice of backing store,
compression/encryption, etc).</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.blink_device_light">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">blink_device_light</code><span class="sig-paren">(</span><em class="sig-param">ident_fault</em>, <em class="sig-param">on</em>, <em class="sig-param">locations</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.blink_device_light" title="Permalink to this definition">¶</a></dt>
<dd><p>Instructs the orchestrator to enable or disable either the ident or the fault LED.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ident_fault</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>) – either <code class="docutils literal notranslate"><span class="pre">&quot;ident&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;fault&quot;</span></code></p></li>
<li><p><strong>on</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>) – <code class="docutils literal notranslate"><span class="pre">True</span></code> = on.</p></li>
<li><p><strong>locations</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">DeviceLightLoc</span></code>]) – See <a class="reference internal" href="#orchestrator.DeviceLightLoc" title="orchestrator.DeviceLightLoc"><code class="xref py py-class docutils literal notranslate"><span class="pre">orchestrator.DeviceLightLoc</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="orchestrator.DeviceLightLoc">
<em class="property">class </em><code class="sig-prename descclassname">orchestrator.</code><code class="sig-name descname">DeviceLightLoc</code><a class="headerlink" href="#orchestrator.DeviceLightLoc" title="Permalink to this definition">¶</a></dt>
<dd><p>Describes a specific device on a specific host. Used for enabling or disabling LEDs
on devices.</p>
<p>hostname as in <a class="reference internal" href="#orchestrator.Orchestrator.get_hosts" title="orchestrator.Orchestrator.get_hosts"><code class="xref py py-func docutils literal notranslate"><span class="pre">orchestrator.Orchestrator.get_hosts()</span></code></a></p>
<dl class="simple">
<dt>device_id: e.g. <code class="docutils literal notranslate"><span class="pre">ABC1234DEF567-1R1234_ABC8DE0Q</span></code>.</dt><dd><p>See <code class="docutils literal notranslate"><span class="pre">ceph</span> <span class="pre">osd</span> <span class="pre">metadata</span> <span class="pre">|</span> <span class="pre">jq</span> <span class="pre">'.[].device_ids'</span></code></p>
</dd>
</dl>
</dd></dl>

<div class="section" id="orchestrator-osd-replace">
<span id="id9"></span><h3>OSD 替换<a class="headerlink" href="#orchestrator-osd-replace" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference internal" href="../../rados/operations/add-or-rm-osds/#rados-replacing-an-osd"><span class="std std-ref">替换一个 OSD</span></a> for the underlying process.</p>
<p>Replacing OSDs is fundamentally a two-staged process, as users need to
physically replace drives. The orchestrator therefor exposes this two-staged process.</p>
<p>Phase one is a call to <code class="xref py py-meth docutils literal notranslate"><span class="pre">Orchestrator.remove_osds()</span></code> with <code class="docutils literal notranslate"><span class="pre">destroy=True</span></code> in order to mark
the OSD as destroyed.</p>
<p>Phase two is a call to  <a class="reference internal" href="#orchestrator.Orchestrator.create_osds" title="orchestrator.Orchestrator.create_osds"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Orchestrator.create_osds()</span></code></a> with a Drive Group with</p>
<p><a class="reference internal" href="../../cephadm/drivegroups/#ceph.deployment.drive_group.DriveGroupSpec.osd_id_claims" title="ceph.deployment.drive_group.DriveGroupSpec.osd_id_claims"><code class="xref py py-attr docutils literal notranslate"><span class="pre">DriveGroupSpec.osd_id_claims</span></code></a> set to the destroyed OSD ids.</p>
</div>
</div>
<div class="section" id="id10">
<h2>监视器<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h2>
<dl class="method">
<dt id="orchestrator.Orchestrator.add_mon">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">add_mon</code><span class="sig-paren">(</span><em class="sig-param">spec</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.add_mon" title="Permalink to this definition">¶</a></dt>
<dd><p>Create mon daemon(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.apply_mon">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">apply_mon</code><span class="sig-paren">(</span><em class="sig-param">spec</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.apply_mon" title="Permalink to this definition">¶</a></dt>
<dd><p>Update mon cluster</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="id11">
<h2>无状态服务<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h2>
<dl class="method">
<dt id="orchestrator.Orchestrator.add_mgr">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">add_mgr</code><span class="sig-paren">(</span><em class="sig-param">spec</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.add_mgr" title="Permalink to this definition">¶</a></dt>
<dd><p>Create mgr daemon(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.apply_mgr">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">apply_mgr</code><span class="sig-paren">(</span><em class="sig-param">spec</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.apply_mgr" title="Permalink to this definition">¶</a></dt>
<dd><p>Update mgr cluster</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.add_mds">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">add_mds</code><span class="sig-paren">(</span><em class="sig-param">spec</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.add_mds" title="Permalink to this definition">¶</a></dt>
<dd><p>Create MDS daemon(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.apply_mds">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">apply_mds</code><span class="sig-paren">(</span><em class="sig-param">spec</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.apply_mds" title="Permalink to this definition">¶</a></dt>
<dd><p>Update MDS cluster</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.add_rbd_mirror">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">add_rbd_mirror</code><span class="sig-paren">(</span><em class="sig-param">spec</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.add_rbd_mirror" title="Permalink to this definition">¶</a></dt>
<dd><p>Create rbd-mirror daemon(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.apply_rbd_mirror">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">apply_rbd_mirror</code><span class="sig-paren">(</span><em class="sig-param">spec</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.apply_rbd_mirror" title="Permalink to this definition">¶</a></dt>
<dd><p>Update rbd-mirror cluster</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="ceph.deployment.service_spec.RGWSpec">
<em class="property">class </em><code class="sig-prename descclassname">ceph.deployment.service_spec.</code><code class="sig-name descname">RGWSpec</code><span class="sig-paren">(</span><em class="sig-param">service_type='rgw'</em>, <em class="sig-param">service_id=None</em>, <em class="sig-param">placement=None</em>, <em class="sig-param">rgw_realm=None</em>, <em class="sig-param">rgw_zone=None</em>, <em class="sig-param">subcluster=None</em>, <em class="sig-param">rgw_frontend_port=None</em>, <em class="sig-param">rgw_frontend_ssl_certificate=None</em>, <em class="sig-param">rgw_frontend_ssl_key=None</em>, <em class="sig-param">unmanaged=False</em>, <em class="sig-param">ssl=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ceph.deployment.service_spec.RGWSpec" title="Permalink to this definition">¶</a></dt>
<dd><p>Settings to configure a (multisite) Ceph RGW</p>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.add_rgw">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">add_rgw</code><span class="sig-paren">(</span><em class="sig-param">spec</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.add_rgw" title="Permalink to this definition">¶</a></dt>
<dd><p>Create RGW daemon(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.apply_rgw">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">apply_rgw</code><span class="sig-paren">(</span><em class="sig-param">spec</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.apply_rgw" title="Permalink to this definition">¶</a></dt>
<dd><p>Update RGW cluster</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="ceph.deployment.service_spec.NFSServiceSpec">
<em class="property">class </em><code class="sig-prename descclassname">ceph.deployment.service_spec.</code><code class="sig-name descname">NFSServiceSpec</code><span class="sig-paren">(</span><em class="sig-param">service_type='nfs'</em>, <em class="sig-param">service_id=None</em>, <em class="sig-param">pool=None</em>, <em class="sig-param">namespace=None</em>, <em class="sig-param">placement=None</em>, <em class="sig-param">unmanaged=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ceph.deployment.service_spec.NFSServiceSpec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.add_nfs">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">add_nfs</code><span class="sig-paren">(</span><em class="sig-param">spec</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.add_nfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Create NFS daemon(s)</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.apply_nfs">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">apply_nfs</code><span class="sig-paren">(</span><em class="sig-param">spec</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.apply_nfs" title="Permalink to this definition">¶</a></dt>
<dd><p>Update NFS cluster</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="id12">
<h2>升级<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h2>
<dl class="method">
<dt id="orchestrator.Orchestrator.upgrade_available">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">upgrade_available</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.upgrade_available" title="Permalink to this definition">¶</a></dt>
<dd><p>Report on what versions are available to upgrade to</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of strings</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.upgrade_start">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">upgrade_start</code><span class="sig-paren">(</span><em class="sig-param">image</em>, <em class="sig-param">version</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.upgrade_start" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.upgrade_status">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">upgrade_status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.upgrade_status" title="Permalink to this definition">¶</a></dt>
<dd><p>If an upgrade is currently underway, report on where
we are in the process, or if some error has occurred.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>UpgradeStatusSpec instance</p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="orchestrator.UpgradeStatusSpec">
<em class="property">class </em><code class="sig-prename descclassname">orchestrator.</code><code class="sig-name descname">UpgradeStatusSpec</code><a class="headerlink" href="#orchestrator.UpgradeStatusSpec" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="id13">
<h2>工具<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h2>
<dl class="method">
<dt id="orchestrator.Orchestrator.available">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">available</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.available" title="Permalink to this definition">¶</a></dt>
<dd><p>Report whether we can talk to the orchestrator.  This is the
place to give the user a meaningful message if the orchestrator
isn’t running or can’t be contacted.</p>
<p>This method may be called frequently (e.g. every page load
to conditionally display a warning banner), so make sure it’s
not too expensive.  It’s okay to give a slightly stale status
(e.g. based on a periodic background ping of the orchestrator)
if that’s necessary to make this method fast.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>True</cite> doesn’t mean that the desired functionality
is actually available in the orchestrator. I.e. this
won’t work as expected:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span>
<span class="gp">... </span><span class="k">if</span> <span class="n">OrchestratorClientMixin</span><span class="p">()</span><span class="o">.</span><span class="n">available</span><span class="p">()[</span><span class="mi">0</span><span class="p">]:</span>  <span class="c1"># wrong.</span>
<span class="gp">... </span>    <span class="n">OrchestratorClientMixin</span><span class="p">()</span><span class="o">.</span><span class="n">get_hosts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code>[<code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code>]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>two-tuple of boolean, string</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="orchestrator.Orchestrator.get_feature_set">
<code class="sig-prename descclassname">Orchestrator.</code><code class="sig-name descname">get_feature_set</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.Orchestrator.get_feature_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Describes which methods this orchestrator implements</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><cite>True</cite> doesn’t mean that the desired functionality
is actually possible in the orchestrator. I.e. this
won’t work as expected:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span>
<span class="gp">... </span><span class="n">api</span> <span class="o">=</span> <span class="n">OrchestratorClientMixin</span><span class="p">()</span>
<span class="gp">... </span><span class="k">if</span> <span class="n">api</span><span class="o">.</span><span class="n">get_feature_set</span><span class="p">()[</span><span class="s1">&#39;get_hosts&#39;</span><span class="p">][</span><span class="s1">&#39;available&#39;</span><span class="p">]:</span>  <span class="c1"># wrong.</span>
<span class="gp">... </span>    <span class="n">api</span><span class="o">.</span><span class="n">get_hosts</span><span class="p">()</span>
</pre></div>
</div>
<p>It’s better to ask for forgiveness instead:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span>
<span class="gp">... </span><span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">OrchestratorClientMixin</span><span class="p">()</span><span class="o">.</span><span class="n">get_hosts</span><span class="p">()</span>
<span class="gp">... </span><span class="k">except</span> <span class="p">(</span><span class="n">OrchestratorError</span><span class="p">,</span> <span class="ne">NotImplementedError</span><span class="p">):</span>
<span class="gp">... </span>    <span class="o">...</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Dict of API method names to <code class="docutils literal notranslate"><span class="pre">{'available':</span> <span class="pre">True</span> <span class="pre">or</span> <span class="pre">False}</span></code></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="id14">
<h2>客户端模块<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="orchestrator.OrchestratorClientMixin">
<em class="property">class </em><code class="sig-prename descclassname">orchestrator.</code><code class="sig-name descname">OrchestratorClientMixin</code><a class="headerlink" href="#orchestrator.OrchestratorClientMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>A module that inherents from <cite>OrchestratorClientMixin</cite> can directly call
all <code class="xref py py-class docutils literal notranslate"><span class="pre">Orchestrator</span></code> methods without manually calling remote.</p>
<p>Every interface method from <code class="docutils literal notranslate"><span class="pre">Orchestrator</span></code> is converted into a stub method that internally
calls <code class="xref py py-func docutils literal notranslate"><span class="pre">OrchestratorClientMixin._oremote()</span></code></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyModule</span><span class="p">(</span><span class="n">OrchestratorClientMixin</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>       <span class="n">completion</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_host</span><span class="p">(</span><span class="s1">&#39;somehost&#39;</span><span class="p">)</span>  <span class="c1"># calls `_oremote()`</span>
<span class="gp">... </span>       <span class="bp">self</span><span class="o">.</span><span class="n">_orchestrator_wait</span><span class="p">([</span><span class="n">completion</span><span class="p">])</span>
<span class="gp">... </span>       <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">completion</span><span class="o">.</span><span class="n">result</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Orchestrator implementations should not inherit from <cite>OrchestratorClientMixin</cite>.
Reason is, that OrchestratorClientMixin magically redirects all methods to the
“real” implementation of the orchestrator.</p>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mgr_module</span>
<span class="gp">&gt;&gt;&gt; </span>
<span class="gp">... </span><span class="k">class</span> <span class="nc">MyImplentation</span><span class="p">(</span><span class="n">mgr_module</span><span class="o">.</span><span class="n">MgrModule</span><span class="p">,</span> <span class="n">Orchestrator</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">orch_client</span> <span class="o">=</span> <span class="n">OrchestratorClientMixin</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">orch_client</span><span class="o">.</span><span class="n">set_mgr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mgr</span><span class="p">))</span>
</pre></div>
</div>
<dl class="method">
<dt id="orchestrator.OrchestratorClientMixin.set_mgr">
<code class="sig-name descname">set_mgr</code><span class="sig-paren">(</span><em class="sig-param">mgr</em><span class="sig-paren">)</span><a class="headerlink" href="#orchestrator.OrchestratorClientMixin.set_mgr" title="Permalink to this definition">¶</a></dt>
<dd><p>Useable in the Dashbord that uses a global <code class="docutils literal notranslate"><span class="pre">mgr</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>



          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../start/intro/">Ceph 简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/">安装 Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cephadm/">Cephadm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rados/">Ceph 存储集群</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cephfs/">Ceph 文件系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rbd/">Ceph 块设备</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../radosgw/">Ceph 对象网关</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">Ceph 管理器守护进程</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../administrator/">安装和配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="../modules/">模块编程</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">编写 orchestrator 插件</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">术语</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">关键概念</a></li>
<li class="toctree-l3"><a class="reference internal" href="#completions-and-batching">Completions and batching</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">错误处理</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">排除的功能</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">主机管理</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">设备</a></li>
<li class="toctree-l3"><a class="reference internal" href="#placement">Placement</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">服务</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">守护进程</a></li>
<li class="toctree-l3"><a class="reference internal" href="#osd">OSD 管理</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#orchestrator-osd-replace">OSD 替换</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id10">监视器</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">无状态服务</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id12">升级</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id13">工具</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id14">客户端模块</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../dashboard/">仪表盘模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../alerts/">Alerts 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../diskprediction/">DiskPrediction 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../localpool/">localpool 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../restful/">REST 风格模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../zabbix/">Zabbix 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prometheus/">Prometheus 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../influx/">Influx 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hello/">Hello 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../telegraf/">Telegraf 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../telemetry/">Telemetry 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iostat/">Iostat 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../osd_support/">OSD Support 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../crash/">Crash 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../insights/">Insights 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../orchestrator/">Orchestrator 模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rook/">Rook 模块</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../dashboard/">Ceph 仪表盘</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/">API 文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture/">体系结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/developer_guide/">开发者指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/internals/">Ceph 内幕</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../governance/">项目管理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../foundation/">Ceph 基金会</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ceph-volume/">ceph-volume</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/general/">Ceph 版本（总目录）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/">Ceph 版本（索引）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary/">Ceph 术语</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../translation_cn/">中文版翻译资源</a></li>
</ul>


<!-- ugly kludge to make genindex look like it's part of the toc -->
<ul style="margin-top: -10px"><li class="toctree-l1"><a class="reference internal" href="../../genindex/">Index</a></li></ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search/" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../dashboard/" title="Ceph 仪表盘"
             >next</a> |</li>
        <li class="right" >
          <a href="../modules/" title="ceph-mgr 模块开发指南"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../" >Ceph 管理器守护进程</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Ceph authors and contributors. Licensed under Creative Commons Attribution Share Alike 3.0 (CC-BY-SA-3.0).
    </div>
  </body>
</html>