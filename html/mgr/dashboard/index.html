
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Ceph 管理器仪表盘 &#8212; Ceph Documentation</title>
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/js/ceph.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="rest 风格的插件" href="../restful/" />
    <link rel="prev" title="ceph-mgr 插件编程指南" href="../plugins/" />
    <script type="text/javascript" src="http://ayni.ceph.com/public/js/ceph.js"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../restful/" title="rest 风格的插件"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../plugins/" title="ceph-mgr 插件编程指南"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../" accesskey="U">Ceph 管理器守护进程</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            

<div id="dev-warning" class="admonition note" style="display:none;">
  <p class="first admonition-title">Notice</p>
  <p class="last">This document is for a development version of Ceph.</p>
</div>

<div id="eol-warning" class="admonition warning" style="display:none;">
  <p class="first admonition-title">Warning</p>
  <p class="last">This document is for an unsupported version of Ceph.</p>
</div>
  <div id="docubetter" align="right" style="display:none; padding: 15px; font-weight: bold;">
    <a id="edit-on-github" href="https://github.com/ceph/ceph/edit/master/doc/mgr/dashboard.rst" rel="nofollow">Edit on GitHub</a> | <a href="https://github.com/ceph/ceph/projects/4">Report a Documentation Bug</a>
  </div>

  
  <div class="section" id="ceph">
<span id="mgr-dashboard"></span><h1>Ceph 管理器仪表盘<a class="headerlink" href="#ceph" title="Permalink to this headline">¶</a></h1>
<div class="section" id="id1">
<h2>概述<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>The original Ceph Manager Dashboard that was shipped with Ceph Luminous started
out as a simple read-only view into various run-time information and performance
data of a Ceph cluster. It used a very simple architecture to achieve the
original goal. However, there was a growing demand for adding more web-based
management capabilities, to make it easier to administer Ceph for users that
prefer a WebUI over using the command line.</p>
<p>The new <a class="reference internal" href="../../glossary/#term-ceph-manager-dashboard"><span class="xref std std-term">Ceph Manager Dashboard</span></a> plugin is a replacement of the previous
one and adds a built-in web based monitoring and administration application to
the Ceph Manager. The architecture and functionality of this new plugin is
derived from and inspired by the <a class="reference external" href="https://openattic.org/">openATTIC Ceph management and monitoring tool</a>. The development is actively driven by the team
behind openATTIC at <a class="reference external" href="https://www.suse.com/">SUSE</a>, with a lot of support from
the Ceph community and other companies like Red Hat.</p>
<p>The dashboard plugin’s backend code uses the CherryPy framework and a custom
REST API implementation. The WebUI implementation is based on
Angular/TypeScript, merging both functionality from the original dashboard as
well as adding new functionality originally developed for the standalone version
of openATTIC. The Ceph Manager Dashboard plugin is implemented as a web
application that visualizes information and statistics about the Ceph cluster
using a web server hosted by <code class="docutils literal notranslate"><span class="pre">ceph-mgr</span></code>.</p>
<p>The dashboard currently provides the following features to monitor and manage
various aspects of your Ceph cluster:</p>
<ul class="simple">
<li><p><strong>Multi-User and Role Management</strong>: The dashboard supports multiple user
accounts with different permissions (roles). The user accounts and roles
can be modified on both the command line and via the WebUI.
See <a class="reference internal" href="#dashboard-user-role-management"><span class="std std-ref">用户和角色管理</span></a> for details.</p></li>
<li><p><strong>Single Sign-On (SSO)</strong>: the dashboard supports authentication
via an external identity provider using the SAML 2.0 protocol. See
<a class="reference internal" href="#dashboard-sso-support"><span class="std std-ref">启用单点登录（ Single Sign-On, SSO ）</span></a> for details.</p></li>
<li><p><strong>SSL/TLS support</strong>: All HTTP communication between the web browser and the
dashboard is secured via SSL. A self-signed certificate can be created with
a built-in command, but it’s also possible to import custom certificates
signed and issued by a CA. See <a class="reference internal" href="#dashboard-ssl-tls-support"><span class="std std-ref">SSL/TLS 支持</span></a> for details.</p></li>
<li><p><strong>Auditing</strong>: the dashboard backend can be configured to log all PUT, POST
and DELETE API requests in the Ceph audit log. See <a class="reference internal" href="#dashboard-auditing"><span class="std std-ref">审计</span></a>
for instructions on how to enable this feature.</p></li>
<li><p><strong>Internationalization (I18N)</strong>: use the dashboard in different languages.</p></li>
<li><p><strong>Overall cluster health</strong>: Displays overall cluster status, performance
and capacity metrics.</p></li>
<li><p><strong>Cluster logs</strong>: Display the latest updates to the cluster’s event and audit
log files.</p></li>
<li><p><strong>Hosts</strong>: Provides a list of all hosts associated to the cluster, which
services are running and which version of Ceph is installed.</p></li>
<li><p><strong>Performance counters</strong>: Displays detailed service-specific statistics for
each running service.</p></li>
<li><p><strong>Monitors</strong>: Lists all MONs, their quorum status, open sessions.</p></li>
<li><p><strong>Configuration Editor</strong>: View all available configuration options,
their description, type and default values and edit the current values.</p></li>
<li><p><strong>Pools</strong>: List all Ceph pools and their details (e.g. applications, placement
groups, replication size, EC profile, CRUSH ruleset, etc.)</p></li>
<li><p><strong>OSDs</strong>: Lists all OSDs, their status and usage statistics as well as
detailed information like attributes (OSD map), metadata, performance counters
and usage histograms for read/write operations. Mark OSDs as up/down/out,
perform scrub operations. Select between different recovery profiles to adjust
the level of backfilling activity.</p></li>
<li><p><strong>iSCSI</strong>: Lists all hosts that run the TCMU runner service, displaying all
images and their performance characteristics (read/write ops, traffic).</p></li>
<li><p><strong>RBD</strong>: Lists all RBD images and their properties (size, objects, features).
Create, copy, modify and delete RBD images. Create, delete and rollback
snapshots of selected images, protect/unprotect these snapshots against
modification. Copy or clone snapshots, flatten cloned images.</p></li>
<li><p><strong>RBD mirroring</strong>: Enable and configure RBD mirroring to a remote Ceph server.
Lists all active sync daemons and their status, pools and RBD images including
their synchronization state.</p></li>
<li><p><strong>CephFS</strong>: Lists all active filesystem clients and associated pools,
including their usage statistics.</p></li>
<li><p><strong>Object Gateway</strong>: Lists all active object gateways and their performance
counters. Display and manage (add/edit/delete) object gateway users and their
details (e.g. quotas) as well as the users’ buckets and their details (e.g.
owner, quotas).</p></li>
<li><p><strong>NFS</strong>: Manage NFS exports of CephFS filesystems and RGW S3 buckets via NFS Ganesha.```</p></li>
</ul>
</div>
<div class="section" id="id2">
<h2>如何启用<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Within a running Ceph cluster, the Ceph Manager Dashboard is enabled with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph mgr module enable dashboard
</pre></div>
</div>
</div>
<div class="section" id="id3">
<h2>配置<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<div class="section" id="ssl-tls">
<span id="dashboard-ssl-tls-support"></span><h3>SSL/TLS 支持<a class="headerlink" href="#ssl-tls" title="Permalink to this headline">¶</a></h3>
<p>All HTTP connections to the dashboard are secured with SSL/TLS by default.</p>
<p>To get the dashboard up and running quickly, you can generate and install a
self-signed certificate using the following built-in command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard create-self-signed-cert
</pre></div>
</div>
<p>Note that most web browsers will complain about such self-signed certificates
and require explicit confirmation before establishing a secure connection to the
dashboard.</p>
<p>To properly secure a deployment and to remove the certificate warning, a
certificate that is issued by a certificate authority (CA) should be used.</p>
<p>For example, a key pair can be generated with a command similar to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ openssl req -new -nodes -x509 \
  -subj &quot;/O=IT/CN=ceph-mgr-dashboard&quot; -days 3650 \
  -keyout dashboard.key -out dashboard.crt -extensions v3_ca
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">dashboard.crt</span></code> file should then be signed by a CA. Once that is done, you
can enable it for all Ceph manager instances by running the following commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph config-key set mgr/dashboard/crt -i dashboard.crt
$ ceph config-key set mgr/dashboard/key -i dashboard.key
</pre></div>
</div>
<p>If different certificates are desired for each manager instance for some reason,
the name of the instance can be included as follows (where <code class="docutils literal notranslate"><span class="pre">$name</span></code> is the name
of the <code class="docutils literal notranslate"><span class="pre">ceph-mgr</span></code> instance, usually the hostname):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph config-key set mgr/dashboard/$name/crt -i dashboard.crt
$ ceph config-key set mgr/dashboard/$name/key -i dashboard.key
</pre></div>
</div>
<p>SSL can also be disabled by setting this configuration value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph config set mgr mgr/dashboard/ssl false
</pre></div>
</div>
<p>This might be useful if the dashboard will be running behind a proxy which does
not support SSL for its upstream servers or other situations where SSL is not
wanted or required.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Use caution when disabling SSL as usernames and passwords will be sent to the
dashboard unencrypted.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You need to restart the Ceph manager processes manually after changing the SSL
certificate and key. This can be accomplished by either running <code class="docutils literal notranslate"><span class="pre">ceph</span> <span class="pre">mgr</span>
<span class="pre">fail</span> <span class="pre">mgr</span></code> or by disabling and re-enabling the dashboard module (which also
triggers the manager to respawn itself):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph mgr module disable dashboard
$ ceph mgr module enable dashboard
</pre></div>
</div>
</div>
</div>
<div class="section" id="id4">
<h3>主机名和端口<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>Like most web applications, dashboard binds to a TCP/IP address and TCP port.</p>
<p>By default, the <code class="docutils literal notranslate"><span class="pre">ceph-mgr</span></code> daemon hosting the dashboard (i.e., the currently
active manager) will bind to TCP port 8443 or 8080 when SSL is disabled.</p>
<p>If no specific address has been configured, the web app will bind to <code class="docutils literal notranslate"><span class="pre">::</span></code>,
which corresponds to all available IPv4 and IPv6 addresses.</p>
<p>These defaults can be changed via the configuration key facility on a
cluster-wide level (so they apply to all manager instances) as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph config set mgr mgr/dashboard/server_addr $IP
$ ceph config set mgr mgr/dashboard/server_port $PORT
</pre></div>
</div>
<p>Since each <code class="docutils literal notranslate"><span class="pre">ceph-mgr</span></code> hosts its own instance of dashboard, it may also be
necessary to configure them separately. The IP address and port for a specific
manager instance can be changed with the following commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph config set mgr mgr/dashboard/$name/server_addr $IP
$ ceph config set mgr mgr/dashboard/$name/server_port $PORT
</pre></div>
</div>
<p>Replace <code class="docutils literal notranslate"><span class="pre">$name</span></code> with the ID of the ceph-mgr instance hosting the dashboard web
app.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The command <code class="docutils literal notranslate"><span class="pre">ceph</span> <span class="pre">mgr</span> <span class="pre">services</span></code> will show you all endpoints that are
currently configured. Look for the <code class="docutils literal notranslate"><span class="pre">dashboard</span></code> key to obtain the URL for
accessing the dashboard.</p>
</div>
</div>
<div class="section" id="id5">
<h3>用户名和密码<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>为了能登录进去，你需要创建用户帐户并给他关联至少一个角色。我们预定义了一系列<em>系统角色</em>，可以直接使用。更多细节请参考<a class="reference internal" href="#id8">用户和角色管理</a>一节。</p>
<p>要创建拥有 administrator 角色的用户可以用下面的命令：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard ac-user-create &lt;username&gt; &lt;password&gt; administrator
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h3>启用对象网关管理前端<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>To use the Object Gateway management functionality of the dashboard, you will
need to provide the login credentials of a user with the <code class="docutils literal notranslate"><span class="pre">system</span></code> flag
enabled.</p>
<p>If you do not have a user which shall be used for providing those credentials,
you will also need to create one:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ radosgw-admin user create --uid=&lt;user_id&gt; --display-name=&lt;display_name&gt; \
    --system
</pre></div>
</div>
<p>Take note of the keys <code class="docutils literal notranslate"><span class="pre">access_key</span></code> and <code class="docutils literal notranslate"><span class="pre">secret_key</span></code> in the output of this
command.</p>
<p>The credentials of an existing user can also be obtained by using
<cite>radosgw-admin</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ radosgw-admin user info --uid=&lt;user_id&gt;
</pre></div>
</div>
<p>Finally, provide the credentials to the dashboard:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard set-rgw-api-access-key &lt;access_key&gt;
$ ceph dashboard set-rgw-api-secret-key &lt;secret_key&gt;
</pre></div>
</div>
<p>This is all you have to do to get the Object Gateway management functionality
working. The host and port of the Object Gateway are determined automatically.</p>
<p>If multiple zones are used, it will automatically determine the host within the
master zone group and master zone. This should be sufficient for most setups,
but in some circumstances you might want to set the host and port manually:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard set-rgw-api-host &lt;host&gt;
$ ceph dashboard set-rgw-api-port &lt;port&gt;
</pre></div>
</div>
<p>In addition to the settings mentioned so far, the following settings do also
exist and you may find yourself in the situation that you have to use them:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard set-rgw-api-scheme &lt;scheme&gt;  # http or https
$ ceph dashboard set-rgw-api-admin-resource &lt;admin_resource&gt;
$ ceph dashboard set-rgw-api-user-id &lt;user_id&gt;
</pre></div>
</div>
<p>If you are using a self-signed certificate in your Object Gateway setup, then
you should disable certificate verification in the dashboard to avoid refused
connections, e.g. caused by certificates signed by unknown CA or not matching
the host name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard set-rgw-api-ssl-verify False
</pre></div>
</div>
<p>If the Object Gateway takes too long to process requests and the dashboard runs
into timeouts, then you can set the timeout value to your needs:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard set-rest-requests-timeout &lt;seconds&gt;
</pre></div>
</div>
<p>The default value is 45 seconds.</p>
</div>
<div class="section" id="iscsi">
<h3>启用 iSCSI 的管理<a class="headerlink" href="#iscsi" title="Permalink to this headline">¶</a></h3>
<p>The Ceph Manager Dashboard can manage iSCSI targets using the REST API provided
by the <cite>rbd-target-api</cite> service of the <a class="reference external" href="https://github.com/ceph/ceph-iscsi">ceph-iscsi</a>
project. Please make sure that it’s installed and enabled on the iSCSI gateways.</p>
<p>The available iSCSI gateways must be defined using the following commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard iscsi-gateway-list
$ ceph dashboard iscsi-gateway-add &lt;gateway_name&gt; &lt;scheme&gt;://&lt;username&gt;:&lt;password&gt;@&lt;host&gt;[:port]
$ ceph dashboard iscsi-gateway-rm &lt;gateway_name&gt;
</pre></div>
</div>
</div>
<div class="section" id="grafana">
<h3>允许嵌入 Grafana 仪表盘<a class="headerlink" href="#grafana" title="Permalink to this headline">¶</a></h3>
<p>Grafana and Prometheus are likely going to be bundled and installed by some
orchestration tools along Ceph in the near future, but currently, you will have
to install and configure both manually. After you have installed Prometheus and
Grafana on your preferred hosts, proceed with the following steps.</p>
<ol class="arabic">
<li><p>Enable the Ceph Exporter which comes as Ceph Manager module by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph mgr module enable prometheus
</pre></div>
</div>
</li>
</ol>
<p>More details can be found on the <a class="reference external" href="http://docs.ceph.com/docs/master/mgr/prometheus/">documentation</a> of the prometheus module.</p>
<ol class="arabic">
<li><p>Add the corresponding scrape configuration to Prometheus. This may look
like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">global</span><span class="p">:</span>
  <span class="n">scrape_interval</span><span class="p">:</span> <span class="mi">5</span><span class="n">s</span>

<span class="n">scrape_configs</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">job_name</span><span class="p">:</span> <span class="s1">&#39;prometheus&#39;</span>
    <span class="n">static_configs</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">targets</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;localhost:9090&#39;</span><span class="p">]</span>
  <span class="o">-</span> <span class="n">job_name</span><span class="p">:</span> <span class="s1">&#39;ceph&#39;</span>
    <span class="n">static_configs</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">targets</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;localhost:9283&#39;</span><span class="p">]</span>
  <span class="o">-</span> <span class="n">job_name</span><span class="p">:</span> <span class="s1">&#39;node-exporter&#39;</span>
    <span class="n">static_configs</span><span class="p">:</span>
      <span class="o">-</span> <span class="n">targets</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;localhost:9100&#39;</span><span class="p">]</span>
</pre></div>
</div>
</li>
<li><p>Add Prometheus as data source to Grafana</p></li>
<li><p>Install the <cite>vonage-status-panel and grafana-piechart-panel</cite> plugins using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grafana</span><span class="o">-</span><span class="n">cli</span> <span class="n">plugins</span> <span class="n">install</span> <span class="n">vonage</span><span class="o">-</span><span class="n">status</span><span class="o">-</span><span class="n">panel</span>
<span class="n">grafana</span><span class="o">-</span><span class="n">cli</span> <span class="n">plugins</span> <span class="n">install</span> <span class="n">grafana</span><span class="o">-</span><span class="n">piechart</span><span class="o">-</span><span class="n">panel</span>
</pre></div>
</div>
</li>
<li><p>Add the Dashboards to Grafana:</p>
<p>Dashboards can be added to Grafana by importing dashboard jsons.
Following command can be used for downloading json files:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ceph</span><span class="o">/</span><span class="n">ceph</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">monitoring</span><span class="o">/</span><span class="n">grafana</span><span class="o">/</span><span class="n">dashboards</span><span class="o">/&lt;</span><span class="n">Dashboard</span><span class="o">-</span><span class="n">name</span><span class="o">&gt;.</span><span class="n">json</span>
</pre></div>
</div>
<p>You can find all the dashboard jsons <a class="reference external" href="https://github.com/ceph/ceph/tree/master/monitoring/grafana/dashboards">here</a> .</p>
<p>For Example, for ceph-cluster overview you can use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wget</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">ceph</span><span class="o">/</span><span class="n">ceph</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">monitoring</span><span class="o">/</span><span class="n">grafana</span><span class="o">/</span><span class="n">dashboards</span><span class="o">/</span><span class="n">ceph</span><span class="o">-</span><span class="n">cluster</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
</li>
<li><p>Configure Grafana in <cite>/etc/grafana/grafana.ini</cite> to adapt anonymous mode:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">auth</span><span class="o">.</span><span class="n">anonymous</span><span class="p">]</span>
<span class="n">enabled</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">org_name</span> <span class="o">=</span> <span class="n">Main</span> <span class="n">Org</span><span class="o">.</span>
<span class="n">org_role</span> <span class="o">=</span> <span class="n">Viewer</span>
</pre></div>
</div>
</li>
</ol>
<p>After you have set up Grafana and Prometheus, you will need to configure the
connection information that the Ceph Manager Dashboard will use to access Grafana.</p>
<p>You need to tell the dashboard on which url Grafana instance is running/deployed:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard set-grafana-api-url &lt;grafana-server-url&gt;  # default: &#39;&#39;
</pre></div>
</div>
<p>The format of url is : <cite>&lt;protocol&gt;:&lt;IP-address&gt;:&lt;port&gt;</cite>
You can directly access Grafana Instance as well to monitor your cluster.</p>
</div>
<div class="section" id="single-sign-on-sso">
<span id="dashboard-sso-support"></span><h3>启用单点登录（ Single Sign-On, SSO ）<a class="headerlink" href="#single-sign-on-sso" title="Permalink to this headline">¶</a></h3>
<p>The Ceph Manager Dashboard supports external authentication of users via the
<a class="reference external" href="https://en.wikipedia.org/wiki/SAML_2.0">SAML 2.0</a> protocol. You need to create
the user accounts and associate them with the desired roles first, as authorization
is still performed by the Dashboard. However, the authentication process can be
performed by an existing Identity Provider (IdP).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ceph Dashboard SSO support relies on onelogin’s
<a class="reference external" href="https://pypi.org/project/python-saml/">python-saml</a> library.
Please ensure that this library is installed on your system, either by using
your distribution’s package management or via Python’s <cite>pip</cite> installer.</p>
</div>
<p>To configure SSO on Ceph Dashboard, you should use the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard sso setup saml2 &lt;ceph_dashboard_base_url&gt; &lt;idp_metadata&gt; {&lt;idp_username_attribute&gt;} {&lt;idp_entity_id&gt;} {&lt;sp_x_509_cert&gt;} {&lt;sp_private_key&gt;}
</pre></div>
</div>
<p>参数：</p>
<ul class="simple">
<li><p><strong>&lt;ceph_dashboard_base_url&gt;</strong>: Base URL where Ceph Dashboard is accessible (e.g., <cite>https://cephdashboard.local</cite>)</p></li>
<li><p><strong>&lt;idp_metadata&gt;</strong>: URL, file path or content of the IdP metadata XML (e.g., <cite>https://myidp/metadata</cite>)</p></li>
<li><p><strong>&lt;idp_username_attribute&gt;</strong> <em>(optional)</em>: Attribute that should be used to get the username from the authentication response. Defaults to <cite>uid</cite>.</p></li>
<li><p><strong>&lt;idp_entity_id&gt;</strong> <em>(optional)</em>: Use this when more than one entity id exists on the IdP metadata.</p></li>
<li><p><strong>&lt;sp_x_509_cert&gt; / &lt;sp_private_key&gt;</strong> <em>(optional)</em>: File path or content of the certificate that should be used by Ceph Dashboard (Service Provider) for signing and encryption.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The issuer value of SAML requests will follow this pattern:  <strong>&lt;ceph_dashboard_base_url&gt;</strong>/auth/saml2/metadata</p>
</div>
<p>To display the current SAML 2.0 configuration, use the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard sso show saml2
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more information about <cite>onelogin_settings</cite>, please check the <a class="reference external" href="https://github.com/onelogin/python-saml">onelogin documentation</a>.</p>
</div>
<p>To disable SSO:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard sso disable
</pre></div>
</div>
<p>To check if SSO is enabled:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard sso status
</pre></div>
</div>
<p>To enable SSO:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard sso enable saml2
</pre></div>
</div>
</div>
<div class="section" id="prometheus">
<h3>启用 Prometheus 报警<a class="headerlink" href="#prometheus" title="Permalink to this headline">¶</a></h3>
<p>Using Prometheus for monitoring, you have to define <a class="reference external" href="https://prometheus.io/docs/prometheus/latest/configuration/alerting_rules">alerting rules</a>.
To manage them you need to use the <a class="reference external" href="https://prometheus.io/docs/alerting/alertmanager">Alertmanager</a>.
If you are not using the Alertmanager yet, please <a class="reference external" href="https://github.com/prometheus/alertmanager#install">install it</a> as it’s mandatory in
order to receive and manage alerts from Prometheus.</p>
<p>The Alertmanager capabilities can be consumed by the dashboard in three different
ways:</p>
<ol class="arabic simple">
<li><p>Use the notification receiver of the dashboard.</p></li>
<li><p>Use the Prometheus Alertmanager API.</p></li>
<li><p>Use both sources simultaneously.</p></li>
</ol>
<p>All three methods are going to notify you about alerts. You won’t be notified
twice if you use both sources.</p>
<ol class="arabic">
<li><p>Use the notification receiver of the dashboard:</p>
<p>This allows you to get notifications as <a class="reference external" href="https://prometheus.io/docs/alerting/configuration/">configured</a> from the Alertmanager.
You will get notified inside the dashboard once a notification is send out,
but you are not able to manage alerts.</p>
<p>Add the dashboard receiver and the new route to your Alertmanager configuration.
This should look like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">route</span><span class="p">:</span>
  <span class="n">receiver</span><span class="p">:</span> <span class="s1">&#39;ceph-dashboard&#39;</span>
<span class="o">...</span>
<span class="n">receivers</span><span class="p">:</span>
  <span class="o">-</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;ceph-dashboard&#39;</span>
    <span class="n">webhook_configs</span><span class="p">:</span>
    <span class="o">-</span> <span class="n">url</span><span class="p">:</span> <span class="s1">&#39;&lt;url-to-dashboard&gt;/api/prometheus_receiver&#39;</span>
</pre></div>
</div>
<p>Please make sure that the Alertmanager considers your SSL certificate in terms
of the dashboard as valid. For more information about the correct
configuration checkout the <a class="reference external" href="https://prometheus.io/docs/alerting/configuration/#%3Chttp_config%3E">&lt;http_config&gt; documentation</a>.</p>
</li>
<li><p>Use the API of the Prometheus Alertmanager</p>
<p>This allows you to manage alerts. You will see all alerts, the Alertmanager
currently knows of, in the alerts listing. It can be found in the <em>Cluster</em>
submenu as <em>Alerts</em>. The alerts can be sorted by name, job, severity,
state and start time. Unfortunately it’s not possible to know when an alert
was sent out through a notification by the Alertmanager based on your
configuration, that’s why the dashboard will notify the user on any visible
change to an alert and will notify the changed alert.</p>
<p>Currently it’s not yet possible to silence an alert and expire an silenced
alert, but this is work in progress and will be added in a future release.</p>
<p>To use it, specify the host and port of the Alertmanager server:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard set-alertmanager-api-host &lt;alertmanager-host:port&gt;  # default: &#39;&#39;
</pre></div>
</div>
<p>For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard set-alertmanager-api-host &#39;http://localhost:9093&#39;
</pre></div>
</div>
</li>
<li><p>Use both methods</p>
<p>The different behaviors of both methods are configured in a way that they
should not disturb each other through annoying duplicated notifications
popping up.</p>
</li>
</ol>
</div>
<div class="section" id="id7">
<h3>仪表盘的访问<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>You can now access the dashboard using your (JavaScript-enabled) web browser, by
pointing it to any of the host names or IP addresses and the selected TCP port
where a manager instance is running: e.g., <code class="docutils literal notranslate"><span class="pre">httpS://&lt;$IP&gt;:&lt;$PORT&gt;/</span></code>.</p>
<p>You should then be greeted by the dashboard login page, requesting your
previously defined username and password. Select the <strong>Keep me logged in</strong>
checkbox if you want to skip the username/password request when accessing the
dashboard in the future.</p>
</div>
</div>
<div class="section" id="dashboard-user-role-management">
<span id="id8"></span><h2>用户和角色管理<a class="headerlink" href="#dashboard-user-role-management" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id9">
<h3>用户帐户<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>Ceph Dashboard supports managing multiple user accounts. Each user account
consists of a username, a password (stored in encrypted form using <code class="docutils literal notranslate"><span class="pre">bcrypt</span></code>),
an optional name, and an optional email address.</p>
<p>User accounts are stored in MON’s configuration database, and are globally
shared across all ceph-mgr instances.</p>
<p>We provide a set of CLI commands to manage user accounts:</p>
<ul>
<li><p><em>Show User(s)</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard ac-user-show [&lt;username&gt;]
</pre></div>
</div>
</li>
<li><p><em>Create User</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard ac-user-create &lt;username&gt; [&lt;password&gt;] [&lt;rolename&gt;] [&lt;name&gt;] [&lt;email&gt;]
</pre></div>
</div>
</li>
<li><p><em>Delete User</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard ac-user-delete &lt;username&gt;
</pre></div>
</div>
</li>
<li><p><em>Change Password</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard ac-user-set-password &lt;username&gt; &lt;password&gt;
</pre></div>
</div>
</li>
<li><p><em>Modify User (name, and email)</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard ac-user-set-info &lt;username&gt; &lt;name&gt; &lt;email&gt;
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="id10">
<h3>用户角色和权限<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p>User accounts are also associated with a set of roles that define which
dashboard functionality can be accessed by the user.</p>
<p>The Dashboard functionality/modules are grouped within a <em>security scope</em>.
Security scopes are predefined and static. The current available security
scopes are:</p>
<ul class="simple">
<li><p><strong>hosts</strong>: includes all features related to the <code class="docutils literal notranslate"><span class="pre">Hosts</span></code> menu
entry.</p></li>
<li><p><strong>config-opt</strong>: includes all features related to management of Ceph
configuration options.</p></li>
<li><p><strong>pool</strong>: includes all features related to pool management.</p></li>
<li><p><strong>osd</strong>: includes all features related to OSD management.</p></li>
<li><p><strong>monitor</strong>: includes all features related to Monitor management.</p></li>
<li><p><strong>rbd-image</strong>: includes all features related to RBD image
management.</p></li>
<li><p><strong>rbd-mirroring</strong>: includes all features related to RBD-Mirroring
management.</p></li>
<li><p><strong>iscsi</strong>: includes all features related to iSCSI management.</p></li>
<li><p><strong>rgw</strong>: includes all features related to Rados Gateway management.</p></li>
<li><p><strong>cephfs</strong>: includes all features related to CephFS management.</p></li>
<li><p><strong>manager</strong>: include all features related to Ceph Manager
management.</p></li>
<li><p><strong>log</strong>: include all features related to Ceph logs management.</p></li>
<li><p><strong>grafana</strong>: include all features related to Grafana proxy.</p></li>
<li><p><strong>prometheus</strong>: include all features related to Prometheus alert management.</p></li>
<li><p><strong>dashboard-settings</strong>: allows to change dashboard settings.</p></li>
</ul>
<p>A <em>role</em> specifies a set of mappings between a <em>security scope</em> and a set of
<em>permissions</em>. There are four types of permissions:</p>
<ul class="simple">
<li><p><strong>read</strong></p></li>
<li><p><strong>create</strong></p></li>
<li><p><strong>update</strong></p></li>
<li><p><strong>delete</strong></p></li>
</ul>
<p>See below for an example of a role specification based on a Python dictionary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># example of a role</span>
<span class="p">{</span>
  <span class="s1">&#39;role&#39;</span><span class="p">:</span> <span class="s1">&#39;my_new_role&#39;</span><span class="p">,</span>
  <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;My new role&#39;</span><span class="p">,</span>
  <span class="s1">&#39;scopes_permissions&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;pool&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;read&#39;</span><span class="p">,</span> <span class="s1">&#39;create&#39;</span><span class="p">],</span>
    <span class="s1">&#39;rbd-image&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;read&#39;</span><span class="p">,</span> <span class="s1">&#39;create&#39;</span><span class="p">,</span> <span class="s1">&#39;update&#39;</span><span class="p">,</span> <span class="s1">&#39;delete&#39;</span><span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above role dictates that a user has <em>read</em> and <em>create</em> permissions for
features related to pool management, and has full permissions for
features related to RBD image management.</p>
<p>The Dashboard already provides a set of predefined roles that we call
<em>system roles</em>, and can be used right away in a fresh Ceph Dashboard
installation.</p>
<p>The list of system roles are:</p>
<ul class="simple">
<li><p><strong>administrator</strong>: provides full permissions for all security scopes.</p></li>
<li><p><strong>read-only</strong>: provides <em>read</em> permission for all security scopes except
the dashboard settings.</p></li>
<li><p><strong>block-manager</strong>: provides full permissions for <em>rbd-image</em>,
<em>rbd-mirroring</em>, and <em>iscsi</em> scopes.</p></li>
<li><p><strong>rgw-manager</strong>: provides full permissions for the <em>rgw</em> scope</p></li>
<li><p><strong>cluster-manager</strong>: provides full permissions for the <em>hosts</em>, <em>osd</em>,
<em>monitor</em>, <em>manager</em>, and <em>config-opt</em> scopes.</p></li>
<li><p><strong>pool-manager</strong>: provides full permissions for the <em>pool</em> scope.</p></li>
<li><p><strong>cephfs-manager</strong>: provides full permissions for the <em>cephfs</em> scope.</p></li>
</ul>
<p>The list of currently available roles can be retrieved by the following
command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard ac-role-show [&lt;rolename&gt;]
</pre></div>
</div>
<p>It is also possible to create new roles using CLI commands. The available
commands to manage roles are the following:</p>
<ul>
<li><p><em>Create Role</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard ac-role-create &lt;rolename&gt; [&lt;description&gt;]
</pre></div>
</div>
</li>
<li><p><em>Delete Role</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard ac-role-delete &lt;rolename&gt;
</pre></div>
</div>
</li>
<li><p><em>Add Scope Permissions to Role</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard ac-role-add-scope-perms &lt;rolename&gt; &lt;scopename&gt; &lt;permission&gt; [&lt;permission&gt;...]
</pre></div>
</div>
</li>
<li><p><em>Delete Scope Permission from Role</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard ac-role-del-perms &lt;rolename&gt; &lt;scopename&gt;
</pre></div>
</div>
</li>
</ul>
<p>To associate roles to users, the following CLI commands are available:</p>
<ul>
<li><p><em>Set User Roles</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard ac-user-set-roles &lt;username&gt; &lt;rolename&gt; [&lt;rolename&gt;...]
</pre></div>
</div>
</li>
<li><p><em>Add Roles To User</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard ac-user-add-roles &lt;username&gt; &lt;rolename&gt; [&lt;rolename&gt;...]
</pre></div>
</div>
</li>
<li><p><em>Delete Roles from User</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard ac-user-del-roles &lt;username&gt; &lt;rolename&gt; [&lt;rolename&gt;...]
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="id11">
<h3>用户和定制角色创建实例<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<p>In this section we show a full example of the commands that need to be used
in order to create a user account, that should be able to manage RBD images,
view and create Ceph pools, and have read-only access to any other scopes.</p>
<ol class="arabic">
<li><p><em>Create the user</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard ac-user-create bob mypassword
</pre></div>
</div>
</li>
<li><p><em>Create role and specify scope permissions</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard ac-role-create rbd/pool-manager
$ ceph dashboard ac-role-add-scope-perms rbd/pool-manager rbd-image read create update delete
$ ceph dashboard ac-role-add-scope-perms rbd/pool-manager pool read create
</pre></div>
</div>
</li>
<li><p><em>Associate roles to user</em>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard ac-user-set-roles bob rbd/pool-manager read-only
</pre></div>
</div>
</li>
</ol>
</div>
</div>
<div class="section" id="id12">
<h2>反向代理<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h2>
<p>If you are accessing the dashboard via a reverse proxy configuration,
you may wish to service it under a URL prefix.  To get the dashboard
to use hyperlinks that include your prefix, you can set the
<code class="docutils literal notranslate"><span class="pre">url_prefix</span></code> setting:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ceph config set mgr mgr/dashboard/url_prefix $PREFIX
</pre></div>
</div>
<p>so you can access the dashboard at <code class="docutils literal notranslate"><span class="pre">http://$IP:$PORT/$PREFIX/</span></code>.</p>
</div>
<div class="section" id="dashboard-auditing">
<span id="id13"></span><h2>审计<a class="headerlink" href="#dashboard-auditing" title="Permalink to this headline">¶</a></h2>
<p>The REST API is capable of logging PUT, POST and DELETE requests to the Ceph
audit log. This feature is disabled by default, but can be enabled with the
following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard set-audit-api-enabled &lt;true|false&gt;
</pre></div>
</div>
<p>If enabled, the following parameters are logged per each request:</p>
<ul class="simple">
<li><p>from - The origin of the request, e.g. <a class="reference external" href="https://[::1]:44410">https://[::1]:44410</a></p></li>
<li><p>path - The REST API path, e.g. /api/auth</p></li>
<li><p>method - e.g. PUT, POST or DELETE</p></li>
<li><p>user - The name of the user, otherwise ‘None’</p></li>
</ul>
<p>The logging of the request payload (the arguments and their values) is enabled
by default. Execute the following command to disable this behaviour:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard set-audit-api-log-payload &lt;true|false&gt;
</pre></div>
</div>
<p>A log entry may look like this:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2018</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">22</span> <span class="mi">15</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mf">01.302514</span> <span class="n">mgr</span><span class="o">.</span><span class="n">x</span> <span class="p">[</span><span class="n">INF</span><span class="p">]</span> <span class="p">[</span><span class="n">DASHBOARD</span><span class="p">]</span> <span class="n">from</span><span class="o">=</span><span class="s1">&#39;https://[::ffff:127.0.0.1]:37022&#39;</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;/api/rgw/user/klaus&#39;</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;PUT&#39;</span> <span class="n">user</span><span class="o">=</span><span class="s1">&#39;admin&#39;</span> <span class="n">params</span><span class="o">=</span><span class="s1">&#39;{&quot;max_buckets&quot;: &quot;1000&quot;, &quot;display_name&quot;: &quot;Klaus Mustermann&quot;, &quot;uid&quot;: &quot;klaus&quot;, &quot;suspended&quot;: &quot;0&quot;, &quot;email&quot;: &quot;klaus.mustermann@ceph.com&quot;}&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="nfs-ganesha">
<h2>NFS-Ganesha 的管理<a class="headerlink" href="#nfs-ganesha" title="Permalink to this headline">¶</a></h2>
<p>Ceph Dashboard can manage <a class="reference external" href="http://nfs-ganesha.github.io/">NFS Ganesha</a> exports that use
CephFS or RadosGW as their backstore.</p>
<p>To enable this feature in Ceph Dashboard there are some assumptions that need
to be met regarding the way NFS-Ganesha services are configured.</p>
<p>The dashboard manages NFS-Ganesha config files stored in RADOS objects on the Ceph Cluster.
NFS-Ganesha must store part of their configuration in the Ceph cluster.</p>
<p>These configuration files must follow some conventions.
conventions.
Each export block must be stored in its own RADOS object named
<code class="docutils literal notranslate"><span class="pre">export-&lt;id&gt;</span></code>, where <code class="docutils literal notranslate"><span class="pre">&lt;id&gt;</span></code> must match the <code class="docutils literal notranslate"><span class="pre">Export_ID</span></code> attribute of the
export configuration. Then, for each NFS-Ganesha service daemon there should
exist a RADOS object named <code class="docutils literal notranslate"><span class="pre">conf-&lt;daemon_id&gt;</span></code>, where <code class="docutils literal notranslate"><span class="pre">&lt;daemon_id&gt;</span></code> is an
arbitrary string that should uniquely identify the daemon instance (e.g., the
hostname where the daemon is running).
Each <code class="docutils literal notranslate"><span class="pre">conf-&lt;daemon_id&gt;</span></code> object contains the RADOS URLs to the exports that
the NFS-Ganesha daemon should serve. These URLs are of the form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="n">url</span> <span class="n">rados</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">pool_name</span><span class="o">&gt;</span><span class="p">[</span><span class="o">/&lt;</span><span class="n">namespace</span><span class="o">&gt;</span><span class="p">]</span><span class="o">/</span><span class="n">export</span><span class="o">-&lt;</span><span class="nb">id</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Both the <code class="docutils literal notranslate"><span class="pre">conf-&lt;daemon_id&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">export-&lt;id&gt;</span></code> objects must be stored in the
same RADOS pool/namespace.</p>
<div class="section" id="id15">
<h3>NFS-Ganesha 在仪表盘中的配置<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<p>To enable the management of NFS-Ganesha exports in Ceph Dashboard, we only
need to tell the Dashboard, in which RADOS pool and namespace the
configuration objects are stored. Then, Ceph Dashboard can access the objects
by following the naming convention described above.</p>
<p>The Dashboard command to configure the NFS-Ganesha configuration objects
location is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard set-ganesha-clusters-rados-pool-namespace &lt;pool_name&gt;[/&lt;namespace&gt;]
</pre></div>
</div>
<p>After running the above command, Ceph Dashboard is able to find the NFS-Ganesha
configuration objects and we can start manage the exports through the Web UI.</p>
</div>
<div class="section" id="id16">
<h3>多个 NFS-Ganesha 集群的支持情况<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<p>Ceph Dashboard also supports the management of NFS-Ganesha exports belonging
to different NFS-Ganesha clusters. An NFS-Ganesha cluster is a group of
NFS-Ganesha service daemons sharing the same exports. Different NFS-Ganesha
clusters are independent and don’t share the exports configuration between each
other.</p>
<p>Each NFS-Ganesha cluster should store its configuration objects in a
different RADOS pool/namespace to isolate the configuration from each other.</p>
<p>To specify the locations of the configuration of each NFS-Ganesha cluster we
can use the same command as above but with a different value pattern:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ ceph dashboard set-ganesha-clusters-rados-pool-namespace &lt;cluster_id&gt;:&lt;pool_name&gt;[/&lt;namespace&gt;](,&lt;cluster_id&gt;:&lt;pool_name&gt;[/&lt;namespace&gt;])*
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">&lt;cluster_id&gt;</span></code> is an arbitrary string that should uniquely identify the
NFS-Ganesha cluster.</p>
<p>When configuring the Ceph Dashboard with multiple NFS-Ganesha clusters, the
Web UI will automatically allow to choose to which cluster an export belongs.</p>
</div>
</div>
</div>



          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../start/intro/">Ceph 简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../start/">安装（ ceph-deploy ）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/">安装（手动）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rados/">Ceph 存储集群</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cephfs/">Ceph 文件系统</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rbd/rbd/">Ceph 块设备</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../radosgw/">Ceph 对象网关</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">Ceph 管理器守护进程</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../administrator/">安装和配置</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugins/">插件编程</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">仪表盘插件</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">概述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">如何启用</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">配置</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#ssl-tls">SSL/TLS 支持</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">主机名和端口</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">用户名和密码</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">启用对象网关管理前端</a></li>
<li class="toctree-l4"><a class="reference internal" href="#iscsi">启用 iSCSI 的管理</a></li>
<li class="toctree-l4"><a class="reference internal" href="#grafana">允许嵌入 Grafana 仪表盘</a></li>
<li class="toctree-l4"><a class="reference internal" href="#single-sign-on-sso">启用单点登录（ Single Sign-On, SSO ）</a></li>
<li class="toctree-l4"><a class="reference internal" href="#prometheus">启用 Prometheus 报警</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">仪表盘的访问</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dashboard-user-role-management">用户和角色管理</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id9">用户帐户</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id10">用户角色和权限</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id11">用户和定制角色创建实例</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id12">反向代理</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dashboard-auditing">审计</a></li>
<li class="toctree-l3"><a class="reference internal" href="#nfs-ganesha">NFS-Ganesha 的管理</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id15">NFS-Ganesha 在仪表盘中的配置</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id16">多个 NFS-Ganesha 集群的支持情况</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../restful/">REST 风格插件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../zabbix/">Zabbix 插件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../prometheus/">Prometheus 插件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iostat/">Iostat 插件</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api/">API 文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture/">体系结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/developer_guide/">开发者指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/internals/">Ceph Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ceph-volume/">ceph-volume</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/">Ceph 版本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary/">Ceph 术语</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../translation_cn/">中文版翻译资源</a></li>
</ul>


<!-- ugly kludge to make genindex look like it's part of the toc -->
<ul style="margin-top: -10px"><li class="toctree-l1"><a class="reference internal" href="../../genindex/">Index</a></li></ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search/" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../restful/" title="rest 风格的插件"
             >next</a> |</li>
        <li class="right" >
          <a href="../plugins/" title="ceph-mgr 插件编程指南"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../" >Ceph 管理器守护进程</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Red Hat, Inc, and contributors. Licensed under Creative Commons Attribution Share Alike 3.0 (CC-BY-SA-3.0).
    </div>
  </body>
</html>