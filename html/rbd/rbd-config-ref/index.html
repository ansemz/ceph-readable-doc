
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>配置选项 &#8212; Ceph Documentation</title>
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/js/ceph.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="RBD 重放" href="../rbd-replay/" />
    <link rel="prev" title="RBD 镜像" href="../rbd-mirroring/" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../rbd-replay/" title="RBD 重放"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../rbd-mirroring/" title="RBD 镜像"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../" >Ceph 块设备</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../rbd-operations/" accesskey="U">Ceph 块设备运维</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            

<div id="dev-warning" class="admonition note" style="display:none;">
  <p class="first admonition-title">Notice</p>
  <p class="last">This document is for a development version of Ceph.</p>
</div>

<div id="eol-warning" class="admonition warning" style="display:none;">
  <p class="first admonition-title">Warning</p>
  <p class="last">This document is for an unsupported version of Ceph.</p>
</div>
  <div id="docubetter" align="right" style="display:none; padding: 15px; font-weight: bold;">
    <a id="edit-on-github" href="https://github.com/ceph/ceph/edit/master/doc/rbd/rbd-config-ref.rst" rel="nofollow">Edit on GitHub</a> | <a href="https://pad.ceph.com/p/Report_Documentation_Bugs">Report a Documentation Bug</a>
  </div>

  
  <div class="section" id="id1">
<h1>配置选项<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>详情见<a class="reference external" href="../../rbd">块设备</a>。</p>
<div class="section" id="io">
<h2>通用 IO 选项<a class="headerlink" href="#io" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">compression</span> <span class="pre">hint</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>Hint to send to the OSDs on write operations. If set to <cite>compressible</cite> and the OSD <cite>bluestore compression mode</cite> setting is <cite>passive</cite>, the OSD will attempt to compress the data. If set to <cite>incompressible</cite> and the OSD compression setting is <cite>aggressive</cite>, the OSD will not attempt to compress the data.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Enum</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">none</span></code></p>
</dd>
<dt class="field-odd">Values</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">none</span></code>, <code class="docutils literal notranslate"><span class="pre">compressible</span></code>, <code class="docutils literal notranslate"><span class="pre">incompressible</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">read</span> <span class="pre">from</span> <span class="pre">replica</span> <span class="pre">policy</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>policy for determining which OSD will receive read operations. If set to <cite>default</cite>, the primary OSD will always be used for read operations. If set to <cite>balance</cite>, read operations will be sent to a randomly selected OSD within the replica set. If set to <cite>localize</cite>, read operations will be sent to the closest OSD as determined by the CRUSH map. Note: this feature requires the cluster to be configured with a minimum compatible OSD release of Octopus.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Enum</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">default</span></code></p>
</dd>
<dt class="field-odd">Values</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">default</span></code>, <code class="docutils literal notranslate"><span class="pre">balance</span></code>, <code class="docutils literal notranslate"><span class="pre">localize</span></code></p>
</dd>
</dl>
</div>
<div class="section" id="id2">
<h2>缓存选项<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<div class="sidebar">
<p class="sidebar-title">内核缓存</p>
<p>Ceph 块设备的内核驱动可利用 Linux 页缓存来提升性能。</p>
</div>
<p>Ceph 块设备的用户空间实现（即 <code class="docutils literal notranslate"><span class="pre">librbd</span></code> ）不能利用 Linux
页缓存，所以它自己实现了内存缓存，名为“ RBD 缓存”。 RBD 缓存就像硬盘缓存一样工作，当 OS 发送了 barrier 或 flush 请求时，所有脏数据都会写入 OSD ，这意味着只要 VM 会正确地发送回写命令（即内核版本大于 2.6.32 ），使用回写缓存就像用正常的物理硬盘一样安全。此缓存用最近最少使用（ Least Recently Used, LRU ）算法，而且在回写模式下它能合并相邻请求以提高吞吐量。</p>
<p>The librbd cache is enabled by default and supports three different cache
policies: write-around, write-back, and write-through. Writes return
immediately under both the write-around and write-back policies, unless there
are more than <code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">cache</span> <span class="pre">max</span> <span class="pre">dirty</span></code> unwritten bytes to the storage cluster.
The write-around policy differs from the write-back policy in that it does
not attempt to service read requests from the cache, unlike the write-back
policy, and is therefore faster for high performance write workloads. Under the
write-through policy, writes return only when the data is on disk on all
replicas, but reads may come from the cache.</p>
<p>Prior to receiving a flush request, the cache behaves like a write-through cache
to ensure safe operation for older operating systems that do not send flushes to
ensure crash consistent behavior.</p>
<p>If the librbd cache is disabled, writes and
reads go directly to the storage cluster, and writes return only when the data
is on disk on all replicas.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The cache is in memory on the client, and each RBD image has
its own.  Since the cache is local to the client, there’s no coherency
if there are others accessing the image. Running GFS or OCFS on top of
RBD will not work with caching enabled.</p>
</div>
<p>RBD 选项应该位于 <code class="docutils literal notranslate"><span class="pre">ceph.conf</span></code> 配置文件的 <code class="docutils literal notranslate"><span class="pre">[client]</span></code> 段下，可用选项有：</p>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">cache</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>允许为 RADOS 块设备提供缓存。</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Boolean</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">cache</span> <span class="pre">policy</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>Select the caching policy for librbd.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Enum</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">writearound</span></code></p>
</dd>
<dt class="field-odd">Values</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">writearound</span></code>, <code class="docutils literal notranslate"><span class="pre">writeback</span></code>, <code class="docutils literal notranslate"><span class="pre">writethrough</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">cache</span> <span class="pre">writethrough</span> <span class="pre">until</span> <span class="pre">flush</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>开始进入 write-through 模式，并且在首个 flush 请求收到后切回 write-back 模式。启用它保守但安全，以防 rbd 之上的虚拟机内核太老、不能发送 flush ，像 2.6.32 之前的
virtio 驱动。</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Boolean</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">true</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">cache</span> <span class="pre">size</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>RBD 缓存尺寸，字节。</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>64-bit Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">32</span> <span class="pre">MiB</span></code></p>
</dd>
<dt class="field-odd">适用策略</dt>
<dd class="field-odd"><p>write-back and write-through</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">cache</span> <span class="pre">max</span> <span class="pre">dirty</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>使缓存触发写回的 <code class="docutils literal notranslate"><span class="pre">dirty</span></code> 临界点，若为 <code class="docutils literal notranslate"><span class="pre">0</span></code> ，直接使用写透缓存。</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>64-bit Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">约束条件</dt>
<dd class="field-even"><p>必须小于 <code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">cache</span> <span class="pre">size</span></code> 。</p>
</dd>
<dt class="field-odd">默认值</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">24</span> <span class="pre">MiB</span></code></p>
</dd>
<dt class="field-even">适用策略</dt>
<dd class="field-even"><p>write-around and write-back</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">cache</span> <span class="pre">target</span> <span class="pre">dirty</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>缓存开始写回数据的目的地 <code class="docutils literal notranslate"><span class="pre">dirty</span> <span class="pre">target</span></code> ，不会阻塞到缓存的写动作。</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>64-bit Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">约束条件</dt>
<dd class="field-even"><p>必须小于 <code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">cache</span> <span class="pre">max</span> <span class="pre">dirty</span></code>.</p>
</dd>
<dt class="field-odd">默认值</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">16</span> <span class="pre">MiB</span></code></p>
</dd>
<dt class="field-even">适用策略</dt>
<dd class="field-even"><p>write-back</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">cache</span> <span class="pre">max</span> <span class="pre">dirty</span> <span class="pre">age</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>写回开始前，脏数据在缓存中的暂存时间。</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Float</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">1.0</span></code></p>
</dd>
<dt class="field-odd">适用策略</dt>
<dd class="field-odd"><p>write-back</p>
</dd>
</dl>
</div>
<div class="section" id="id4">
<h2>预读选项<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>librbd 支持预读或预取功能，以此优化小块的顺序读。此功能通常应该由访客操作系统（是虚拟机）处理，但是引导加载程序还不能进行高效的读。如果缓存功能停用、或策略为 write-around ，预读就会自动被禁用。</p>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">readahead</span> <span class="pre">trigger</span> <span class="pre">requests</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>触发预读的顺序读请求数量。</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">10</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">readahead</span> <span class="pre">max</span> <span class="pre">bytes</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>预读请求最大尺寸，零为禁用预读。</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>64-bit Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">512</span> <span class="pre">KiB</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">readahead</span> <span class="pre">disable</span> <span class="pre">after</span> <span class="pre">bytes</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>从 RBD 映像读取这么多字节后，预读功能将被禁用，直到关闭。这样访客操作系统启动后就可以接管预读了，设为 0 时则仍开启预读。</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>64-bit Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">50</span> <span class="pre">MiB</span></code></p>
</dd>
</dl>
</div>
<div class="section" id="id5">
<h2>映像功能<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>RBD supports advanced features which can be specified via the command line when creating images or the default features can be specified via Ceph config file via ‘rbd_default_features = &lt;sum of feature numeric values&gt;’ or ‘rbd_default_features = &lt;comma-delimited list of CLI values&gt;’</p>
<p><code class="docutils literal notranslate"><span class="pre">Layering</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>Layering enables you to use cloning.</p>
</dd>
<dt class="field-even">内置值</dt>
<dd class="field-even"><p>1</p>
</dd>
<dt class="field-odd">CLI 值</dt>
<dd class="field-odd"><p>layering</p>
</dd>
<dt class="field-even">哪版加入</dt>
<dd class="field-even"><p>v0.52 (Bobtail)</p>
</dd>
<dt class="field-odd">KRBD 支持情况</dt>
<dd class="field-odd"><p>since v3.10</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p>yes</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">Striping</span> <span class="pre">v2</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>Striping spreads data across multiple objects. Striping helps with parallelism for sequential read/write workloads.</p>
</dd>
<dt class="field-even">内置值</dt>
<dd class="field-even"><p>2</p>
</dd>
<dt class="field-odd">CLI 值</dt>
<dd class="field-odd"><p>striping</p>
</dd>
<dt class="field-even">哪版加入</dt>
<dd class="field-even"><p>v0.55 (Bobtail)</p>
</dd>
<dt class="field-odd">KRBD 支持情况</dt>
<dd class="field-odd"><p>since v3.10 (default striping only, “fancy” striping added in v4.17)</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p>yes</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">Exclusive</span> <span class="pre">locking</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>When enabled, it requires a client to get a lock on an object before making a write. Exclusive lock should only be enabled when a single client is accessing an image at the same time.</p>
</dd>
<dt class="field-even">内置值</dt>
<dd class="field-even"><p>4</p>
</dd>
<dt class="field-odd">CLI 值</dt>
<dd class="field-odd"><p>exclusive-lock</p>
</dd>
<dt class="field-even">哪版加入</dt>
<dd class="field-even"><p>v0.92 (Hammer)</p>
</dd>
<dt class="field-odd">KRBD 支持情况</dt>
<dd class="field-odd"><p>since v4.9</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p>yes</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">Object</span> <span class="pre">map</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>Object map support depends on exclusive lock support. Block devices are thin provisioned—meaning, they only store data that actually exists. Object map support helps track which objects actually exist (have data stored on a drive). Enabling object map support speeds up I/O operations for cloning; importing and exporting a sparsely populated image; and deleting.</p>
</dd>
<dt class="field-even">内置值</dt>
<dd class="field-even"><p>8</p>
</dd>
<dt class="field-odd">CLI 值</dt>
<dd class="field-odd"><p>object-map</p>
</dd>
<dt class="field-even">哪版加入</dt>
<dd class="field-even"><p>v0.93 (Hammer)</p>
</dd>
<dt class="field-odd">KRBD 支持情况</dt>
<dd class="field-odd"><p>since v5.3</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p>yes</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">Fast-diff</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>Fast-diff support depends on object map support and exclusive lock support. It adds another property to the object map, which makes it much faster to generate diffs between snapshots of an image, and the actual data usage of a snapshot much faster.</p>
</dd>
<dt class="field-even">内置值</dt>
<dd class="field-even"><p>16</p>
</dd>
<dt class="field-odd">CLI 值</dt>
<dd class="field-odd"><p>fast-diff</p>
</dd>
<dt class="field-even">哪版加入</dt>
<dd class="field-even"><p>v9.0.1 (Infernalis)</p>
</dd>
<dt class="field-odd">KRBD 支持情况</dt>
<dd class="field-odd"><p>since v5.3</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p>yes</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">Deep-flatten</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>Deep-flatten makes rbd flatten work on all the snapshots of an image, in addition to the image itself. Without it, snapshots of an image will still rely on the parent, so the parent will not be delete-able until the snapshots are deleted. Deep-flatten makes a parent independent of its clones, even if they have snapshots.</p>
</dd>
<dt class="field-even">内置值</dt>
<dd class="field-even"><p>32</p>
</dd>
<dt class="field-odd">CLI 值</dt>
<dd class="field-odd"><p>deep-flatten</p>
</dd>
<dt class="field-even">哪版加入</dt>
<dd class="field-even"><p>v9.0.2 (Infernalis)</p>
</dd>
<dt class="field-odd">KRBD 支持情况</dt>
<dd class="field-odd"><p>since v5.1</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p>yes</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">Journaling</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>Journaling support depends on exclusive lock support. Journaling records all modifications to an image in the order they occur. RBD mirroring utilizes the journal to replicate a crash consistent image to a remote cluster.</p>
</dd>
<dt class="field-even">内置值</dt>
<dd class="field-even"><p>64</p>
</dd>
<dt class="field-odd">CLI 值</dt>
<dd class="field-odd"><p>journaling</p>
</dd>
<dt class="field-even">哪版加入</dt>
<dd class="field-even"><p>v10.0.1 (Jewel)</p>
</dd>
<dt class="field-odd">KRBD 支持情况</dt>
<dd class="field-odd"><p>no</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p>no</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">Data</span> <span class="pre">pool</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>On erasure-coded pools, the image data block objects need to be stored on a separate pool from the image metadata.</p>
</dd>
<dt class="field-even">内置值</dt>
<dd class="field-even"><p>128</p>
</dd>
<dt class="field-odd">哪版加入</dt>
<dd class="field-odd"><p>v11.1.0 (Kraken)</p>
</dd>
<dt class="field-even">KRBD 支持情况</dt>
<dd class="field-even"><p>since v4.11</p>
</dd>
<dt class="field-odd">默认值</dt>
<dd class="field-odd"><p>no</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">Operations</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>Used to restrict older clients from performing certain maintenance operations against an image (e.g. clone, snap create).</p>
</dd>
<dt class="field-even">内置值</dt>
<dd class="field-even"><p>256</p>
</dd>
<dt class="field-odd">哪版加入</dt>
<dd class="field-odd"><p>v13.0.2 (Mimic)</p>
</dd>
<dt class="field-even">KRBD 支持情况</dt>
<dd class="field-even"><p>since v4.16</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">Migrating</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>Used to restrict older clients from opening an image when it is in migration state.</p>
</dd>
<dt class="field-even">内置值</dt>
<dd class="field-even"><p>512</p>
</dd>
<dt class="field-odd">哪版加入</dt>
<dd class="field-odd"><p>v14.0.1 (Nautilus)</p>
</dd>
<dt class="field-even">KRBD 支持情况</dt>
<dd class="field-even"><p>no</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">Non-primary</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>Used to restrict changes to non-primary images using snapshot-based mirroring.</p>
</dd>
<dt class="field-even">内置值</dt>
<dd class="field-even"><p>1024</p>
</dd>
<dt class="field-odd">哪版加入</dt>
<dd class="field-odd"><p>v15.2.0 (Octopus)</p>
</dd>
<dt class="field-even">KRBD 支持情况</dt>
<dd class="field-even"><p>no</p>
</dd>
</dl>
</div>
<div class="section" id="qos">
<h2>QOS 选项<a class="headerlink" href="#qos" title="Permalink to this headline">¶</a></h2>
<p>librbd supports limiting per image IO, controlled by the following
settings.</p>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">qos</span> <span class="pre">iops</span> <span class="pre">limit</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>The desired limit of IO operations per second.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">qos</span> <span class="pre">bps</span> <span class="pre">limit</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>The desired limit of IO bytes per second.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">qos</span> <span class="pre">read</span> <span class="pre">iops</span> <span class="pre">limit</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>The desired limit of read operations per second.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">qos</span> <span class="pre">write</span> <span class="pre">iops</span> <span class="pre">limit</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>The desired limit of write operations per second.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">qos</span> <span class="pre">read</span> <span class="pre">bps</span> <span class="pre">limit</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>The desired limit of read bytes per second.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">qos</span> <span class="pre">write</span> <span class="pre">bps</span> <span class="pre">limit</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>The desired limit of write bytes per second.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">qos</span> <span class="pre">iops</span> <span class="pre">burst</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>The desired burst limit of IO operations.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">qos</span> <span class="pre">bps</span> <span class="pre">burst</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>The desired burst limit of IO bytes.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">qos</span> <span class="pre">read</span> <span class="pre">iops</span> <span class="pre">burst</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>The desired burst limit of read operations.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">qos</span> <span class="pre">write</span> <span class="pre">iops</span> <span class="pre">burst</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>The desired burst limit of write operations.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">qos</span> <span class="pre">read</span> <span class="pre">bps</span> <span class="pre">burst</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>The desired burst limit of read bytes.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">qos</span> <span class="pre">write</span> <span class="pre">bps</span> <span class="pre">burst</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>The desired burst limit of write bytes.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">0</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">qos</span> <span class="pre">iops</span> <span class="pre">burst</span> <span class="pre">seconds</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>The desired burst duration in seconds of IO operations.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">qos</span> <span class="pre">bps</span> <span class="pre">burst</span> <span class="pre">seconds</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>The desired burst duration in seconds of IO bytes.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">qos</span> <span class="pre">read</span> <span class="pre">iops</span> <span class="pre">burst</span> <span class="pre">seconds</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>The desired burst duration in seconds of read operations.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">qos</span> <span class="pre">write</span> <span class="pre">iops</span> <span class="pre">burst</span> <span class="pre">seconds</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>The desired burst duration in seconds of write operations.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">qos</span> <span class="pre">read</span> <span class="pre">bps</span> <span class="pre">burst</span> <span class="pre">seconds</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>The desired burst duration in seconds of read bytes.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">qos</span> <span class="pre">write</span> <span class="pre">bps</span> <span class="pre">burst</span> <span class="pre">seconds</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>The desired burst duration in seconds of write bytes.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">1</span></code></p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">rbd</span> <span class="pre">qos</span> <span class="pre">schedule</span> <span class="pre">tick</span> <span class="pre">min</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">描述</dt>
<dd class="field-odd"><p>The minimum schedule tick (in milliseconds) for QoS.</p>
</dd>
<dt class="field-even">类型</dt>
<dd class="field-even"><p>Unsigned Integer</p>
</dd>
<dt class="field-odd">是否必需</dt>
<dd class="field-odd"><p>No</p>
</dd>
<dt class="field-even">默认值</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">50</span></code></p>
</dd>
</dl>
</div>
</div>



          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../start/intro/">Ceph 简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/">安装 Ceph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cephadm/">Cephadm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rados/">Ceph 存储集群</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cephfs/">Ceph 文件系统</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../">Ceph 块设备</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../rados-rbd-cmds/">基本命令</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../rbd-operations/">运维</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../rbd-snapshot/">快照</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rbd-mirroring/">镜像</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">配置选项 (librbd)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#io">通用 IO 选项</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">缓存选项</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id4">预读选项</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id5">映像功能</a></li>
<li class="toctree-l4"><a class="reference internal" href="#qos">QOS 选项</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../rbd-replay/">RBD 重放</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../rbd-integrations/">对接</a></li>
<li class="toctree-l2"><a class="reference internal" href="../man/">手册页</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/">APIs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../radosgw/">Ceph 对象网关</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mgr/">Ceph 管理器守护进程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mgr/dashboard/">Ceph 仪表盘</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/">API 文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture/">体系结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/developer_guide/">开发者指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/internals/">Ceph 内幕</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../governance/">项目管理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../foundation/">Ceph 基金会</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ceph-volume/">ceph-volume</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/general/">Ceph 版本（总目录）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/">Ceph 版本（索引）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary/">Ceph 术语</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../translation_cn/">中文版翻译资源</a></li>
</ul>


<!-- ugly kludge to make genindex look like it's part of the toc -->
<ul style="margin-top: -10px"><li class="toctree-l1"><a class="reference internal" href="../../genindex/">Index</a></li></ul>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search/" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../rbd-replay/" title="RBD 重放"
             >next</a> |</li>
        <li class="right" >
          <a href="../rbd-mirroring/" title="RBD 镜像"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../" >Ceph 块设备</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../rbd-operations/" >Ceph 块设备运维</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Ceph authors and contributors. Licensed under Creative Commons Attribution Share Alike 3.0 (CC-BY-SA-3.0).
    </div>
  </body>
</html>