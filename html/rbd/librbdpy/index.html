
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Librbd 的 Python 接口 &#8212; Ceph Documentation</title>
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/js/ceph.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex/" />
    <link rel="search" title="Search" href="../../search/" />
    <link rel="next" title="Ceph 对象网关" href="../../radosgw/" />
    <link rel="prev" title="rbdmap – 在引导时映射 RBD 设备" href="../../man/8/rbdmap/" />
    <script type="text/javascript" src="http://ayni.ceph.com/public/js/ceph.js"></script>

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../radosgw/" title="Ceph 对象网关"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../../man/8/rbdmap/" title="rbdmap – 在引导时映射 RBD 设备"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../rbd/" accesskey="U">Ceph 块设备</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            

<div id="dev-warning" class="admonition note" style="display:none;">
  <p class="first admonition-title">Notice</p>
  <p class="last">This document is for a development version of Ceph.</p>
</div>

<div id="eol-warning" class="admonition warning" style="display:none;">
  <p class="first admonition-title">Warning</p>
  <p class="last">This document is for an unsupported version of Ceph.</p>
</div>
  <div id="docubetter" align="right" style="display:none; padding: 15px; font-weight: bold;">
    <a id="edit-on-github" href="https://github.com/ceph/ceph/edit/master/doc/rbd/librbdpy.rst" rel="nofollow">Edit on GitHub</a> | <a href="https://github.com/ceph/ceph/projects/4">Report a Documentation Bug</a>
  </div>

  
  <div class="section" id="librbd-python">
<h1>Librbd 的 Python 接口<a class="headerlink" href="#librbd-python" title="Permalink to this headline">¶</a></h1>
<p><cite>rbd</cite> 的 python 模块为 RBD 映像提供了类似文件的访问方法。</p>
<div class="section" id="id1">
<h2>实例：创建一映像并写入<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>要使用 <cite>rbd</cite> ，必须先连接 RADOS 并打开 IO 上下文：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cluster</span> <span class="o">=</span> <span class="n">rados</span><span class="o">.</span><span class="n">Rados</span><span class="p">(</span><span class="n">conffile</span><span class="o">=</span><span class="s1">&#39;my_ceph.conf&#39;</span><span class="p">)</span>
<span class="n">cluster</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="n">ioctx</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">open_ioctx</span><span class="p">(</span><span class="s1">&#39;mypool&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>然后实例化 :class:rbd.RBD 对象，用它来创建映像：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rbd_inst</span> <span class="o">=</span> <span class="n">rbd</span><span class="o">.</span><span class="n">RBD</span><span class="p">()</span>
<span class="n">size</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">3</span>  <span class="c1"># 4 GiB</span>
<span class="n">rbd_inst</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">ioctx</span><span class="p">,</span> <span class="s1">&#39;myimage&#39;</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
<p>要在映像上进行 I/O 操作，需实例化 :class:rbd.Image 对象：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">image</span> <span class="o">=</span> <span class="n">rbd</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">ioctx</span><span class="p">,</span> <span class="s1">&#39;myimage&#39;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span> <span class="o">*</span> <span class="mi">200</span>
<span class="n">image</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>上面的代码向映像前面写入了 600 字节的 foo 字符串。注意数据不能是 :type:unicode ， librbd 不能如何处理大于 :c:type:char 的字符串。</p>
<p>最后，关闭映像、 IO 上下文、和到 RADOS 的连接。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">image</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">ioctx</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="n">cluster</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
</pre></div>
</div>
<p>安全起见，每个调用都应该封装到单独的 :finally 块内。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cluster</span> <span class="o">=</span> <span class="n">rados</span><span class="o">.</span><span class="n">Rados</span><span class="p">(</span><span class="n">conffile</span><span class="o">=</span><span class="s1">&#39;my_ceph_conf&#39;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">ioctx</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">open_ioctx</span><span class="p">(</span><span class="s1">&#39;my_pool&#39;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">rbd_inst</span> <span class="o">=</span> <span class="n">rbd</span><span class="o">.</span><span class="n">RBD</span><span class="p">()</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">3</span>  <span class="c1"># 4 GiB</span>
        <span class="n">rbd_inst</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">ioctx</span><span class="p">,</span> <span class="s1">&#39;myimage&#39;</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
        <span class="n">image</span> <span class="o">=</span> <span class="n">rbd</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">ioctx</span><span class="p">,</span> <span class="s1">&#39;myimage&#39;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span> <span class="o">*</span> <span class="mi">200</span>
            <span class="n">image</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="n">image</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="n">ioctx</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">cluster</span><span class="o">.</span><span class="n">shutdown</span><span class="p">()</span>
</pre></div>
</div>
<p>这样做有些繁琐，所以 <code class="xref py py-class docutils literal notranslate"><span class="pre">Rados</span></code> 、 <code class="xref py py-class docutils literal notranslate"><span class="pre">Ioctx</span></code> 和 <code class="xref py py-class docutils literal notranslate"><span class="pre">Image</span></code> 类可以当上下文管理器来用，它能自动关闭（见 <span class="target" id="index-0"></span><a class="pep reference external" href="https://www.python.org/dev/peps/pep-0343"><strong>PEP 343</strong></a> ）。当上下文管理器用时，上面的实例可以写成：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">rados</span><span class="o">.</span><span class="n">Rados</span><span class="p">(</span><span class="n">conffile</span><span class="o">=</span><span class="s1">&#39;my_ceph.conf&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">cluster</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">cluster</span><span class="o">.</span><span class="n">open_ioctx</span><span class="p">(</span><span class="s1">&#39;mypool&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ioctx</span><span class="p">:</span>
        <span class="n">rbd_inst</span> <span class="o">=</span> <span class="n">rbd</span><span class="o">.</span><span class="n">RBD</span><span class="p">()</span>
        <span class="n">size</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="mi">1024</span><span class="o">**</span><span class="mi">3</span>  <span class="c1"># 4 GiB</span>
        <span class="n">rbd_inst</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">ioctx</span><span class="p">,</span> <span class="s1">&#39;myimage&#39;</span><span class="p">,</span> <span class="n">size</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">rbd</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">ioctx</span><span class="p">,</span> <span class="s1">&#39;myimage&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">image</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="s1">&#39;foo&#39;</span> <span class="o">*</span> <span class="mi">200</span>
            <span class="n">image</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="module-rbd">
<span id="api"></span><h2>API 参考<a class="headerlink" href="#module-rbd" title="Permalink to this headline">¶</a></h2>
<p>This module is a thin wrapper around librbd.</p>
<p>It currently provides all the synchronous methods of librbd that do
not use callbacks.</p>
<p>Error codes from librbd are turned into exceptions that subclass
<code class="xref py py-class docutils literal notranslate"><span class="pre">Error</span></code>. Almost all methods may raise <code class="xref py py-class docutils literal notranslate"><span class="pre">Error</span></code>
(the base class of all rbd exceptions), <code class="xref py py-class docutils literal notranslate"><span class="pre">PermissionError</span></code>
and <code class="xref py py-class docutils literal notranslate"><span class="pre">IOError</span></code>, in addition to those documented for the
method.</p>
<dl class="class">
<dt id="rbd.RBD">
<em class="property">class </em><code class="descclassname">rbd.</code><code class="descname">RBD</code><a class="headerlink" href="#rbd.RBD" title="Permalink to this definition">¶</a></dt>
<dd><p>This class wraps librbd CRUD functions.</p>
<dl class="attribute">
<dt id="rbd.RBD.clone">
<code class="descname">clone</code><a class="headerlink" href="#rbd.RBD.clone" title="Permalink to this definition">¶</a></dt>
<dd><p>Clone a parent rbd snapshot into a COW sparse child.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>p_ioctx</strong> – the parent context that represents the parent snap</li>
<li><strong>p_name</strong> – the parent image name</li>
<li><strong>p_snapname</strong> – the parent image snapshot name</li>
<li><strong>c_ioctx</strong> – the child context that represents the new clone</li>
<li><strong>c_name</strong> – the clone (child) name</li>
<li><strong>features</strong> (<em>int</em>) – bitmask of features to enable; if set, must include layering</li>
<li><strong>order</strong> (<em>int</em>) – the image is split into (2**order) byte objects</li>
<li><strong>stripe_unit</strong> (<em>int</em>) – stripe unit in bytes (default None to let librbd decide)</li>
<li><strong>stripe_count</strong> (<em>int</em>) – objects to stripe over before looping</li>
<li><strong>data_pool</strong> (<em>str</em>) – optional separate pool for data blocks</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeError</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">InvalidArgument</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageExists</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionNotSupported</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArgumentOutOfRange</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.config_list">
<code class="descname">config_list</code><a class="headerlink" href="#rbd.RBD.config_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List pool-level config overrides.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConfigPoolIterator</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.create">
<code class="descname">create</code><a class="headerlink" href="#rbd.RBD.create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an rbd image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – the context in which to create the image</li>
<li><strong>name</strong> (<em>str</em>) – what the image is called</li>
<li><strong>size</strong> (<em>int</em>) – how big the image is in bytes</li>
<li><strong>order</strong> (<em>int</em>) – the image is split into (2**order) byte objects</li>
<li><strong>old_format</strong> (<em>bool</em>) – whether to create an old-style image that
is accessible by old clients, but can’t
use more advanced features like layering.</li>
<li><strong>features</strong> (<em>int</em>) – bitmask of features to enable</li>
<li><strong>stripe_unit</strong> (<em>int</em>) – stripe unit in bytes (default None to let librbd decide)</li>
<li><strong>stripe_count</strong> (<em>int</em>) – objects to stripe over before looping</li>
<li><strong>data_pool</strong> (<em>str</em>) – optional separate pool for data blocks</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageExists</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeError</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">InvalidArgument</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionNotSupported</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.group_create">
<code class="descname">group_create</code><a class="headerlink" href="#rbd.RBD.group_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a group.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool is used</li>
<li><strong>name</strong> (<em>str</em>) – the name of the group</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">ObjectExists</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">InvalidArgument</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionNotSupported</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.group_list">
<code class="descname">group_list</code><a class="headerlink" href="#rbd.RBD.group_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List groups.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool is read</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list – a list of groups names</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionNotSupported</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.group_remove">
<code class="descname">group_remove</code><a class="headerlink" href="#rbd.RBD.group_remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete an RBD group. This may take a long time, since it does
not return until every image in the group has been removed
from the group.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool the group is in</li>
<li><strong>name</strong> (<em>str</em>) – the name of the group to remove</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">ObjectNotFound</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">InvalidArgument</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionNotSupported</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.group_rename">
<code class="descname">group_rename</code><a class="headerlink" href="#rbd.RBD.group_rename" title="Permalink to this definition">¶</a></dt>
<dd><p>Rename an RBD group.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool the group is in</li>
<li><strong>src</strong> (<em>str</em>) – the current name of the group</li>
<li><strong>dest</strong> (<em>str</em>) – the new name of the group</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">ObjectExists</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">ObjectNotFound</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">InvalidArgument</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionNotSupported</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.list">
<code class="descname">list</code><a class="headerlink" href="#rbd.RBD.list" title="Permalink to this definition">¶</a></dt>
<dd><p>List image names.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool is read</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list – a list of image names</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.list2">
<code class="descname">list2</code><a class="headerlink" href="#rbd.RBD.list2" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over the images in the pool.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool the image is in</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageIterator</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.migration_abort">
<code class="descname">migration_abort</code><a class="headerlink" href="#rbd.RBD.migration_abort" title="Permalink to this definition">¶</a></dt>
<dd><p>Cancel a previously started but interrupted migration.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool the image is in</li>
<li><strong>image_name</strong> (<em>str</em>) – the name of the image</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageNotFound</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.migration_commit">
<code class="descname">migration_commit</code><a class="headerlink" href="#rbd.RBD.migration_commit" title="Permalink to this definition">¶</a></dt>
<dd><p>Commit an executed RBD image migration.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool the image is in</li>
<li><strong>image_name</strong> (<em>str</em>) – the name of the image</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageNotFound</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.migration_execute">
<code class="descname">migration_execute</code><a class="headerlink" href="#rbd.RBD.migration_execute" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute a prepared RBD image migration.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool the image is in</li>
<li><strong>image_name</strong> (<em>str</em>) – the name of the image</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageNotFound</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.migration_prepare">
<code class="descname">migration_prepare</code><a class="headerlink" href="#rbd.RBD.migration_prepare" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare an RBD image migration.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool the image is in</li>
<li><strong>image_name</strong> – the current name of the image</li>
<li><strong>dest_ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which pool to migration into</li>
<li><strong>dest_image_name</strong> (<em>str</em>) – the name of the destination image (may be the same image)</li>
<li><strong>features</strong> (<em>int</em>) – bitmask of features to enable; if set, must include layering</li>
<li><strong>order</strong> (<em>int</em>) – the image is split into (2**order) byte objects</li>
<li><strong>stripe_unit</strong> (<em>int</em>) – stripe unit in bytes (default None to let librbd decide)</li>
<li><strong>stripe_count</strong> (<em>int</em>) – objects to stripe over before looping</li>
<li><strong>data_pool</strong> (<em>str</em>) – optional separate pool for data blocks</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeError</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">InvalidArgument</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageExists</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionNotSupported</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArgumentOutOfRange</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.migration_status">
<code class="descname">migration_status</code><a class="headerlink" href="#rbd.RBD.migration_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Return RBD image migration status.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool the image is in</li>
<li><strong>image_name</strong> (<em>str</em>) – the name of the image</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>dict - contains the following keys:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">source_pool_id</span></code> (int) - source image pool id</li>
<li><code class="docutils literal notranslate"><span class="pre">source_pool_namespace</span></code> (str) - source image pool namespace</li>
<li><code class="docutils literal notranslate"><span class="pre">source_image_name</span></code> (str) - source image name</li>
<li><code class="docutils literal notranslate"><span class="pre">source_image_id</span></code> (str) - source image id</li>
<li><code class="docutils literal notranslate"><span class="pre">dest_pool_id</span></code> (int) - destination image pool id</li>
<li><code class="docutils literal notranslate"><span class="pre">dest_pool_namespace</span></code> (str) - destination image pool namespace</li>
<li><code class="docutils literal notranslate"><span class="pre">dest_image_name</span></code> (str) - destination image name</li>
<li><code class="docutils literal notranslate"><span class="pre">dest_image_id</span></code> (str) - destination image id</li>
<li><code class="docutils literal notranslate"><span class="pre">state</span></code> (int) - current migration state</li>
<li><code class="docutils literal notranslate"><span class="pre">state_description</span></code> (str) - migration state description</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageNotFound</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.mirror_image_instance_id_list">
<code class="descname">mirror_image_instance_id_list</code><a class="headerlink" href="#rbd.RBD.mirror_image_instance_id_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over the mirror image instance ids of a pool.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool is read</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">MirrorImageInstanceIdIterator</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.mirror_image_status_list">
<code class="descname">mirror_image_status_list</code><a class="headerlink" href="#rbd.RBD.mirror_image_status_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over the mirror image statuses of a pool.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool is read</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">MirrorImageStatusIterator</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.mirror_image_status_summary">
<code class="descname">mirror_image_status_summary</code><a class="headerlink" href="#rbd.RBD.mirror_image_status_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Get mirror image status summary of a pool.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool is read</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list - a list of (state, count) tuples</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.mirror_mode_get">
<code class="descname">mirror_mode_get</code><a class="headerlink" href="#rbd.RBD.mirror_mode_get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get pool mirror mode.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool is read</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">int - pool mirror mode</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.mirror_mode_set">
<code class="descname">mirror_mode_set</code><a class="headerlink" href="#rbd.RBD.mirror_mode_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Set pool mirror mode.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool is written</li>
<li><strong>mirror_mode</strong> (<em>int</em>) – mirror mode to set</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.mirror_peer_add">
<code class="descname">mirror_peer_add</code><a class="headerlink" href="#rbd.RBD.mirror_peer_add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add mirror peer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool is used</li>
<li><strong>cluster_name</strong> (<em>str</em>) – mirror peer cluster name</li>
<li><strong>client_name</strong> (<em>str</em>) – mirror peer client name</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">str - peer uuid</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.mirror_peer_get_attributes">
<code class="descname">mirror_peer_get_attributes</code><a class="headerlink" href="#rbd.RBD.mirror_peer_get_attributes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get optional mirror peer attributes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool is written</li>
<li><strong>uuid</strong> (<em>str</em>) – uuid of the mirror peer</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>dict - contains the following keys:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">mon_host</span></code> (str) - monitor addresses</li>
<li><code class="docutils literal notranslate"><span class="pre">key</span></code> (str) - CephX key</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.mirror_peer_list">
<code class="descname">mirror_peer_list</code><a class="headerlink" href="#rbd.RBD.mirror_peer_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over the peers of a pool.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool is read</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">MirrorPeerIterator</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.mirror_peer_remove">
<code class="descname">mirror_peer_remove</code><a class="headerlink" href="#rbd.RBD.mirror_peer_remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove mirror peer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool is used</li>
<li><strong>uuid</strong> (<em>str</em>) – peer uuid</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.mirror_peer_set_attributes">
<code class="descname">mirror_peer_set_attributes</code><a class="headerlink" href="#rbd.RBD.mirror_peer_set_attributes" title="Permalink to this definition">¶</a></dt>
<dd><p>Set optional mirror peer attributes</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool is written</li>
<li><strong>uuid</strong> (<em>str</em>) – uuid of the mirror peer</li>
<li><strong>attributes</strong> (<em>dict</em>) – ‘mon_host’ and ‘key’ attributes</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.mirror_peer_set_client">
<code class="descname">mirror_peer_set_client</code><a class="headerlink" href="#rbd.RBD.mirror_peer_set_client" title="Permalink to this definition">¶</a></dt>
<dd><p>Set mirror peer client name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool is written</li>
<li><strong>uuid</strong> (<em>str</em>) – uuid of the mirror peer</li>
<li><strong>client_name</strong> (<em>str</em>) – client name of the mirror peer to set</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.mirror_peer_set_cluster">
<code class="descname">mirror_peer_set_cluster</code><a class="headerlink" href="#rbd.RBD.mirror_peer_set_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Set mirror peer cluster name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool is written</li>
<li><strong>uuid</strong> (<em>str</em>) – uuid of the mirror peer</li>
<li><strong>cluster_name</strong> (<em>str</em>) – cluster name of the mirror peer to set</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.namespace_create">
<code class="descname">namespace_create</code><a class="headerlink" href="#rbd.RBD.namespace_create" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an RBD namespace within a pool</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool</li>
<li><strong>name</strong> (<em>str</em>) – namespace name</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.namespace_exists">
<code class="descname">namespace_exists</code><a class="headerlink" href="#rbd.RBD.namespace_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Verifies if a namespace exists within a pool</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool</li>
<li><strong>name</strong> (<em>str</em>) – namespace name</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">bool - true if namespace exists</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.namespace_list">
<code class="descname">namespace_list</code><a class="headerlink" href="#rbd.RBD.namespace_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List all namespaces within a pool</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list - collection of namespace names</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.namespace_remove">
<code class="descname">namespace_remove</code><a class="headerlink" href="#rbd.RBD.namespace_remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove an RBD namespace from a pool</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool</li>
<li><strong>name</strong> (<em>str</em>) – namespace name</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.pool_init">
<code class="descname">pool_init</code><a class="headerlink" href="#rbd.RBD.pool_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize an RBD pool
:param ioctx: determines which RADOS pool
:type ioctx: <code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>
:param force: force init
:type force: bool</p>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.pool_metadata_get">
<code class="descname">pool_metadata_get</code><a class="headerlink" href="#rbd.RBD.pool_metadata_get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get pool metadata for the given key.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool is read</li>
<li><strong>key</strong> (<em>str</em>) – metadata key</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">str - metadata value</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.pool_metadata_list">
<code class="descname">pool_metadata_list</code><a class="headerlink" href="#rbd.RBD.pool_metadata_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List pool metadata.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">PoolMetadataIterator</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.pool_metadata_remove">
<code class="descname">pool_metadata_remove</code><a class="headerlink" href="#rbd.RBD.pool_metadata_remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove pool metadata for the given key.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool is read</li>
<li><strong>key</strong> (<em>str</em>) – metadata key</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">str - metadata value</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.pool_metadata_set">
<code class="descname">pool_metadata_set</code><a class="headerlink" href="#rbd.RBD.pool_metadata_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Set pool metadata for the given key.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool is read</li>
<li><strong>key</strong> (<em>str</em>) – metadata key</li>
<li><strong>value</strong> (<em>str</em>) – metadata value</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.pool_stats_get">
<code class="descname">pool_stats_get</code><a class="headerlink" href="#rbd.RBD.pool_stats_get" title="Permalink to this definition">¶</a></dt>
<dd><p>Return RBD pool stats</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">dict - contains the following keys:<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">image_count</span></code> (int) - image count</li>
<li><code class="docutils literal notranslate"><span class="pre">image_provisioned_bytes</span></code> (int) - image total HEAD provisioned bytes</li>
<li><code class="docutils literal notranslate"><span class="pre">image_max_provisioned_bytes</span></code> (int) - image total max provisioned bytes</li>
<li><code class="docutils literal notranslate"><span class="pre">image_snap_count</span></code> (int) - image snap count</li>
<li><code class="docutils literal notranslate"><span class="pre">trash_count</span></code> (int) - trash image count</li>
<li><code class="docutils literal notranslate"><span class="pre">trash_provisioned_bytes</span></code> (int) - trash total HEAD provisioned bytes</li>
<li><code class="docutils literal notranslate"><span class="pre">trash_max_provisioned_bytes</span></code> (int) - trash total max provisioned bytes</li>
<li><code class="docutils literal notranslate"><span class="pre">trash_snap_count</span></code> (int) - trash snap count</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.remove">
<code class="descname">remove</code><a class="headerlink" href="#rbd.RBD.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete an RBD image. This may take a long time, since it does
not return until every object that comprises the image has
been deleted. Note that all snapshots must be deleted before
the image can be removed. If there are snapshots left,
<code class="xref py py-class docutils literal notranslate"><span class="pre">ImageHasSnapshots</span></code> is raised. If the image is still
open, or the watch from a crashed client has not expired,
<code class="xref py py-class docutils literal notranslate"><span class="pre">ImageBusy</span></code> is raised.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool the image is in</li>
<li><strong>name</strong> (<em>str</em>) – the name of the image to remove</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageNotFound</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ImageBusy</span></code>,
<code class="xref py py-class docutils literal notranslate"><span class="pre">ImageHasSnapshots</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.rename">
<code class="descname">rename</code><a class="headerlink" href="#rbd.RBD.rename" title="Permalink to this definition">¶</a></dt>
<dd><p>Rename an RBD image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool the image is in</li>
<li><strong>src</strong> (<em>str</em>) – the current name of the image</li>
<li><strong>dest</strong> (<em>str</em>) – the new name of the image</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageNotFound</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ImageExists</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.trash_get">
<code class="descname">trash_get</code><a class="headerlink" href="#rbd.RBD.trash_get" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve RBD image info from trash.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool the image is in</li>
<li><strong>image_id</strong> (<em>str</em>) – the id of the image to restore</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><p>dict - contains the following keys:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">id</span></code> (str) - image id</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code> (str) - image name</li>
<li><code class="docutils literal notranslate"><span class="pre">source</span></code> (str) - source of deletion</li>
<li><code class="docutils literal notranslate"><span class="pre">deletion_time</span></code> (datetime) - time of deletion</li>
<li><code class="docutils literal notranslate"><span class="pre">deferment_end_time</span></code> (datetime) - time that an image is allowed
to be removed from trash</li>
</ul>
</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageNotFound</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.trash_list">
<code class="descname">trash_list</code><a class="headerlink" href="#rbd.RBD.trash_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List all entries from trash.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool the image is in</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrashIterator</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.trash_move">
<code class="descname">trash_move</code><a class="headerlink" href="#rbd.RBD.trash_move" title="Permalink to this definition">¶</a></dt>
<dd><p>Move an RBD image to the trash.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool the image is in</li>
<li><strong>name</strong> (<em>str</em>) – the name of the image to remove</li>
<li><strong>delay</strong> (<em>int</em>) – time delay in seconds before the image can be deleted
from trash</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageNotFound</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.trash_purge">
<code class="descname">trash_purge</code><a class="headerlink" href="#rbd.RBD.trash_purge" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete RBD images from trash in bulk.</p>
<p>By default it removes images with deferment end time less than now.</p>
<p>The timestamp is configurable, e.g. delete images that have expired a
week ago.</p>
<p>If the threshold is used it deletes images until X% pool usage is met.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool the image is in</li>
<li><strong>expire_ts</strong> (<em>datetime</em>) – timestamp for images to be considered as expired (UTC)</li>
<li><strong>threshold</strong> (<em>float</em>) – percentage of pool usage to be met (0 to 1)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.trash_remove">
<code class="descname">trash_remove</code><a class="headerlink" href="#rbd.RBD.trash_remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete an RBD image from trash. If image deferment time has not
expired <code class="xref py py-class docutils literal notranslate"><span class="pre">PermissionError</span></code> is raised.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool the image is in</li>
<li><strong>image_id</strong> (<em>str</em>) – the id of the image to remove</li>
<li><strong>force</strong> (<em>bool</em>) – force remove even if deferment time has not expired</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageNotFound</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">PermissionError</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.trash_restore">
<code class="descname">trash_restore</code><a class="headerlink" href="#rbd.RBD.trash_restore" title="Permalink to this definition">¶</a></dt>
<dd><p>Restore an RBD image from trash.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which RADOS pool the image is in</li>
<li><strong>image_id</strong> (<em>str</em>) – the id of the image to restore</li>
<li><strong>name</strong> (<em>str</em>) – the new name of the restored image</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageNotFound</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="rbd.RBD.version">
<code class="descname">version</code><a class="headerlink" href="#rbd.RBD.version" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the version number of the <code class="docutils literal notranslate"><span class="pre">librbd</span></code> C library.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a tuple of <code class="docutils literal notranslate"><span class="pre">(major,</span> <span class="pre">minor,</span> <span class="pre">extra)</span></code> components of the
librbd version</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="rbd.Image">
<em class="property">class </em><code class="descclassname">rbd.</code><code class="descname">Image</code><span class="sig-paren">(</span><em>ioctx</em>, <em>name=None</em>, <em>snapshot=None</em>, <em>read_only=False</em>, <em>image_id=None</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image" title="Permalink to this definition">¶</a></dt>
<dd><p>This class represents an RBD image. It is used to perform I/O on
the image and interact with snapshots.</p>
<p><strong>Note</strong>: Any method of this class may raise <code class="xref py py-class docutils literal notranslate"><span class="pre">ImageNotFound</span></code>
if the image has been deleted.</p>
<dl class="method">
<dt id="rbd.Image.access_timestamp">
<code class="descname">access_timestamp</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.access_timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the access timestamp for the image.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.aio_discard">
<code class="descname">aio_discard</code><span class="sig-paren">(</span><em>self</em>, <em>offset</em>, <em>length</em>, <em>oncomplete</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.aio_discard" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronously trim the range from the image. It will be logically
filled with zeroes.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.aio_flush">
<code class="descname">aio_flush</code><span class="sig-paren">(</span><em>self</em>, <em>oncomplete</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.aio_flush" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronously wait until all writes are fully flushed if caching is
enabled.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.aio_read">
<code class="descname">aio_read</code><span class="sig-paren">(</span><em>self</em>, <em>offset</em>, <em>length</em>, <em>oncomplete</em>, <em>fadvise_flags=0</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.aio_read" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronously read data from the image</p>
<p>Raises <code class="xref py py-class docutils literal notranslate"><span class="pre">InvalidArgument</span></code> if part of the range specified is
outside the image.</p>
<p>oncomplete will be called with the returned read value as
well as the completion:</p>
<p>oncomplete(completion, data_read)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>offset</strong> (<em>int</em>) – the offset to start reading at</li>
<li><strong>length</strong> (<em>int</em>) – how many bytes to read</li>
<li><strong>oncomplete</strong> (<em>completion</em>) – what to do when the read is complete</li>
<li><strong>fadvise_flags</strong> (<em>int</em>) – fadvise flags for this read</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code> - the completion object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">InvalidArgument</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">IOError</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.aio_write">
<code class="descname">aio_write</code><span class="sig-paren">(</span><em>self</em>, <em>data</em>, <em>offset</em>, <em>oncomplete</em>, <em>fadvise_flags=0</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.aio_write" title="Permalink to this definition">¶</a></dt>
<dd><p>Asynchronously write data to the image</p>
<p>Raises <code class="xref py py-class docutils literal notranslate"><span class="pre">InvalidArgument</span></code> if part of the write would fall outside
the image.</p>
<p>oncomplete will be called with the completion:</p>
<p>oncomplete(completion)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>bytes</em>) – the data to be written</li>
<li><strong>offset</strong> (<em>int</em>) – the offset to start writing at</li>
<li><strong>oncomplete</strong> (<em>completion</em>) – what to do when the write is complete</li>
<li><strong>fadvise_flags</strong> (<em>int</em>) – fadvise flags for this write</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">Completion</span></code> - the completion object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">InvalidArgument</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">IOError</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.block_name_prefix">
<code class="descname">block_name_prefix</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.block_name_prefix" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the RBD block name prefix</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">str - block name prefix</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.break_lock">
<code class="descname">break_lock</code><span class="sig-paren">(</span><em>self</em>, <em>client</em>, <em>cookie</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.break_lock" title="Permalink to this definition">¶</a></dt>
<dd><p>Release a lock held by another rados client.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.close">
<code class="descname">close</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Release the resources used by this image object.</p>
<p>After this is called, this object should not be used.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.config_list">
<code class="descname">config_list</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.config_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List image-level config overrides.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConfigPoolIterator</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><em>self</em>, <em>dest_ioctx</em>, <em>dest_name</em>, <em>features=None</em>, <em>order=None</em>, <em>stripe_unit=None</em>, <em>stripe_count=None</em>, <em>data_pool=None</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Copy the image to another location.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dest_ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which pool to copy into</li>
<li><strong>dest_name</strong> (<em>str</em>) – the name of the copy</li>
<li><strong>features</strong> (<em>int</em>) – bitmask of features to enable; if set, must include layering</li>
<li><strong>order</strong> (<em>int</em>) – the image is split into (2**order) byte objects</li>
<li><strong>stripe_unit</strong> (<em>int</em>) – stripe unit in bytes (default None to let librbd decide)</li>
<li><strong>stripe_count</strong> (<em>int</em>) – objects to stripe over before looping</li>
<li><strong>data_pool</strong> (<em>str</em>) – optional separate pool for data blocks</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeError</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">InvalidArgument</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageExists</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionNotSupported</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArgumentOutOfRange</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.create_snap">
<code class="descname">create_snap</code><span class="sig-paren">(</span><em>self</em>, <em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.create_snap" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a snapshot of the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) – the name of the snapshot</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageExists</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.create_timestamp">
<code class="descname">create_timestamp</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.create_timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the create timestamp for the image.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.data_pool_id">
<code class="descname">data_pool_id</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.data_pool_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the pool id of the pool where the data of this RBD image is stored.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">int - the pool id</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.deep_copy">
<code class="descname">deep_copy</code><span class="sig-paren">(</span><em>self</em>, <em>dest_ioctx</em>, <em>dest_name</em>, <em>features=None</em>, <em>order=None</em>, <em>stripe_unit=None</em>, <em>stripe_count=None</em>, <em>data_pool=None</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.deep_copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Deep copy the image to another location.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dest_ioctx</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">rados.Ioctx</span></code>) – determines which pool to copy into</li>
<li><strong>dest_name</strong> (<em>str</em>) – the name of the copy</li>
<li><strong>features</strong> (<em>int</em>) – bitmask of features to enable; if set, must include layering</li>
<li><strong>order</strong> (<em>int</em>) – the image is split into (2**order) byte objects</li>
<li><strong>stripe_unit</strong> (<em>int</em>) – stripe unit in bytes (default None to let librbd decide)</li>
<li><strong>stripe_count</strong> (<em>int</em>) – objects to stripe over before looping</li>
<li><strong>data_pool</strong> (<em>str</em>) – optional separate pool for data blocks</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">TypeError</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">InvalidArgument</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageExists</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><code class="xref py py-class docutils literal notranslate"><span class="pre">FunctionNotSupported</span></code></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">ArgumentOutOfRange</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.diff_iterate">
<code class="descname">diff_iterate</code><span class="sig-paren">(</span><em>self</em>, <em>offset</em>, <em>length</em>, <em>from_snapshot</em>, <em>iterate_cb</em>, <em>include_parent=True</em>, <em>whole_object=False</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.diff_iterate" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over the changed extents of an image.</p>
<p>This will call iterate_cb with three arguments:</p>
<p>(offset, length, exists)</p>
<p>where the changed extent starts at offset bytes, continues for
length bytes, and is full of data (if exists is True) or zeroes
(if exists is False).</p>
<p>If from_snapshot is None, it is interpreted as the beginning
of time and this generates all allocated extents.</p>
<p>The end version is whatever is currently selected (via set_snap)
for the image.</p>
<p>iterate_cb may raise an exception, which will abort the diff and will be
propagated to the caller.</p>
<p>Raises <code class="xref py py-class docutils literal notranslate"><span class="pre">InvalidArgument</span></code> if from_snapshot is after
the currently set snapshot.</p>
<p>Raises <code class="xref py py-class docutils literal notranslate"><span class="pre">ImageNotFound</span></code> if from_snapshot is not the name
of a snapshot of the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>offset</strong> (<em>int</em>) – start offset in bytes</li>
<li><strong>length</strong> (<em>int</em>) – size of region to report on, in bytes</li>
<li><strong>from_snapshot</strong> (<em>str</em><em> or </em><em>None</em>) – starting snapshot name, or None</li>
<li><strong>iterate_cb</strong> (<em>function acception arguments for offset</em><em>,
</em><em>length</em><em>, </em><em>and exists</em>) – function to call for each extent</li>
<li><strong>include_parent</strong> (<em>bool</em>) – True if full history diff should include parent</li>
<li><strong>whole_object</strong> (<em>bool</em>) – True if diff extents should cover whole object</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">InvalidArgument</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">IOError</span></code>,
<code class="xref py py-class docutils literal notranslate"><span class="pre">ImageNotFound</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.discard">
<code class="descname">discard</code><span class="sig-paren">(</span><em>self</em>, <em>offset</em>, <em>length</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.discard" title="Permalink to this definition">¶</a></dt>
<dd><p>Trim the range from the image. It will be logically filled
with zeroes.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.features">
<code class="descname">features</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.features" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the features bitmask of the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">int - the features bitmask of the image</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.flags">
<code class="descname">flags</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.flags" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the flags bitmask of the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">int - the flags bitmask of the image</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.flatten">
<code class="descname">flatten</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.flatten" title="Permalink to this definition">¶</a></dt>
<dd><p>Flatten clone image (copy all blocks from parent to child)</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.flush">
<code class="descname">flush</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.flush" title="Permalink to this definition">¶</a></dt>
<dd><p>Block until all writes are fully flushed if caching is enabled.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.get_name">
<code class="descname">get_name</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.get_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the RBD image name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">str - image name</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.get_snap_limit">
<code class="descname">get_snap_limit</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.get_snap_limit" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the snapshot limit for an image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">int - the snapshot limit for an image</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.get_snap_timestamp">
<code class="descname">get_snap_timestamp</code><span class="sig-paren">(</span><em>self</em>, <em>snap_id</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.get_snap_timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the snapshot timestamp for an image.
:param snap_id: the snapshot id of a snap shot
:returns: datetime - the snapshot timestamp for an image</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.group">
<code class="descname">group</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.group" title="Permalink to this definition">¶</a></dt>
<dd><p>Get information about the image’s group.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dict - contains the following keys:<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">pool</span></code> (int) - id of the group pool</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code> (str) - name of the group</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.id">
<code class="descname">id</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the RBD v2 internal image id</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">str - image id</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.invalidate_cache">
<code class="descname">invalidate_cache</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.invalidate_cache" title="Permalink to this definition">¶</a></dt>
<dd><p>Drop any cached data for the image.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.is_exclusive_lock_owner">
<code class="descname">is_exclusive_lock_owner</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.is_exclusive_lock_owner" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the status of the image exclusive lock.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">bool - true if the image is exclusively locked</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.is_protected_snap">
<code class="descname">is_protected_snap</code><span class="sig-paren">(</span><em>self</em>, <em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.is_protected_snap" title="Permalink to this definition">¶</a></dt>
<dd><p>Find out whether a snapshot is protected from deletion.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) – the snapshot to check</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">bool - whether the snapshot is protected</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOError</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ImageNotFound</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.list_children">
<code class="descname">list_children</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.list_children" title="Permalink to this definition">¶</a></dt>
<dd><p>List children of the currently set snapshot (set via set_snap()).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list - a list of (pool name, image name) tuples</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.list_children2">
<code class="descname">list_children2</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.list_children2" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over the children of a snapshot.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChildIterator</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.list_lockers">
<code class="descname">list_lockers</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.list_lockers" title="Permalink to this definition">¶</a></dt>
<dd><p>List clients that have locked the image and information
about the lock.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dict - contains the following keys:<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">tag</span></code> - the tag associated with the lock (every
additional locker must use the same tag)</li>
<li><dl class="first docutils">
<dt><code class="docutils literal notranslate"><span class="pre">exclusive</span></code> - boolean indicating whether the</dt>
<dd>lock is exclusive or shared</dd>
</dl>
</li>
<li><code class="docutils literal notranslate"><span class="pre">lockers</span></code> - a list of (client, cookie, address)
tuples</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.list_snaps">
<code class="descname">list_snaps</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.list_snaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over the snapshots of an image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="#rbd.SnapIterator" title="rbd.SnapIterator"><code class="xref py py-class docutils literal notranslate"><span class="pre">SnapIterator</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.lock_acquire">
<code class="descname">lock_acquire</code><span class="sig-paren">(</span><em>self</em>, <em>lock_mode</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.lock_acquire" title="Permalink to this definition">¶</a></dt>
<dd><p>Acquire a managed lock on the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>lock_mode</strong> (<em>int</em>) – lock mode to set</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageBusy</span></code> if the lock could not be acquired</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.lock_break">
<code class="descname">lock_break</code><span class="sig-paren">(</span><em>self</em>, <em>lock_mode</em>, <em>lock_owner</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.lock_break" title="Permalink to this definition">¶</a></dt>
<dd><p>Break the image lock held by a another client.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>lock_owner</strong> (<em>str</em>) – the owner of the lock to break</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.lock_exclusive">
<code class="descname">lock_exclusive</code><span class="sig-paren">(</span><em>self</em>, <em>cookie</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.lock_exclusive" title="Permalink to this definition">¶</a></dt>
<dd><p>Take an exclusive lock on the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageBusy</span></code> if a different client or cookie locked it
<code class="xref py py-class docutils literal notranslate"><span class="pre">ImageExists</span></code> if the same client and cookie locked it</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.lock_get_owners">
<code class="descname">lock_get_owners</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.lock_get_owners" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate over the lock owners of an image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">LockOwnerIterator</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.lock_release">
<code class="descname">lock_release</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.lock_release" title="Permalink to this definition">¶</a></dt>
<dd><p>Release a managed lock on the image that was previously acquired.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.lock_shared">
<code class="descname">lock_shared</code><span class="sig-paren">(</span><em>self</em>, <em>cookie</em>, <em>tag</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.lock_shared" title="Permalink to this definition">¶</a></dt>
<dd><p>Take a shared lock on the image. The tag must match
that of the existing lockers, if any.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageBusy</span></code> if a different client or cookie locked it
<code class="xref py py-class docutils literal notranslate"><span class="pre">ImageExists</span></code> if the same client and cookie locked it</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.metadata_get">
<code class="descname">metadata_get</code><span class="sig-paren">(</span><em>self</em>, <em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.metadata_get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get image metadata for the given key.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> (<em>str</em>) – metadata key</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">str - metadata value</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.metadata_list">
<code class="descname">metadata_list</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.metadata_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List image metadata.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">MetadataIterator</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.metadata_remove">
<code class="descname">metadata_remove</code><span class="sig-paren">(</span><em>self</em>, <em>key</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.metadata_remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove image metadata for the given key.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>key</strong> (<em>str</em>) – metadata key</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.metadata_set">
<code class="descname">metadata_set</code><span class="sig-paren">(</span><em>self</em>, <em>key</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.metadata_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Set image metadata for the given key.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>key</strong> (<em>str</em>) – metadata key</li>
<li><strong>value</strong> (<em>str</em>) – metadata value</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.mirror_image_demote">
<code class="descname">mirror_image_demote</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.mirror_image_demote" title="Permalink to this definition">¶</a></dt>
<dd><p>Demote the image to secondary for mirroring.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.mirror_image_disable">
<code class="descname">mirror_image_disable</code><span class="sig-paren">(</span><em>self</em>, <em>force</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.mirror_image_disable" title="Permalink to this definition">¶</a></dt>
<dd><p>Disable mirroring for the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>force</strong> (<em>bool</em>) – force disabling</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.mirror_image_enable">
<code class="descname">mirror_image_enable</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.mirror_image_enable" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable mirroring for the image.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.mirror_image_get_info">
<code class="descname">mirror_image_get_info</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.mirror_image_get_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Get mirror info for the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dict - contains the following keys:<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">global_id</span></code> (str) - image global id</li>
<li><code class="docutils literal notranslate"><span class="pre">state</span></code> (int) - mirror state</li>
<li><code class="docutils literal notranslate"><span class="pre">primary</span></code> (bool) - is image primary</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.mirror_image_get_instance_id">
<code class="descname">mirror_image_get_instance_id</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.mirror_image_get_instance_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get mirror instance id for the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">str - instance id</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.mirror_image_get_status">
<code class="descname">mirror_image_get_status</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.mirror_image_get_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Get mirror status for the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dict - contains the following keys:<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">name</span></code> (str) - mirror image name</li>
<li><code class="docutils literal notranslate"><span class="pre">id</span></code> (str) - mirror image id</li>
<li><cite>info</cite> (dict) - mirror image info</li>
<li><code class="docutils literal notranslate"><span class="pre">state</span></code> (int) - status mirror state</li>
<li><code class="docutils literal notranslate"><span class="pre">description</span></code> (str) - status description</li>
<li><code class="docutils literal notranslate"><span class="pre">last_update</span></code> (datetime) - last status update time</li>
<li><code class="docutils literal notranslate"><span class="pre">up</span></code> (bool) - is mirroring agent up</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.mirror_image_promote">
<code class="descname">mirror_image_promote</code><span class="sig-paren">(</span><em>self</em>, <em>force</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.mirror_image_promote" title="Permalink to this definition">¶</a></dt>
<dd><p>Promote the image to primary for mirroring.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>force</strong> (<em>bool</em>) – force promoting</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.mirror_image_resync">
<code class="descname">mirror_image_resync</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.mirror_image_resync" title="Permalink to this definition">¶</a></dt>
<dd><p>Flag the image to resync.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.modify_timestamp">
<code class="descname">modify_timestamp</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.modify_timestamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the modify timestamp for the image.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.old_format">
<code class="descname">old_format</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.old_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Find out whether the image uses the old RBD format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">bool - whether the image uses the old RBD format</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.op_features">
<code class="descname">op_features</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.op_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the op features bitmask of the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">int - the op features bitmask of the image</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.overlap">
<code class="descname">overlap</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.overlap" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of overlapping bytes between the image and its parent
image. If open to a snapshot, returns the overlap between the snapshot
and the parent image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">int - the overlap in bytes</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageNotFound</span></code> if the image doesn’t have a parent</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.parent_id">
<code class="descname">parent_id</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.parent_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get image id of a cloned image’s parent (if any)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">str - the parent id</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageNotFound</span></code> if the image doesn’t have a parent</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.parent_info">
<code class="descname">parent_info</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.parent_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Get information about a cloned image’s parent (if any)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">tuple - <code class="docutils literal notranslate"><span class="pre">(pool</span> <span class="pre">name,</span> <span class="pre">image</span> <span class="pre">name,</span> <span class="pre">snapshot</span> <span class="pre">name)</span></code> components
of the parent image</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageNotFound</span></code> if the image doesn’t have a parent</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.protect_snap">
<code class="descname">protect_snap</code><span class="sig-paren">(</span><em>self</em>, <em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.protect_snap" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark a snapshot as protected. This means it can’t be deleted
until it is unprotected.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) – the snapshot to protect</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOError</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ImageNotFound</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>self</em>, <em>offset</em>, <em>length</em>, <em>fadvise_flags=0</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read data from the image. Raises <code class="xref py py-class docutils literal notranslate"><span class="pre">InvalidArgument</span></code> if
part of the range specified is outside the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>offset</strong> (<em>int</em>) – the offset to start reading at</li>
<li><strong>length</strong> (<em>int</em>) – how many bytes to read</li>
<li><strong>fadvise_flags</strong> (<em>int</em>) – fadvise flags for this read</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">str - the data read</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">InvalidArgument</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">IOError</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.rebuild_object_map">
<code class="descname">rebuild_object_map</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.rebuild_object_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebuild the object map for the image HEAD or currently set snapshot</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.remove_snap">
<code class="descname">remove_snap</code><span class="sig-paren">(</span><em>self</em>, <em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.remove_snap" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a snapshot of the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) – the name of the snapshot</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOError</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ImageBusy</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.remove_snap2">
<code class="descname">remove_snap2</code><span class="sig-paren">(</span><em>self</em>, <em>name</em>, <em>flags</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.remove_snap2" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a snapshot of the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong> (<em>str</em>) – the name of the snapshot</li>
<li><strong>flags</strong> – the flags for removal</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOError</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ImageBusy</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.remove_snap_by_id">
<code class="descname">remove_snap_by_id</code><span class="sig-paren">(</span><em>self</em>, <em>snap_id</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.remove_snap_by_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a snapshot of the image by its id.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>id</strong> – the id of the snapshot</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOError</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ImageBusy</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.remove_snap_limit">
<code class="descname">remove_snap_limit</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.remove_snap_limit" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the snapshot limit for an image, essentially setting
the limit to the maximum size allowed by the implementation.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.rename_snap">
<code class="descname">rename_snap</code><span class="sig-paren">(</span><em>self</em>, <em>srcname</em>, <em>dstname</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.rename_snap" title="Permalink to this definition">¶</a></dt>
<dd><p>rename a snapshot of the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>srcname</strong> (<em>str</em>) – the src name of the snapshot</li>
<li><strong>dstname</strong> (<em>str</em>) – the dst name of the snapshot</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageExists</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.resize">
<code class="descname">resize</code><span class="sig-paren">(</span><em>self</em>, <em>size</em>, <em>allow_shrink=True</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.resize" title="Permalink to this definition">¶</a></dt>
<dd><p>Change the size of the image, allow shrink.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>size</strong> (<em>int</em>) – the new size of the image</li>
<li><strong>allow_shrink</strong> (<em>bool</em>) – permit shrinking</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.rollback_to_snap">
<code class="descname">rollback_to_snap</code><span class="sig-paren">(</span><em>self</em>, <em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.rollback_to_snap" title="Permalink to this definition">¶</a></dt>
<dd><p>Revert the image to its contents at a snapshot. This is a
potentially expensive operation, since it rolls back each
object individually.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) – the snapshot to rollback to</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOError</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.set_snap">
<code class="descname">set_snap</code><span class="sig-paren">(</span><em>self</em>, <em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.set_snap" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the snapshot to read from. Writes will raise ReadOnlyImage
while a snapshot is set. Pass None to unset the snapshot
(reads come from the current image) , and allow writing again.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em><em> or </em><em>None</em>) – the snapshot to read from, or None to unset the snapshot</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.set_snap_by_id">
<code class="descname">set_snap_by_id</code><span class="sig-paren">(</span><em>self</em>, <em>snap_id</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.set_snap_by_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the snapshot to read from. Writes will raise ReadOnlyImage
while a snapshot is set. Pass None to unset the snapshot
(reads come from the current image) , and allow writing again.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>snap_id</strong> (<em>int</em>) – the snapshot to read from, or None to unset the snapshot</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.set_snap_limit">
<code class="descname">set_snap_limit</code><span class="sig-paren">(</span><em>self</em>, <em>limit</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.set_snap_limit" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the snapshot limit for an image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>limit</strong> – the new limit to set</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.size">
<code class="descname">size</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.size" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the size of the image. If open to a snapshot, returns the
size of that snapshot.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">int - the size of the image in bytes</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.snap_get_group_namespace">
<code class="descname">snap_get_group_namespace</code><span class="sig-paren">(</span><em>self</em>, <em>snap_id</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.snap_get_group_namespace" title="Permalink to this definition">¶</a></dt>
<dd><p>get the group namespace details.
:param snap_id: the snapshot id of the group snapshot
:type key: int
:returns: dict - contains the following keys:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">pool</span></code> (int) - pool id</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code> (str) - group name</li>
<li><code class="docutils literal notranslate"><span class="pre">snap_name</span></code> (str) - group snap name</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.snap_get_namespace_type">
<code class="descname">snap_get_namespace_type</code><span class="sig-paren">(</span><em>self</em>, <em>snap_id</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.snap_get_namespace_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the snapshot namespace type.
:param snap_id: the snapshot id of a snap shot
:type key: int</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.snap_get_trash_namespace">
<code class="descname">snap_get_trash_namespace</code><span class="sig-paren">(</span><em>self</em>, <em>snap_id</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.snap_get_trash_namespace" title="Permalink to this definition">¶</a></dt>
<dd><p>get the trash namespace details.
:param snap_id: the snapshot id of the trash snapshot
:type key: int
:returns: dict - contains the following keys:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">original_name</span></code> (str) - original snap name</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.stat">
<code class="descname">stat</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.stat" title="Permalink to this definition">¶</a></dt>
<dd><p>Get information about the image. Currently parent pool and
parent name are always -1 and ‘’.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dict - contains the following keys:<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">size</span></code> (int) - the size of the image in bytes</li>
<li><code class="docutils literal notranslate"><span class="pre">obj_size</span></code> (int) - the size of each object that comprises the
image</li>
<li><code class="docutils literal notranslate"><span class="pre">num_objs</span></code> (int) - the number of objects in the image</li>
<li><code class="docutils literal notranslate"><span class="pre">order</span></code> (int) - log_2(object_size)</li>
<li><code class="docutils literal notranslate"><span class="pre">block_name_prefix</span></code> (str) - the prefix of the RADOS objects used
to store the image</li>
<li><code class="docutils literal notranslate"><span class="pre">parent_pool</span></code> (int) - deprecated</li>
<li><code class="docutils literal notranslate"><span class="pre">parent_name</span></code>  (str) - deprecated</li>
</ul>
<p>See also <code class="xref py py-meth docutils literal notranslate"><span class="pre">format()</span></code> and <a class="reference internal" href="#rbd.Image.features" title="rbd.Image.features"><code class="xref py py-meth docutils literal notranslate"><span class="pre">features()</span></code></a>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.stripe_count">
<code class="descname">stripe_count</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.stripe_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the stripe count used for the image.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.stripe_unit">
<code class="descname">stripe_unit</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.stripe_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the stripe unit used for the image.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.unlock">
<code class="descname">unlock</code><span class="sig-paren">(</span><em>self</em>, <em>cookie</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.unlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Release a lock on the image that was locked by this rados client.</p>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.unprotect_snap">
<code class="descname">unprotect_snap</code><span class="sig-paren">(</span><em>self</em>, <em>name</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.unprotect_snap" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark a snapshot unprotected. This allows it to be deleted if
it was protected.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong> (<em>str</em>) – the snapshot to unprotect</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">IOError</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">ImageNotFound</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.update_features">
<code class="descname">update_features</code><span class="sig-paren">(</span><em>self</em>, <em>features</em>, <em>enabled</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.update_features" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the features bitmask of the image by enabling/disabling
a single feature.  The feature must support the ability to be
dynamically enabled/disabled.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>features</strong> (<em>int</em>) – feature bitmask to enable/disable</li>
<li><strong>enabled</strong> (<em>bool</em>) – whether to enable/disable the feature</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">InvalidArgument</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.watchers_list">
<code class="descname">watchers_list</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.watchers_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List image watchers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><code class="xref py py-class docutils literal notranslate"><span class="pre">WatcherIterator</span></code></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="rbd.Image.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>self</em>, <em>data</em>, <em>offset</em>, <em>fadvise_flags=0</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.Image.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write data to the image. Raises <code class="xref py py-class docutils literal notranslate"><span class="pre">InvalidArgument</span></code> if
part of the write would fall outside the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (<em>bytes</em>) – the data to be written</li>
<li><strong>offset</strong> (<em>int</em>) – where to start writing data</li>
<li><strong>fadvise_flags</strong> (<em>int</em>) – fadvise flags for this write</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">int - the number of bytes written</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><p class="first last"><code class="xref py py-class docutils literal notranslate"><span class="pre">IncompleteWriteError</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">LogicError</span></code>,
<code class="xref py py-class docutils literal notranslate"><span class="pre">InvalidArgument</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">IOError</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="rbd.SnapIterator">
<em class="property">class </em><code class="descclassname">rbd.</code><code class="descname">SnapIterator</code><span class="sig-paren">(</span><em>Image image</em><span class="sig-paren">)</span><a class="headerlink" href="#rbd.SnapIterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterator over snapshot info for an image.</p>
<p>Yields a dictionary containing information about a snapshot.</p>
<p>Keys are:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">id</span></code> (int) - numeric identifier of the snapshot</li>
<li><code class="docutils literal notranslate"><span class="pre">size</span></code> (int) - size of the image at the time of snapshot (in bytes)</li>
<li><code class="docutils literal notranslate"><span class="pre">name</span></code> (str) - name of the snapshot</li>
<li><code class="docutils literal notranslate"><span class="pre">namespace</span></code> (int) - enum for snap namespace</li>
<li><code class="docutils literal notranslate"><span class="pre">group</span></code> (dict) - optional for group namespace snapshots</li>
<li><code class="docutils literal notranslate"><span class="pre">trash</span></code> (dict) - optional for trash namespace snapshots</li>
</ul>
</dd></dl>

</div>
</div>



          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../">
              <img class="logo" src="../../_static/logo.png" alt="Logo"/>
            </a></p>
<h3><a href="../../">Table Of Contents</a></h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../start/intro/">Ceph 简介</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../start/">安装（ ceph-deploy ）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install/">安装（手动）</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rados/">Ceph 存储集群</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cephfs/">Ceph 文件系统</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../rbd/">Ceph 块设备</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../rados-rbd-cmds/">命令</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rbd-ko/">内核模块</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rbd-snapshot/">快照</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rbd-mirroring/">RBD 镜像</a></li>
<li class="toctree-l2"><a class="reference internal" href="../qemu-rbd/">QEMU</a></li>
<li class="toctree-l2"><a class="reference internal" href="../libvirt/">libvirt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rbd-config-ref/">缓存选项</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rbd-openstack/">OpenStack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rbd-cloudstack/">CloudStack</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/8/rbd/">rbd 手册页</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/8/rbd-fuse/">rbd-fuse 手册页</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/8/rbd-nbd/">rbd-nbd 手册页</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/8/ceph-rbdnamer/">ceph-rbdnamer 手册页</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rbd-replay/">RBD 重放</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/8/rbd-replay-prep/">rbd-replay-prep 手册页</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/8/rbd-replay/">rbd-replay 手册页</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/8/rbd-replay-many/">rbd-replay-many 手册页</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../man/8/rbdmap/">rbdmap 手册页</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">librbd 的 Python 接口</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">实例：创建一映像并写入</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-rbd">API 参考</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../radosgw/">Ceph 对象网关</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mgr/">Ceph 管理器守护进程</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/">API 文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../architecture/">体系结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/">开发文档</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev/internals/">Ceph Internals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../ceph-volume/">ceph-volume</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/">Ceph 版本</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary/">Ceph 术语</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../translation_cn/">中文版翻译资源</a></li>
</ul>


<!-- ugly kludge to make genindex look like it's part of the toc -->
<ul style="margin-top: -10px"><li class="toctree-l1"><a class="reference internal" href="../../genindex/">Index</a></li></ul>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search/" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex/" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex/" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../../radosgw/" title="Ceph 对象网关"
             >next</a> |</li>
        <li class="right" >
          <a href="../../man/8/rbdmap/" title="rbdmap – 在引导时映射 RBD 设备"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../">Ceph Documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../rbd/" >Ceph 块设备</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Red Hat, Inc, and contributors. Licensed under Creative Commons Attribution Share Alike 3.0 (CC-BY-SA-3.0).
    </div>
  </body>
</html>