.. _containers:

Ceph 容器映像
=============
.. Ceph Container Images

.. important::
   不鼓励使用 ``:latest`` 标签。如果你用了 ``:latest`` 标签，
   没法保证所有主机上的映像相同，在这样的状态下，
   升级后可能无法正常运行。记着， ``:latest``
   是个相对标签、还是个不断移动的目标。

   请使用显式的标签或映像 ID ，而非 ``:latest`` 标签。例如：

   ``podman pull ceph/ceph:v15.2.0``


官方发布
--------
.. Official Releases

Ceph 容器映像发布到了 Quay 和 Docker Hub::

  https://quay.io/repository/ceph/ceph
  https://hub.docker.com/r/ceph

ceph/ceph
^^^^^^^^^

- 通用 Ceph 容器，安装了所有必需的守护进程及其依赖关系。

+----------------------+--------------------------------------------------------------+
| 标签                 | 含义                                                         |
+----------------------+--------------------------------------------------------------+
| vRELNUM              | Latest release in this series (e.g., *v14* = Nautilus)       |
+----------------------+--------------------------------------------------------------+
| vRELNUM.2            | Latest *stable* release in this stable series (e.g., *v14.2*)|
+----------------------+--------------------------------------------------------------+
| vRELNUM.Y.Z          | A specific release (e.g., *v14.2.4*)                         |
+----------------------+--------------------------------------------------------------+
| vRELNUM.Y.Z-YYYYMMDD | A specific build (e.g., *v14.2.4-20191203*)                  |
+----------------------+--------------------------------------------------------------+


遗留的容器映像
--------------
.. Legacy container images

遗留的容器映像位于 Docker Hub 的： ::

  https://hub.docker.com/r/ceph


ceph/daemon-base
^^^^^^^^^^^^^^^^

- 通用 Ceph 容器，安装了所有必需的守护进程及其依赖关系。
- 和 *ceph/ceph* 基本相同，就是标签不同。
- 注意，所有的 *-devel* 标签（和 *latest-master* 标签）
  都基于没正式发布的、而且一般也没测试过的软件包，来自 https://shaman.ceph.com 。

:note: 这个映像会很快变成 *ceph/ceph* 的别名。

+------------------------+---------------------------------------------------------+
| 标签                   | 含义                                                    |
+------------------------+---------------------------------------------------------+
| latest-master          | Build of master branch a last ceph-container.git update |
+------------------------+---------------------------------------------------------+
| latest-master-devel    | Daily build of the master branch                        |
+------------------------+---------------------------------------------------------+
| latest-RELEASE-devel   | Daily build of the *RELEASE* (e.g., nautilus) branch    |
+------------------------+---------------------------------------------------------+


ceph/daemon
^^^^^^^^^^^

- *ceph/daemon-base* plus a collection of BASH scripts that are used
  by ceph-nano and ceph-ansible to manage a Ceph cluster.

+------------------------+---------------------------------------------------------+
| 标签                   | 含义                                                    |
+------------------------+---------------------------------------------------------+
| latest-master          | Build of master branch a last ceph-container.git update |
+------------------------+---------------------------------------------------------+
| latest-master-devel    | Daily build of the master branch                        |
+------------------------+---------------------------------------------------------+
| latest-RELEASE-devel   | Daily build of the *RELEASE* (e.g., nautilus) branch    |
+------------------------+---------------------------------------------------------+


Development builds
------------------

We automatically build container images for development ``wip-*``
branches in the ceph-ci.git repositories and push them to Quay at::

  https://quay.io/organization/ceph-ci

ceph-ci/ceph
^^^^^^^^^^^^

- This is analogous to the ceph/ceph image above
- TODO: remove the ``wip-*`` limitation and also build ceph.git branches.

+------------------------------------+------------------------------------------------------+
| 标签                               | 含义                                                 |
+------------------------------------+------------------------------------------------------+
| BRANCH                             | Latest build of a given GIT branch (e.g., *wip-foo*) |
+------------------------------------+------------------------------------------------------+
| BRANCH-SHORTSHA1-BASEOS-ARCH-devel | A specific build of a branch                         |
+------------------------------------+------------------------------------------------------+
| SHA1                               | A specific build                                     |
+------------------------------------+------------------------------------------------------+
